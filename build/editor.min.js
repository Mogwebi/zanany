!function(e,t){var o=e.element.createElement,n=e.plugins.registerPlugin,a=e.apiFetch,i=e.editPost.PluginSidebar,l=e.editPost.PluginSidebarMoreMenuItem,r=(e.blockEditor.RichText,e.blockEditor.BlockControls,e.blockEditor.MediaUpload),s=e.components.Button,c=(e.components.FormFileUpload,e.components.TextControl),d=e.components.SelectControl,p=(e.components.RangeControl,e.components.ToggleControl),u=e.components.RadioControl,m=e.components.TextareaControl,f=e.components.FormTokenField,h=(e.components.Autocomplete,e.components.Placeholder,e.components.TabPanel,e.components.PanelBody),b=(e.components.Draggable,e.data.withSelect),v=e.data.withDispatch,g=e.compose.compose,y=e.element.useState,k=e.i18n.__,C=new Waveform,P=g(v((function(e,t){return{setMetaValue:function(o){if(void 0!==t.field){var n={};"duration"!=t.field&&"start"!=t.field&&"end"!=t.field||(o=C.timeToMS(o)),n[t.field]=o,e("core/editor").editPost({meta:n})}}}})),b((function(e,t){var o=e("core/editor").getEditedPostAttribute("meta")[t.field];return"duration"!=t.field&&"start"!=t.field&&"end"!=t.field||(o=C.msToTime(o)),{metaValue:o}})))((function(e){var t=e.control||c;switch(t){case p:e.checked=e.metaValue;break;case u:e.selected=e.metaValue;break;default:e.value=e.metaValue}return e.onChange=function(t){e.setMetaValue(t),e.onChanged&&e.onChanged(t)},e.control=null,o("div",{className:"components-meta-control components-"+e.field+"-control "+(e.hide&&""==e.metaValue?"components-form-hidden-empty ":" "),style:e.style},e.before&&e.before(e),o(t,e),e.after&&e.after(e))}));n("play-sidebar",{icon:o("svg",{width:20,height:20}),render:function(){var n={label:"",src:""},u={size:"",src:""},b=[];const[v,g]=y([]);if(play&&play.types)for(var V in play.types)b.push({label:V,value:play.types[V]});return[,o(l,{target:"play-sidebar"},k("Play")),o(i,{name:"play-sidebar",title:k("Play"),icon:o("svg",{width:20,height:20,viewBox:"0 0 24 24"},o("path",{d:"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}))},o(h,{title:k("General"),initialOpen:!0},o(P,{label:k("Type"),control:d,field:"type",options:b,after:function(n){return"single"==n.metaValue||"short"==n.metaValue||"episode"==n.metaValue||""==n.metaValue?o("div",{},o(P,{label:k("Stream"),placeholder:"Enter, upload, choose from Media Library",field:"stream",before:function(t){var n=t.metaValue,a=e.data.select("core/editor").getCurrentPostAttribute("meta").stream_url;return""!==a&&(n=a),o("audio",{style:{margin:"1em 0"},controls:" ",preload:"none",src:n})},after:function(n){return o(r,{onSelect:function(t){return t.fileLength&&e.data.dispatch("core/editor").editPost({meta:{duration:C.timeToMS(t.fileLength)}}),t.meta&&t.meta.bpm&&e.data.dispatch("core/editor").editPost({meta:{bpm:t.meta.bpm}}),n.setMetaValue(t.url)},type:"image",render:function(a){return o("div",{style:{display:"inline-flex",padding:"0 0 10px 0"}},o(s,{icon:"upload",label:k("Upload"),onClick:a.open}),o(s,{icon:"cloud",label:k("Attempt to retrieve data from remote server"),onClick:function(o){var a=n.metaValue,i=o.currentTarget;""==a||i.disabled||(i.disabled=!0,playImport(a,{},(function(o){i.disabled=!1,function(o){for(var n in o)if(o.hasOwnProperty(n)&&null!==o[n]&&""!==o[n]&&"0"!==o[n]){var a={};if(a[n]=o[n],e.data.dispatch("core/editor").editPost({meta:a}),"title"==n&&e.data.dispatch("core/editor").editPost({title:o[n]}),"description"==n&&""!=n){var i=o[n].split("\n").map((function(t){return e.blocks.createBlock("core/paragraph",{content:t})}));e.data.dispatch("core/block-editor").insertBlocks(i)}if("blob"==n){var l=e.data.select("core/editor").getCurrentPostAttribute("id"),r=new FormData;r.append("id",l),r.append("image",o[n]),t.ajax({url:play.rest.endpoints.upload_featuredimg,data:r,type:"POST",cache:!1,processData:!1,contentType:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){t.error?e.data.dispatch("core/notices").createNotice("error",t.error):e.data.dispatch("core/editor").editPost({featured_media:parseInt(t.featured_media)})}))}}}(o)})))}}),o(s,{icon:"chart-bar",label:k("Generate Waveform"),onClick:function(){var t=n.metaValue,o=event.currentTarget;""!=t&&(o.disabled=!0,C.loadAudioData(t,(function(t){var n=Math.round(1e3*t.duration),a={waveform_data:t.data,duration:n,bpm:t.bpm};e.data.dispatch("core/editor").editPost({meta:a}),o.disabled=!1})))}}),o(s,{icon:"no-alt",label:k("Clear"),onClick:function(){n.setMetaValue("")}}))}})}}),o(P,{label:k("Stream URL"),field:"stream_url",hide:!0}),o(P,{label:k("Duration"),field:"duration"}),play.pro&&o("div",{className:"grid-2-col"},o(P,{label:k("Start"),field:"start"}),o(P,{label:k("End"),field:"end"})),o(P,{label:k("BPM"),field:"bpm"}),o(P,{label:k("Waveform"),field:"waveform_data",hide:!0})):o("div",{},o(P,{control:f,suggestions:v,className:"components-form-token-post token-items",field:"items",onFocus:function(o){var n=t(".token-items .components-flex");n.sortable({items:"> div",update:function(o,a){var i=n.find("> div").map((function(){return t.trim(t(this).find("> span > span > span:last").text().split(":")[0])})).get();e.data.dispatch("core/editor").editPost({meta:{post:i.join(",")}})}})},onChanged:function(t){var o=t.map((function(e){return e.split(":")[0]}));e.data.dispatch("core/editor").editPost({meta:{post:o.join(",")}})},onInputChange:function(e){if(!(e.length<2||/^https?:/.test(e))){var t="?type="+n.metaValue+"&search="+encodeURIComponent(e);a({path:"/play/play/items"+t}).then((function(e){g(e)}))}}}),o("p",{className:"components-base-control__help"},k("Please enter 3 or more characters to search single stations")),o(P,{control:p,label:k("Auto type"),field:"auto_type"}),o("p",{className:"components-base-control__help"},k("Build the list from Loop Block in content")))}})),o(h,{title:k("Sources"),initialOpen:!1},o(P,{control:f,className:"components-form-token-post token-sources components-form-hidden-help",field:"sources",help:"",onFocus:function(o){var n=t(".token-sources .components-flex");n.sortable({items:"> div",update:function(o,a){var i=n.find("> div").map((function(){return t.trim(t(this).find("> span > span > span:last").text())})).get();e.data.dispatch("core/editor").editPost({meta:{sources:i}})}})},after:function(e){return o("div",{id:"components-form-source"},o(c,{placeholder:k("Size e.g. 1080"),onChange:function(e){u.size=e}}),o("div",{style:{display:"inline-flex"}},o(c,{placeholder:k("Media file"),onChange:function(e){u.src=e}}),o(r,{onSelect:function(e){var t=document.getElementById("components-form-source").getElementsByTagName("input");u.src=e.url,t[1].value=e.url},render:function(e){return o(s,{text:k("Upload"),className:"is-medium",onClick:e.open})}})),o(s,{text:k("Add"),className:"is-medium",onClick:function(){if(""!==u.size&&""!==u.src){var t=lodash.cloneDeep(e.metaValue);t.push(u.size+":"+u.src),e.setMetaValue(t);var o=document.getElementById("components-form-source").getElementsByTagName("input");o[0].value=o[1].value=u.size=u.src=""}}}))}})),o(h,{title:k("Captions"),initialOpen:!1},o(P,{control:f,className:"components-form-token-post token-captions components-form-hidden-help",field:"captions",help:"",onFocus:function(o){var n=t(".token-captions .components-flex");n.sortable({items:"> div",update:function(o,a){var i=n.find("> div").map((function(){return t.trim(t(this).find("> span > span > span:last").text())})).get();e.data.dispatch("core/editor").editPost({meta:{captions:i}})}})},after:function(e){return o("div",{id:"components-form-caption"},o(c,{placeholder:k("Label e.g. English"),onChange:function(e){n.label=e}}),o("div",{style:{display:"inline-flex"}},o(c,{placeholder:k("WebVTT file"),onChange:function(e){n.src=e}}),o(r,{onSelect:function(e){var t=document.getElementById("components-form-caption").getElementsByTagName("input");n.src=e.url,t[1].value=e.url},render:function(e){return o(s,{text:k("Upload"),className:"is-medium",onClick:e.open})}})),o(s,{text:k("Add"),className:"is-medium",onClick:function(){if(""!==n.label&&""!==n.src){var t=lodash.cloneDeep(e.metaValue);t.push(n.label+":"+n.src),e.setMetaValue(t);var o=document.getElementById("components-form-caption").getElementsByTagName("input");o[0].value=o[1].value=n.label=n.src=""}}}))}})),o(h,{title:k("Download"),initialOpen:!1},o(P,{control:p,label:k("Downloadable"),field:"downloadable",after:function(e){return e.metaValue&&o(P,{placeholder:"Enter, upload, choose from Media Library",field:"download_url",after:function(e){return o(r,{onSelect:function(t){return e.setMetaValue(t.url)},render:function(t){return o("div",{style:{display:"inline-flex"}},o(s,{icon:"upload",label:k("Upload"),onClick:t.open}),o(s,{icon:"no-alt",label:k("Clear"),onClick:function(){e.setMetaValue("")}}))}})}})}})),o(h,{title:k("Purchase"),initialOpen:!1},o(P,{label:k("Title"),field:"purchase_title"}),o(P,{label:k("Link"),placeholder:"http://",field:"purchase_url"})),o(h,{title:k("Stats"),initialOpen:!1},o(P,{label:k("Plays"),field:"post-count-all"}),o(P,{label:k("Likes"),field:"like_count"}),o(P,{label:k("Downloads"),field:"download_count"})),o(h,{title:k("Editor Note"),initialOpen:!1},o(P,{field:"editor_note",control:m})),o(h,{title:k("Copyright"),initialOpen:!1},o(P,{field:"copyright",control:m})))]}})}(window.wp,jQuery);