var DragDropTouch;!function(e,t){"use strict";var i;t(document).on("click",".upload-btn",(function(n){if(n.preventDefault(),i)i.open();else{var r=t(this);i=e.media({title:"Choose an image",multiple:!1}).open().on("select",(function(){var e=i.state().get("selection").first().toJSON();if("image"==e.type){var t=e.sizes.thumbnail||e.sizes.full;r.siblings("img").attr("src",t.url),r.prev().val(e.id)}else r.siblings("input").val(e.url)}))}})),void 0!==e&&void 0!==e.hooks&&e.hooks.addFilter("hook_orderby","loopblock",(function(t){var i=[{label:"User",value:"user"},{label:"User played",value:"user_played"},{label:"User likes",value:"user_likes"},{label:"User following",value:"user_following"},{label:"User verified",value:"user_verified"},{label:"All count",value:"all"}];return"undefined"!=typeof count_play&&(-1!==count_play.indexOf("year")&&i.push({label:"Yearly count",value:"year"}),-1!==count_play.indexOf("month")&&i.push({label:"Monthly count",value:"month"}),-1!==count_play.indexOf("week")&&i.push({label:"Weekly count",value:"week"}),-1!==count_play.indexOf("day")&&i.push({label:"Daily count",value:"day"})),i=e.hooks.applyFilters("hook_loop_orderby",i),t=t.concat(i)}))}(window.wp,jQuery),function(e){"use strict";var t=(Object.defineProperty(i.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),i.prototype.clearData=function(e){null!=e?delete this._data[e.toLowerCase()]:this._data={}},i.prototype.getData=function(e){return this._data[e.toLowerCase()]||""},i.prototype.setData=function(e,t){this._data[e.toLowerCase()]=t},i.prototype.setDragImage=function(e,t,i){var r=n._instance;r._imgCustom=e,r._imgOffset={x:t,y:i}},i);function i(){this._dropEffect="move",this._effectAllowed="all",this._data={}}e.DataTransfer=t;var n=(r.getInstance=function(){return r._instance},r.prototype._touchstart=function(e){var t=this;if(this._shouldHandle(e)){if(Date.now()-this._lastClick<r._DBLCLICK&&this._dispatchEvent(e,"dblclick",e.target))return e.preventDefault(),void this._reset();this._reset();var i=this._closestDraggable(e.target);i&&(this._dispatchEvent(e,"mousemove",e.target)||this._dispatchEvent(e,"mousedown",e.target)||(this._dragSource=i,this._ptDown=this._getPoint(e),(this._lastTouch=e).preventDefault(),setTimeout((function(){t._dragSource==i&&null==t._img&&t._dispatchEvent(e,"contextmenu",i)&&t._reset()}),r._CTXMENU),r._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){t._isDragEnabled=!0,t._touchmove(e)}),r._PRESSHOLDAWAIT))))}},r.prototype._touchmove=function(e){var t;this._shouldCancelPressHoldMove(e)?this._reset():(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e))&&(t=this._getTarget(e),this._dispatchEvent(e,"mousemove",t)?(this._lastTouch=e).preventDefault():(this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",t)),this._img&&((this._lastTouch=e).preventDefault(),this._dispatchEvent(e,"drag",this._dragSource),t!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",t),this._lastTarget=t),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",t))))},r.prototype._touchend=function(e){this._shouldHandle(e)&&(this._dispatchEvent(this._lastTouch,"mouseup",e.target)?e.preventDefault():(this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())))},r.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},r.prototype._shouldHandleMove=function(e){return!r._ISPRESSHOLDMODE&&this._shouldHandle(e)},r.prototype._shouldHandlePressHoldMove=function(e){return r._ISPRESSHOLDMODE&&this._isDragEnabled&&e&&e.touches&&e.touches.length},r.prototype._shouldCancelPressHoldMove=function(e){return r._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(e)>r._PRESSHOLDMARGIN},r.prototype._shouldStartDragging=function(e){return e=this._getDelta(e),r._THRESHOLD<e||r._ISPRESSHOLDMODE&&r._PRESSHOLDTHRESHOLD<=e},r.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,clearInterval(this._pressHoldInterval)},r.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},r.prototype._getDelta=function(e){return r._ISPRESSHOLDMODE&&!this._ptDown?0:(e=this._getPoint(e),Math.abs(e.x-this._ptDown.x)+Math.abs(e.y-this._ptDown.y))},r.prototype._getTarget=function(e){e=this._getPoint(e);for(var t=document.elementFromPoint(e.x,e.y);t&&"none"==getComputedStyle(t).pointerEvents;)t=t.parentElement;return t},r.prototype._createImage=function(e){this._img&&this._destroyImage();var t,i=this._imgCustom||this._dragSource;this._img=i.cloneNode(!0),this._copyStyle(i,this._img),this._img.style.top=this._img.style.left="-9999px",this._imgCustom||(t=i.getBoundingClientRect(),i=this._getPoint(e),this._imgOffset={x:i.x-t.left,y:i.y-t.top},this._img.style.opacity=r._OPACITY.toString()),this._moveImage(e),document.body.appendChild(this._img)},r.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},r.prototype._moveImage=function(e){var t=this;requestAnimationFrame((function(){var i,n;t._img&&(i=t._getPoint(e,!0),(n=t._img.style).position="absolute",n.pointerEvents="none",n.zIndex="999999",n.left=Math.round(i.x-t._imgOffset.x)+"px",n.top=Math.round(i.y-t._imgOffset.y)+"px")}))},r.prototype._copyProps=function(e,t,i){for(var n=0;n<i.length;n++){var r=i[n];e[r]=t[r]}},r.prototype._copyStyle=function(e,t){var i,n;r._rmvAtts.forEach((function(e){t.removeAttribute(e)})),e instanceof HTMLCanvasElement&&(i=e,(n=t).width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0));for(var a=getComputedStyle(e),s=0;s<a.length;s++){var o=a[s];o.indexOf("transition")<0&&(t.style[o]=a[o])}for(t.style.pointerEvents="none",s=0;s<e.children.length;s++)this._copyStyle(e.children[s],t.children[s])},r.prototype._dispatchEvent=function(e,t,i){if(e&&i){var n=document.createEvent("Event"),a=e.touches?e.touches[0]:e;return n.initEvent(t,!0,!0),n.button=0,n.which=n.buttons=1,this._copyProps(n,e,r._kbdProps),this._copyProps(n,a,r._ptProps),n.dataTransfer=this._dataTransfer,i.dispatchEvent(n),n.defaultPrevented}return!1},r.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},r);function r(){if(this._lastClick=0,r._instance)throw"DragDropTouch instance already created.";var e,t,i,n,a,s=!1;document.addEventListener("test",(function(){}),{get passive(){return s=!0}}),navigator.maxTouchPoints&&(e=document,t=this._touchstart.bind(this),i=this._touchmove.bind(this),n=this._touchend.bind(this),a=!!s&&{passive:!1,capture:!1},e.addEventListener("touchstart",t,a),e.addEventListener("touchmove",i,a),e.addEventListener("touchend",n),e.addEventListener("touchcancel",n))}n._instance=new n,n._THRESHOLD=5,n._OPACITY=.5,n._DBLCLICK=500,n._CTXMENU=900,n._ISPRESSHOLDMODE=!1,n._PRESSHOLDAWAIT=400,n._PRESSHOLDMARGIN=25,n._PRESSHOLDTHRESHOLD=0,n._rmvAtts="id,class,style,draggable".split(","),n._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),n._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),e.DragDropTouch=n}(DragDropTouch=DragDropTouch||{});var sortable=function(){"use strict";function e(e,t,i){if(void 0===i)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=i}var t=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter((function(e){return 1===e.nodeType&&e.matches(t)}))},i=new Map,n=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach((function(t,i){e[i]=t})),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),r=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return i.has(e)||i.set(e,new n),i.get(e)};function a(e,t,i){if(e instanceof Array)for(var n=0;n<e.length;++n)a(e[n],t,i);else e.addEventListener(t,i),r(e).setData("event"+t,i)}function s(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)s(e[i],t);else e.removeEventListener(t,r(e).getData("event"+t)),r(e).deleteData("event"+t)}function o(e,t,i){if(e instanceof Array)for(var n=0;n<e.length;++n)o(e[n],t,i);else e.setAttribute(t,i)}function l(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)l(e[i],t);else e.removeAttribute(t)}var d,u,c,h,f,p,m,g,v,y=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},b=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},w=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},_=function(e,t,i){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===i?e:e.nextElementSibling)},T=function(e,t){return _(e,t,"before")},E=function(e,t){return _(e,t,"after")},S=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map((function(e){var i=parseInt(t.getPropertyValue(e),10);return isNaN(i)?0:i})).reduce((function(e,t){return e+t}))},k=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map((function(e){var i=parseInt(t.getPropertyValue(e),10);return isNaN(i)?0:i})).reduce((function(e,t){return e+t}))},A=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter((function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement})).map((function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)}))},C=function(e){return e.composedPath&&e.composedPath()[0]||e.target},R=function(e,t,i){return{element:e,posX:i.pageX-t.left,posY:i.pageY-t.top}},L=function(e,t){if(!0===e.isSortable){var i=r(e).getConfig("acceptFrom");if(null!==i&&!1!==i&&"string"!=typeof i)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==i)return!1!==i&&0<i.split(",").filter((function(e){return 0<e.length&&t.matches(e)})).length;if(e===t)return!0;if(void 0!==r(e).getConfig("connectWith")&&null!==r(e).getConfig("connectWith"))return r(e).getConfig("connectWith")===r(t).getConfig("connectWith")}return!1},D={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"},x=function(e,i){if("string"==typeof r(e).getConfig("hoverClass")){var n=r(e).getConfig("hoverClass").split(" ");!0===i?(a(e,"mousemove",function(e,t){var i=this;if(void 0===t&&(t=250),"number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var n=null;return function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var s=Date.now();(null===n||t<=s-n)&&(n=s,e.apply(i,r))}}((function(i){0===i.buttons&&t(e.children,r(e).getConfig("items")).forEach((function(e){var t,r;e===i.target||e.contains(i.target)?(t=e.classList).add.apply(t,n):(r=e.classList).remove.apply(r,n)}))}),r(e).getConfig("throttleTime"))),a(e,"mouseleave",(function(){t(e.children,r(e).getConfig("items")).forEach((function(e){var t;(t=e.classList).remove.apply(t,n)}))}))):(s(e,"mousemove"),s(e,"mouseleave"))}},O=function(e){s(e,"dragstart"),s(e,"dragend"),s(e,"dragover"),s(e,"dragenter"),s(e,"drop"),s(e,"mouseenter"),s(e,"mouseleave")},P=function(e,t){e&&s(e,"dragleave"),t&&t!==e&&s(t,"dragleave")},I=function(e){var t;(t=e).h5s&&delete t.h5s.data,l(e,"aria-dropeffect")},M=function(e){l(e,"aria-grabbed"),l(e,"aria-copied"),l(e,"draggable"),l(e,"role")};function N(e,t){if(t.composedPath)return t.composedPath().find((function(e){return e.isSortable}));for(;!0!==e.isSortable;)e=e.parentElement;return e}function F(i,n){var r=e(i,"opts"),a=t(i.children,r.items).filter((function(e){return e.contains(n)||e.shadowRoot&&e.shadowRoot.contains(n)}));return 0<a.length?a[0]:n}var U=function(i){var n=e(i,"opts"),r=t(i.children,n.items),s=A(r,n.handle);o(i,"aria-dropeffect","move"),e(i,"_disabled","false"),o(s,"draggable","true"),x(i,!0),!1===n.disableIEFix&&"function"==typeof(document||window.document).createElement("span").dragDrop&&a(s,"mousedown",(function(){if(-1!==r.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===r.indexOf(e);)e=e.parentElement;e.dragDrop()}}))},B=function(i){var n=e(i,"opts"),r=t(i.children,n.items),a=A(r,n.handle);e(i,"_disabled","false"),O(r),P(h,g),s(a,"mousedown"),s(i,"dragover"),s(i,"dragenter"),s(i,"drop")};function j(n,s){var l=String(s);return s=s||{},"string"==typeof n&&(n=document.querySelectorAll(n)),n instanceof HTMLElement&&(n=[n]),n=Array.prototype.slice.call(n),/serialize/.test(l)?n.map((function(i){var n=e(i,"opts");return function(i,n,r){if(void 0===n&&(n=function(e,t){return e}),void 0===r&&(r=function(e){return e}),!(i instanceof HTMLElement)||1==!i.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof n||"function"!=typeof r)throw new Error("You need to provide a valid serializer for items and the container.");var a=e(i,"opts").items,s=t(i.children,a),o=s.map((function(e){return{parent:i,node:e,html:e.outerHTML,index:b(e,s)}}));return{container:r({node:i,itemCount:o.length}),items:o.map((function(e){return n(e,i)}))}}(i,n.itemSerializer,n.containerSerializer)})):(n.forEach((function(n){if(/enable|disable|destroy/.test(l))return j[l](n);["connectWith","disableIEFix"].forEach((function(e){Object.prototype.hasOwnProperty.call(s,e)&&null!==s[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),s=Object.assign({},D,r(n).config,s),r(n).config=s,e(n,"opts",s),n.isSortable=!0,B(n);var _,A=t(n.children,s.items);if(null!==s.placeholder&&void 0!==s.placeholder){var x=document.createElement(n.tagName);s.placeholder instanceof HTMLElement?x.appendChild(s.placeholder):x.innerHTML=s.placeholder,_=x.children[0]}r(n).placeholder=function(e,t,i){var n;if(void 0===i&&(i="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof i&&(n=t.classList).add.apply(n,i.split(" ")),t}(n,_,s.placeholderClass),e(n,"items",s.items),s.acceptFrom?e(n,"acceptFrom",s.acceptFrom):s.connectWith&&e(n,"connectWith",s.connectWith),U(n),o(A,"role","option"),o(A,"aria-grabbed","false"),a(n,"dragstart",(function(e){var i=C(e);if(!0!==i.isSortable&&(e.stopImmediatePropagation(),(!s.handle||i.matches(s.handle))&&"false"!==i.getAttribute("draggable"))){var n=N(i,e),a=F(n,i);m=t(n.children,s.items),f=m.indexOf(a),p=b(a,n.children),h=n,function(e,t,i){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(i||(i=R),e.dataTransfer&&e.dataTransfer.setDragImage){var n=i(t,y(t),e);if(!(n.element instanceof HTMLElement)||"number"!=typeof n.posX||"number"!=typeof n.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",C(e).id),e.dataTransfer.setDragImage(n.element,n.posX,n.posY)}}(e,a,s.customDragImage),u=S(a),c=k(a),a.classList.add(s.draggingClass),o(d=function(e,t){var i=e;return!0===r(t).getConfig("copy")&&(o(i=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(i),i.style.display="none",i.oldDisplay=e.style.display),i}(a,n),"aria-grabbed","true"),n.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:p,index:f,container:h},item:d,originalTarget:i}}))}})),a(n,"dragenter",(function(i){var o=C(i),l=N(o,i);l&&l!==g&&(v=t(l.children,e(l,"items")).filter((function(e){return e!==r(n).placeholder})),s.dropTargetContainerClass&&l.classList.add(s.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:p,index:f,container:h},destination:{container:l,itemsBeforeUpdate:v},item:d,originalTarget:o}})),a(l,"dragleave",(function(e){var t=e.relatedTarget||e.fromElement;e.currentTarget.contains(t)||(s.dropTargetContainerClass&&l.classList.remove(s.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:p,index:f,container:l},item:d,originalTarget:o}})))}))),g=l})),a(n,"dragend",(function(t){if(d){d.classList.remove(s.draggingClass),o(d,"aria-grabbed","false"),"true"===d.getAttribute("aria-copied")&&"true"!==e(d,"dropped")&&d.remove(),void 0!==d.oldDisplay&&(d.style.display=d.oldDisplay,delete d.oldDisplay);var r=Array.from(i.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(w)[0];r&&r.remove(),n.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:p,index:f,container:h},item:d}})),c=u=d=g=null}})),a(n,"drop",(function(a){if(L(n,d.parentElement)){a.preventDefault(),a.stopPropagation(),e(d,"dropped","true");var o=Array.from(i.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(w)[0];if(o){o.replaceWith(d),void 0!==d.oldDisplay&&(d.style.display=d.oldDisplay,delete d.oldDisplay),n.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:p,index:f,container:h},item:d}}));var l=r(n).placeholder,u=t(h.children,s.items).filter((function(e){return e!==l})),c=!0===this.isSortable?this:this.parentElement,g=t(c.children,e(c,"items")).filter((function(e){return e!==l})),y=b(d,Array.from(d.parentElement.children).filter((function(e){return e!==l}))),_=b(d,g);s.dropTargetContainerClass&&c.classList.remove(s.dropTargetContainerClass),p===y&&h===c||n.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:p,index:f,container:h,itemsBeforeUpdate:m,items:u},destination:{index:_,elementIndex:y,container:c,itemsBeforeUpdate:v,items:g},item:d}}))}else e(d,"dropped","false")}}));var O=function(e,t){var i;return void 0===t&&(t=0),function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];clearTimeout(i),i=setTimeout((function(){e.apply(void 0,n)}),t)}}((function(e,n,a,o){if(d)if(s.forcePlaceholderSize&&(r(e).placeholder.style.height=u+"px",r(e).placeholder.style.width=c+"px"),-1<Array.from(e.children).indexOf(n)){var l=S(n),h=k(n),f=b(r(e).placeholder,n.parentElement.children),p=b(n,n.parentElement.children);if(u<l||c<h){var m=l-u,g=h-c,v=y(n).top,w=y(n).left;if(f<p&&("vertical"===s.orientation&&o<v||"horizontal"===s.orientation&&a<w))return;if(p<f&&("vertical"===s.orientation&&v+l-m<o||"horizontal"===s.orientation&&w+h-g<a))return}void 0===d.oldDisplay&&(d.oldDisplay=d.style.display),"none"!==d.style.display&&(d.style.display="none");var _=!1;try{var A=y(n).top+n.offsetHeight/2,C=y(n).left+n.offsetWidth/2;_="vertical"===s.orientation&&A<=o||"horizontal"===s.orientation&&C<=a}catch(n){_=f<p}_?E(n,r(e).placeholder):T(n,r(e).placeholder),Array.from(i.values()).filter((function(e){return void 0!==e.placeholder})).forEach((function(t){t.placeholder!==r(e).placeholder&&t.placeholder.remove()}))}else{var R=Array.from(i.values()).filter((function(e){return void 0!==e.placeholder})).map((function(e){return e.placeholder}));-1!==R.indexOf(n)||e!==n||t(n.children,s.items).length||(R.forEach((function(e){return e.remove()})),n.appendChild(r(e).placeholder))}}),s.debounce),P=function(i){var n=i.target,a=!0===n.isSortable?n:N(n,i);if(n=F(a,n),d&&L(a,d.parentElement)&&"true"!==e(a,"_disabled")){var s=e(a,"opts");parseInt(s.maxItems)&&t(a.children,e(a,"items")).length>parseInt(s.maxItems)&&d.parentElement!==a||(i.preventDefault(),i.stopPropagation(),i.dataTransfer.dropEffect=!0===r(a).getConfig("copy")?"copy":"move",O(a,n,i.pageX,i.pageY))}};a(A.concat(n),"dragover",P),a(A.concat(n),"dragenter",P)})),n)}return j.destroy=function(i){var n,r,a,o;r=e(n=i,"opts")||{},a=t(n.children,r.items),o=A(a,r.handle),x(n,!1),s(n,"dragover"),s(n,"dragenter"),s(n,"dragstart"),s(n,"dragend"),s(n,"drop"),I(n),s(o,"mousedown"),O(a),M(a),P(h,g),n.isSortable=!1},j.enable=function(e){U(e)},j.disable=function(i){var n,r,a,l;r=e(n=i,"opts"),a=t(n.children,r.items),l=A(a,r.handle),o(n,"aria-dropeffect","none"),e(n,"_disabled","true"),o(l,"draggable","false"),s(l,"mousedown"),x(n,!1)},j.__testing={data:e,removeItemEvents:O,removeItemData:M,removeSortableData:I,removeContainerEvents:P},j}();function triggerEvent(e,t="",i=!1,n={}){if(null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument&&""!=t){n.plyr=this;var r=new CustomEvent(t,{bubbles:i,detail:n});e.dispatchEvent(r)}}function assurePlaybackState(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,triggerEvent.call(this,this.media,e?"play":"pause"))}"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=13)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d}));var n=i(5);function r(){}var a={trace:r,debug:r,log:r,warn:r,info:r,error:r},s=a;var o=Object(n.a)();var l=function(e){if(o.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];i.forEach((function(t){s[t]=e[t]?e[t].bind(e):function(e){var t=o.console[e];return t?function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];n[0]&&(n[0]=function(e,t){return"["+e+"] > "+t}(e,n[0])),t.apply(o.console,n)}:r}(t)}))}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},d=s},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(n||(n={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var n,r=i(5),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,i){for(var n=i,r=0;e.isHeader(t,i);)r+=10,r+=e._readSize(t,i+6),e.isFooter(t,i+10)&&(r+=10),i+=r;if(r>0)return t.subarray(n,n+r)},e._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var i=e.getID3Frames(t),n=0;n<i.length;n++){var r=i[n];if(e.isTimeStampFrame(r))return e._readTimeStamp(r)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var i=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:i,size:n,data:t.subarray(10,10+n)}},e.getID3Frames=function(t){for(var i=0,n=[];e.isHeader(t,i);){for(var r=e._readSize(t,i+6),a=(i+=10)+r;i+8<a;){var s=e._getFrameData(t.subarray(i)),o=e._decodeFrame(s);o&&n.push(o),i+=s.size+10}e.isFooter(t,i)&&(i+=10)}return n},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var i=e._utf8ArrayToStr(t.data,!0),n=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:n.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var i=1,n=e._utf8ArrayToStr(t.data.subarray(i),!0);i+=n.length+1;var r=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:n,data:r}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var i=1,n=e._utf8ArrayToStr(t.data.subarray(i));i+=n.length+1;var r=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:n,data:r}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var i=s();if(i){var n=i.decode(e);if(t){var r=n.indexOf("\0");return-1!==r?n.substring(0,r):n}return n.replace(/\0/g,"")}for(var a,o,l,d=e.length,u="",c=0;c<d;){if(0===(a=e[c++])&&t)return u;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(a);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[c++],l=e[c++],u+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&l)<<0)}}return u},e}();function s(){var e=Object(r.a)();return n||void 0===e.TextDecoder||(n=new e.TextDecoder("utf-8")),n}var o=a._utf8ArrayToStr;t.a=a},function(e,t,i){"use strict";function n(){return"undefined"==typeof window?self:window}i.d(t,"a",(function(){return n}))},function(e,t,i){var n,r,a,s,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=o.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=o.normalizePath(n.path),o.buildURLFromParts(n)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=r.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var d={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(d.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var u=s.path,c=u.substring(0,u.lastIndexOf("/")+1)+a.path;d.path=o.normalizePath(c)}else d.path=s.path,a.params||(d.params=s.params,a.query||(d.query=s.query));return null===d.path&&(d.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(d)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},function(e,t,i){"use strict";var n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),r=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),n=0;n<4;n++)i[n]=t.getUint32(4*n);return i},t.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],r=i[1],a=i[2],s=i[3],o=this.invSubMix,l=o[0],d=o[1],u=o[2],c=o[3],h=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[f]=g,t[g]=f;var v=h[f],y=h[v],b=h[y],w=257*h[g]^16843008*g;n[f]=w<<24|w>>>8,r[f]=w<<16|w>>>16,a[f]=w<<8|w>>>24,s[f]=w,w=16843009*b^65537*y^257*v^16843008*f,l[g]=w<<24|w>>>8,d[g]=w<<16|w>>>16,u[g]=w<<8|w>>>24,c[g]=w,f?(f=v^h[h[h[b^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,n=0;n<t.length&&i;)i=t[n]===this.key[n],n++;if(!i){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var a,s,o,l,d=this.ksRows=4*(r+6+1),u=this.keySchedule=new Uint32Array(d),c=this.invKeySchedule=new Uint32Array(d),h=this.sBox,f=this.rcon,p=this.invSubMix,m=p[0],g=p[1],v=p[2],y=p[3];for(a=0;a<d;a++)a<r?o=u[a]=t[a]:(l=o,a%r==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/r|0]<<24):r>6&&a%r==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),u[a]=o=(u[a-r]^l)>>>0);for(s=0;s<d;s++)a=d-s,l=3&s?u[a]:u[a-4],c[s]=s<4||a<=4?l:m[h[l>>>24]]^g[h[l>>>16&255]]^v[h[l>>>8&255]]^y[h[255&l]],c[s]=c[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,i,n){for(var r,a,s,o,l,d,u,c,h,f,p,m,g,v,y,b,w,_=this.keySize+6,T=this.invKeySchedule,E=this.invSBox,S=this.invSubMix,k=S[0],A=S[1],C=S[2],R=S[3],L=this.uint8ArrayToUint32Array_(i),D=L[0],x=L[1],O=L[2],P=L[3],I=new Int32Array(e),M=new Int32Array(I.length),N=this.networkToHostOrderSwap;t<I.length;){for(h=N(I[t]),f=N(I[t+1]),p=N(I[t+2]),m=N(I[t+3]),l=h^T[0],d=m^T[1],u=p^T[2],c=f^T[3],g=4,v=1;v<_;v++)r=k[l>>>24]^A[d>>16&255]^C[u>>8&255]^R[255&c]^T[g],a=k[d>>>24]^A[u>>16&255]^C[c>>8&255]^R[255&l]^T[g+1],s=k[u>>>24]^A[c>>16&255]^C[l>>8&255]^R[255&d]^T[g+2],o=k[c>>>24]^A[l>>16&255]^C[d>>8&255]^R[255&u]^T[g+3],l=r,d=a,u=s,c=o,g+=4;r=E[l>>>24]<<24^E[d>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^T[g],a=E[d>>>24]<<24^E[u>>16&255]<<16^E[c>>8&255]<<8^E[255&l]^T[g+1],s=E[u>>>24]<<24^E[c>>16&255]<<16^E[l>>8&255]<<8^E[255&d]^T[g+2],o=E[c>>>24]<<24^E[l>>16&255]<<16^E[d>>8&255]<<8^E[255&u]^T[g+3],g+=3,M[t]=N(r^D),M[t+1]=N(o^x),M[t+2]=N(s^O),M[t+3]=N(a^P),D=h,x=f,O=p,P=m,t+=4}return n?(w=(b=(y=M.buffer).byteLength)&&new DataView(y).getUint8(b-1))?y.slice(0,b-w):y:M.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=i(2),o=i(0),l=i(1),d=i(5),u=Object(d.a)(),c=function(){function e(e,t,i){var n=(void 0===i?{}:i).removePKCS7Padding,r=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=r,r)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,i,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.b.log("JS AES decrypt"),this.logEnabled=!1);var d=this.decryptor;d||(this.decryptor=d=new a),d.expandKey(t),s(d.decrypt(e,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(o.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new r(u,t)),this.fastAesKey.expandKey().then((function(r){new n(u,i).decrypt(e,r).catch((function(n){l.onWebCryptoError(n,e,t,i,s)})).then((function(e){s(e)}))})).catch((function(n){l.onWebCryptoError(n,e,t,i,s)}))}},t.onWebCryptoError=function(e,t,i,n,r){this.config.enableSoftwareAES?(o.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,n,r)):(o.b.error("decrypting error : "+e.message),this.observer.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=c},function(e,t,i){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function a(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,n,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new s(i,n||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function d(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(r=!1)),d.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)n.call(e,t)&&i.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},d.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,a=i.length,s=new Array(a);n<a;n++)s[n]=i[n].fn;return s},d.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},d.prototype.emit=function(e,t,i,n,a,s){var o=r?r+e:e;if(!this._events[o])return!1;var l,d,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,a),!0;case 6:return u.fn.call(u.context,t,i,n,a,s),!0}for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];u.fn.apply(u.context,l)}else{var h,f=u.length;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),c){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,i);break;case 4:u[d].fn.call(u[d].context,t,i,n);break;default:if(!l)for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u[d].fn.apply(u[d].context,l)}}return!0},d.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},d.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},d.prototype.removeListener=function(e,t,i,n){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||n&&!s.once||i&&s.context!==i||l(this,a);else{for(var o=0,d=[],u=s.length;o<u;o++)(s[o].fn!==t||n&&!s[o].once||i&&s[o].context!==i)&&d.push(s[o]);d.length?this._events[a]=1===d.length?d[0]:d:l(this,a)}return this},d.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=r,d.EventEmitter=d,e.exports=d},function(e,t,i){"use strict";var n=i(1),r=i(2),a=i(7),s=i(3),o=i(0),l=i(5);function d(e,t){return 255===e[t]&&240==(246&e[t+1])}function u(e,t){return 1&e[t+1]?7:9}function c(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&d(e,t))}function f(e,t){if(h(e,t)){var i=u(e,t);t+5<e.length&&(i=c(e,t));var n=t+i;if(n===e.length||n+1<e.length&&d(e,n))return!0}return!1}function p(e,t,i,a,s){if(!e.samplerate){var l=function(e,t,i,a){var s,l,d,u,c,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[i+2])>>>6),!((l=(60&t[i+2])>>>2)>p.length-1))return u=(1&t[i+2])<<2,u|=(192&t[i+3])>>>6,o.b.log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+u),/firefox/i.test(h)?l>=6?(s=5,c=new Array(4),d=l-3):(s=2,c=new Array(2),d=l):-1!==h.indexOf("android")?(s=2,c=new Array(2),d=l):(s=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&l>=6?d=l-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(l>=6&&1===u||/vivaldi/i.test(h))||!a&&1===u)&&(s=2,c=new Array(2)),d=l)),c[0]=s<<3,c[0]|=(14&l)>>1,c[1]|=(1&l)<<7,c[1]|=u<<3,5===s&&(c[1]|=(14&d)>>1,c[2]=(1&d)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:p[l],channelCount:u,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}(t,i,a,s);e.config=l.config,e.samplerate=l.samplerate,e.channelCount=l.channelCount,e.codec=l.codec,e.manifestCodec=l.manifestCodec,o.b.log("parsed codec:"+e.codec+",rate:"+l.samplerate+",nb channel:"+l.channelCount)}}function m(e){return 9216e4/e}function g(e,t,i,n,r){var a=function(e,t,i,n,r){var a,s,o=e.length;if(a=u(e,t),s=c(e,t),(s-=a)>0&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:i+n*r}}(t,i,n,r,m(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,d={unit:t.subarray(i+o,i+o+l),pts:s,dts:s};return e.samples.push(d),{sample:d,length:l+o}}}var v=i(4),y=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(f(e,t))return o.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,i,n){for(var r=this._audioTrack,a=v.a.getID3Data(e,0)||[],l=v.a.getTimeStamp(a),d=Object(s.a)(l)?90*l:9e4*t,u=0,c=d,f=e.length,m=a.length,y=[{pts:c,dts:c,data:a}];m<f-1;)if(h(e,m)&&m+5<f){p(r,this.observer,e,m,r.manifestCodec);var b=g(r,e,m,d,u);if(!b){o.b.log("Unable to parse AAC frame");break}m+=b.length,c=b.sample.pts,u++}else v.a.isHeader(e,m)?(a=v.a.getID3Data(e,m),y.push({pts:c,dts:c,data:a}),m+=a.length):m++;this.remuxer.remux(r,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,n)},t.destroy=function(){},e}(),b=i(10),w={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,n,r){if(!(i+24>t.length)){var a=this.parseHeader(t,i);if(a&&i+a.frameLength<=t.length){var s=n+r*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(i,i+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,n=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==i&&0!==r&&15!==r&&3!==a){var o=3===i?3-n:3===n?3:4,l=1e3*w.BitratesMap[14*o+r-1],d=3===i?0:2===i?1:2,u=w.SamplingRateMap[3*d+a],c=e[t+3]>>6==3?1:2,h=w.SamplesCoefficients[i][n],f=w.BytesInSlot[n],p=8*h*f;return{sampleRate:u,channelCount:c,frameLength:parseInt(h*l/u+s,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),n=4;i&&i.frameLength&&(n=i.frameLength);var r=t+n;if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}},_=w,T=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");n.set(e.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,i=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(i+this.readEG()+256)%256),i=0===n?i:n},t.readSPS=function(){var e,t,i,n,r,a,s,o=0,l=0,d=0,u=0,c=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(c(),e=c(),h(5),m(3),c(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=f();if(3===b&&m(1),v(),v(),m(1),p())for(a=3!==b?8:12,s=0;s<a;s++)p()&&y(s<6?16:64)}v();var w=f();if(0===w)f();else if(1===w)for(m(1),g(),g(),t=f(),s=0;s<t;s++)g();v(),m(1),i=f(),n=f(),0===(r=h(1))&&m(1),m(1),p()&&(o=f(),l=f(),d=f(),u=f());var _=[1,1];if(p()&&p())switch(c()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(i+1)-2*o-2*l),height:(2-r)*(n+1)*16-(r?2:4)*(d+u),pixelRatio:_}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),E=function(){function e(e,t,i,n){this.decryptdata=i,this.discardEPB=n,this.decrypter=new a.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,i,n){var r=e[t].unit,a=r.subarray(16,r.length-r.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,(function(a){a=new Uint8Array(a),r.set(a,16),n||o.decryptAacSamples(e,t+1,i)}))},t.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,n),!n)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),n=0,r=32;r<=e.length-16;r+=160,n+=16)i.set(e.subarray(r,r+16),n);return i},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,n=32;n<=e.length-16;n+=160,i+=16)e.set(t.subarray(i,i+16),n);return e},t.decryptAvcSample=function(e,t,i,n,r,a){var s=this.discardEPB(r.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,(function(o){r.data=l.getAvcDecryptedUnit(s,o),a||l.decryptAvcSamples(e,t,i+1,n)}))},t.decryptAvcSamples=function(e,t,i,n){for(;;t++,i=0){if(t>=e.length)return void n();for(var r=e[t].units;!(i>=r.length);i++){var a=r[i];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,n,a,s),!s)return}}}},e}(),S={video:1,audio:2,id3:3,text:4},k=function(){function e(e,t,i,n){this.observer=e,this.config=i,this.typeSupported=n,this.remuxer=t,this.sampleAes=null}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new E(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var i=e._syncOffset(t);return!(i<0||(i&&o.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:S[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,i,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",r),this._audioTrack=e.createTrack("audio",r),this._id3Track=e.createTrack("id3",r),this._txtTrack=e.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=n,this._duration=r},t.resetTimeStamp=function(){},t.append=function(t,i,a,s){var l,d,u,c,h,f=t.length,p=!1;this.contiguous=a;var m=this.pmtParsed,g=this._avcTrack,v=this._audioTrack,y=this._id3Track,b=g.pid,w=v.pid,_=y.pid,T=this._pmtId,E=g.pesData,S=v.pesData,k=y.pesData,A=this._parsePAT,C=this._parsePMT,R=this._parsePES,L=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),P=e._syncOffset(t);for(f-=(f+P)%188,l=P;l<f;l+=188)if(71===t[l]){if(d=!!(64&t[l+1]),u=((31&t[l+1])<<8)+t[l+2],(48&t[l+3])>>4>1){if((c=l+5+t[l+4])===l+188)continue}else c=l+4;switch(u){case b:d&&(E&&(h=R(E))&&L(h,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(c,l+188)),E.size+=l+188-c);break;case w:d&&(S&&(h=R(S))&&(v.isAAC?D(h):x(h)),S={data:[],size:0}),S&&(S.data.push(t.subarray(c,l+188)),S.size+=l+188-c);break;case _:d&&(k&&(h=R(k))&&O(h),k={data:[],size:0}),k&&(k.data.push(t.subarray(c,l+188)),k.size+=l+188-c);break;case 0:d&&(c+=t[c]+1),T=this._pmtId=A(t,c);break;case T:d&&(c+=t[c]+1);var I=C(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=I.avc)>0&&(g.pid=b),(w=I.audio)>0&&(v.pid=w,v.isAAC=I.isAAC),(_=I.id3)>0&&(y.pid=_),p&&!m&&(o.b.log("reparse from beginning"),p=!1,l=P-188),m=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(h=R(E))?(L(h,!0),g.pesData=null):g.pesData=E,S&&(h=R(S))?(v.isAAC?D(h):x(h),v.pesData=null):(S&&S.size&&o.b.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=S),k&&(h=R(k))?(O(h),y.pesData=null):y.pesData=k,null==this.sampleAes?this.remuxer.remux(v,g,y,this._txtTrack,i,a,s):this.decryptAndRemux(v,g,y,this._txtTrack,i,a,s)},t.decryptAndRemux=function(e,t,i,n,r,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){o.decryptAndRemuxAvc(e,t,i,n,r,a,s)}))}else this.decryptAndRemuxAvc(e,t,i,n,r,a,s)},t.decryptAndRemuxAvc=function(e,t,i,n,r,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){o.remuxer.remux(e,t,i,n,r,a,s)}))}else this.remuxer.remux(e,t,i,n,r,a,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._parsePMT=function(e,t,i,n){var r,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<r;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){o.b.log("unknown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!n){o.b.log("unknown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:i?-1===s.audio&&(s.audio=a,s.isAAC=!1):o.b.log("MPEG audio found, not supported in this browser for now");break;case 36:o.b.warn("HEVC stream type found, not supported for now");break;default:o.b.log("unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,i,n,r,a,s,l,d,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;if(192&(i=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&i?((l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(l-=8589934592),s-l>54e5&&(o.b.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),d=(r=t[8])+9,e.size<=d)return null;e.size-=d,a=new Uint8Array(e.size);for(var f=0,p=c.length;f<p;f++){var m=(t=c[f]).byteLength;if(d){if(d>m){d-=m;continue}t=t.subarray(d),m-=d,d=0}a.set(t,u),u+=m}return n&&(n-=r+3),{data:a,pts:s,dts:l,len:n}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,n=i.length;if(isNaN(e.pts)){if(!n)return void t.dropped++;var r=i[n-1];e.pts=r.pts,e.dts=r.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,i.push(e)):t.dropped++}e.debug.length&&o.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var i,n,r,a=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),l=this.avcSample,d=!1,u=this.pushAccesUnit.bind(this),c=function(e,t,i,n){return{key:e,pts:t,dts:i,units:[],debug:n}};e.data=null,l&&o.length&&!s.audFound&&(u(l,s),l=this.avcSample=c(!1,e.pts,e.dts,"")),o.forEach((function(t){switch(t.type){case 1:n=!0,l||(l=a.avcSample=c(!0,e.pts,e.dts,"")),l.frame=!0;var o=t.data;if(d&&o.length>4){var h=new T(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=c(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(i=new T(a.discardEPB(t.data))).readUByte();for(var f=0,p=0,m=!1,g=0;!m&&i.bytesAvailable>1;){f=0;do{f+=g=i.readUByte()}while(255===g);p=0;do{p+=g=i.readUByte()}while(255===g);if(4===f&&0!==i.bytesAvailable){if(m=!0,181===i.readUByte()&&49===i.readUShort()&&1195456820===i.readUInt()&&3===i.readUByte()){var y=i.readUByte(),b=31&y,w=[y,i.readUByte()];for(r=0;r<b;r++)w.push(i.readUByte()),w.push(i.readUByte()),w.push(i.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:w})}}else if(5===f&&0!==i.bytesAvailable){if(m=!0,p>16){var _=[];for(r=0;r<16;r++)_.push(i.readUByte().toString(16)),3!==r&&5!==r&&7!==r&&9!==r||_.push("-");var E=p-16,S=new Uint8Array(E);for(r=0;r<E;r++)S[r]=i.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:_.join(""),userDataBytes:S,userData:Object(v.b)(S.buffer)})}}else if(p<i.bytesAvailable)for(r=0;r<p;r++)i.readUByte()}break;case 7:if(n=!0,d=!0,!s.sps){var k=(i=new T(t.data)).readSPS();s.width=k.width,s.height=k.height,s.pixelRatio=k.pixelRatio,s.sps=[t.data],s.duration=a._duration;var A=t.data.subarray(1,4),C="avc1.";for(r=0;r<3;r++){var R=A[r].toString(16);R.length<2&&(R="0"+R),C+=R}s.codec=C}break;case 8:n=!0,s.pps||(s.pps=[t.data]);break;case 9:n=!1,s.audFound=!0,l&&u(l,s),l=a.avcSample=c(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&n&&l.units.push(t)})),t&&l&&(u(l,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var n=i-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var i=this._avcTrack.samples;t=i[i.length-1]}if(t){var n=t.units;e=n[n.length-1]}return e},t._parseAVCNALu=function(e){var t,i,n,r,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,d=l,u=[],c=-1;for(-1===l&&(c=0,r=31&e[0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){if(c>=0)n={data:e.subarray(c,a-l-1),type:r},u.push(n);else{var h=this._getLastNalUnit();if(h&&(d&&a<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),(i=a-l-1)>0)){var f=new Uint8Array(h.data.byteLength+i);f.set(h.data,0),f.set(e.subarray(0,i),h.data.byteLength),h.data=f}}a<s?(c=a,r=31&e[a],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(c>=0&&l>=0&&(n={data:e.subarray(c,s),type:r,state:l},u.push(n)),0===u.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+e.byteLength);m.set(p.data,0),m.set(e,p.data.byteLength),p.data=m}}return o.naluState=l,u},t.discardEPB=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},t._parseAACPES=function(e){var t,i,a,s,l,d,u,c=this._audioTrack,f=e.data,v=e.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var w=new Uint8Array(y.byteLength+f.byteLength);w.set(y,0),w.set(f,y.byteLength),f=w}for(a=0,l=f.length;a<l-1&&!h(f,a);a++);if(!a||(a<l-1?(d="AAC PES did not start with ADTS header,offset:"+a,u=!1):(d="no ADTS header found in AAC PES",u=!0),o.b.warn("parsing error:"+d),this.observer.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:u,reason:d}),!u)){if(p(c,this.observer,f,a,this.audioCodec),i=0,t=m(c.samplerate),y&&b){var _=b+t;Math.abs(_-v)>1&&(o.b.log("AAC: align PTS for overlapping frames by "+Math.round((_-v)/90)),v=_)}for(;a<l;){if(h(f,a)){if(a+5<l){var T=g(c,f,a,v,i);if(T){a+=T.length,s=T.sample.pts,i++;continue}}break}a++}y=a<l?f.subarray(a,l):null,this.aacOverFlow=y,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,i=t.length,n=0,r=0,a=e.pts;r<i;)if(_.isHeader(t,r)){var s=_.appendFrame(this._audioTrack,t,r,a,n);if(!s)break;r+=s.length,n++}else r++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),A=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,i,n=v.a.getID3Data(e,0);if(n&&void 0!==v.a.getTimeStamp(n))for(t=n.length,i=Math.min(e.length-1,t+100);t<i;t++)if(_.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,i,n){for(var r=v.a.getID3Data(e,0),a=v.a.getTimeStamp(r),s=a?90*a:9e4*t,o=r.length,l=e.length,d=0,u=0,c=this._audioTrack,h=[{pts:s,dts:s,data:r}];o<l;)if(_.isHeader(e,o)){var f=_.appendFrame(c,e,o,s,d);if(!f)break;o+=f.length,u=f.sample.pts,d++}else v.a.isHeader(e,o)?(r=v.a.getID3Data(e,o),h.push({pts:u,dts:u,data:r}),o+=r.length):o++;this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,i,n)},t.destroy=function(){},e}(),C=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),R=Math.pow(2,32)-1,L=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,r))},e.box=function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,a=r;r--;)n+=i[r].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),r=0,n=8;r<a;r++)t.set(i[r],n),n+=i[r].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var n=Math.floor(i/(R+1)),r=Math.floor(i%(R+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,i))},e.moov=function(t){for(var i=t.length,n=[];i--;)n[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,n=[];i--;)n[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,i){i*=t;var n=Math.floor(i/(R+1)),r=Math.floor(i%(R+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var i,n,r=t.samples||[],a=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)i=r[n].flags,a[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i,n,r,a=[],s=[];for(i=0;i<t.sps.length;i++)r=(n=t.sps[i]).byteLength,a.push(r>>>8&255),a.push(255&r),a=a.concat(Array.prototype.slice.call(n));for(i=0;i<t.pps.length;i++)r=(n=t.pps[i]).byteLength,s.push(r>>>8&255),s.push(255&r),s=s.concat(Array.prototype.slice.call(n));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,d=t.height,u=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var i=t.id,n=t.duration*t.timescale,r=t.width,a=t.height,s=Math.floor(n/(R+1)),o=Math.floor(n%(R+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,i){var n=e.sdtp(t),r=t.id,a=Math.floor(i/(R+1)),s=Math.floor(i%(R+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var n,r,a,s,o,l,d=t.samples||[],u=d.length,c=12+16*u,h=new Uint8Array(c);for(i+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),n=0;n<u;n++)a=(r=d[n]).duration,s=r.size,o=r.flags,l=r.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var i,n=e.moov(t);return(i=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),i.set(n,e.FTYP.byteLength),i},e}();function D(e,t,i,n){void 0===i&&(i=1),void 0===n&&(n=!1);var r=e*t*i;return n?Math.round(r):r}function x(e,t){return void 0===t&&(t=!1),D(e,1e3,1/9e4,t)}function O(e,t){return void 0===t&&(t=1),D(e,9e4,1/t)}var P,I=O(10),M=O(.2),N=function(){function e(e,t,i,n){this.observer=e,this.config=t,this.typeSupported=i;var r=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&r&&!r.match("CriOS"),this.ISGenerated=!1}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.remux=function(e,t,i,r,a,s,l){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var d=e.samples.length,u=t.samples.length,c=a,h=a;if(d&&u){var f=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;c+=Math.max(0,f),h+=Math.max(0,-f)}if(d){e.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p,m=this.remuxAudio(e,c,s,l);u&&(m&&(p=m.endPTS-m.startPTS),t.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,h,s,p,l))}else if(u){var g=this.remuxVideo(t,h,s,0,l);g&&e.codec&&this.remuxEmptyAudio(e,c,s,g)}}i.samples.length&&this.remuxID3(i,a),r.samples.length&&this.remuxText(r,a),this.observer.trigger(n.a.FRAG_PARSED)},t.generateIS=function(e,t,i){var a,s,l=this.observer,d=e.samples,u=t.samples,c=this.typeSupported,h="audio/mp4",f={},p={tracks:f},m=void 0===this._initPTS;if(m&&(a=s=1/0),e.config&&d.length&&(e.timescale=e.samplerate,o.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),f.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array:L.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(a=s=d[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&u.length){var g=t.inputTimeScale;t.timescale=g,f.video={container:"video/mp4",codec:t.codec,initSegment:L.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(a=Math.min(a,u[0].pts-g*i),s=Math.min(s,u[0].dts-g*i),this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:a}))}Object.keys(f).length?(l.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,m&&(this._initPTS=a,this._initDTS=s)):l.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,i,a,s){var l,d,u,c,h,f,p,m=8,g=e.timescale,v=e.samples,y=[],b=v.length,w=this._PTSNormalize,_=this._initPTS,T=this.nextAvcDts,E=this.isSafari;if(0!==b){E&&(i|=v.length&&T&&(s&&Math.abs(t-T/g)<.1||Math.abs(v[0].pts-T-_)<g/5)),i||(T=t*g),v.forEach((function(e){e.pts=w(e.pts-_,T),e.dts=w(e.dts-_,T)})),v.sort((function(e,t){var i=e.dts-t.dts,n=e.pts-t.pts;return i||n||e.id-t.id}));var S=v.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-1*M)}),0);if(S<0){o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+x(S,!0)+" ms to overcome this issue");for(var k=0;k<v.length;k++)v[k].dts+=S}var A=v[0];h=Math.max(A.dts,0),c=Math.max(A.pts,0);var C=h-T;i&&C&&(C>1?o.b.log("AVC: "+x(C,!0)+" ms hole between fragments detected,filling it"):C<-1&&o.b.log("AVC: "+x(-C,!0)+" ms overlapping between fragments detected"),h=T,v[0].dts=h,c=Math.max(c-C,T),v[0].pts=c,o.b.log("Video: PTS/DTS adjusted: "+x(c,!0)+"/"+x(h,!0)+", delta: "+x(C,!0)+" ms")),A=v[v.length-1],p=Math.max(A.dts,0),f=Math.max(A.pts,0,p),E&&(l=Math.round((p-h)/(v.length-1)));for(var R=0,D=0,O=0;O<b;O++){for(var P=v[O],I=P.units,N=I.length,F=0,U=0;U<N;U++)F+=I[U].data.length;D+=F,R+=N,P.length=F,P.dts=E?h+O*l:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var B=D+4*R+8;try{d=new Uint8Array(B)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:r.b.MUX_ERROR,details:r.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating video mdat "+B})}var j=new DataView(d.buffer);j.setUint32(0,B),d.set(L.types.mdat,4);for(var $=0;$<b;$++){for(var H=v[$],G=H.units,q=0,K=void 0,W=0,V=G.length;W<V;W++){var Y=G[W],z=Y.data,X=Y.data.byteLength;j.setUint32(m,X),m+=4,d.set(z,m),m+=X,q+=4+X}if(E)K=Math.max(0,l*Math.round((H.pts-H.dts)/l));else{if($<b-1)l=v[$+1].dts-H.dts;else{var Q=this.config,J=H.dts-v[$>0?$-1:$].dts;if(Q.stretchShortVideoTrack){var Z=Q.maxBufferHole,ee=Math.floor(Z*g),te=(a?c+a*g:this.nextAudioPts)-H.pts;te>ee?((l=te-J)<0&&(l=J),o.b.log("It is approximately "+x(te,!1)+" ms to the next segment; using duration "+x(l,!1)+" ms for the last video frame.")):l=J}else l=J}K=Math.round(H.pts-H.dts)}y.push({size:q,duration:l,cts:K,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:H.key?2:1,isNonSync:H.key?0:1}})}this.nextAvcDts=p+l;var ie=e.dropped;if(e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ne=y[0].flags;ne.dependsOn=2,ne.isNonSync=0}e.samples=y,u=L.moof(e.sequenceNumber++,h,e),e.samples=[];var re={data1:u,data2:d,startPTS:c/g,endPTS:(f+l)/g,startDTS:h/g,endDTS:this.nextAvcDts/g,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:ie};return this.observer.trigger(n.a.FRAG_PARSING_DATA,re),re}},t.remuxAudio=function(e,t,i,a){var s,l,d,u,c,h,f=e.inputTimeScale,p=e.timescale,m=f/p,g=(e.isAAC?1024:1152)*m,v=this._PTSNormalize,y=this._initPTS,b=!e.isAAC&&this.typeSupported.mpeg,w=b?0:8,_=e.samples,T=[],E=this.nextAudioPts;if(i|=_.length&&E&&(a&&Math.abs(t-E/f)<.1||Math.abs(_[0].pts-E-y)<20*g),_.forEach((function(e){e.pts=e.dts=v(e.pts-y,t*f)})),0!==(_=_.filter((function(e){return e.pts>=0}))).length){if(i||(E=a?t*f:_[0].pts),e.isAAC)for(var S=this.config.maxAudioFramesDrift,k=0,A=E;k<_.length;){var R,D=_[k];if((R=D.pts-A)<=-S*g)o.b.warn("Dropping 1 audio frame @ "+x(A,!0)+" ms due to "+x(R,!0)+" ms overlap."),_.splice(k,1);else if(R>=S*g&&R<I&&A){var O=Math.round(R/g);o.b.warn("Injecting "+O+" audio frames @ "+x(A,!0)+" ms due to "+x(A,!0)+" ms gap.");for(var P=0;P<O;P++){var M=Math.max(A,0);(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),l=D.unit.subarray()),_.splice(k,0,{unit:l,pts:M,dts:M}),A+=g,k++}D.pts=D.dts=A,A+=g,k++}else Math.abs(R),D.pts=D.dts=A,A+=g,k++}for(var N=_.length,F=0;N--;)F+=_[N].unit.byteLength;for(var U=0,B=_.length;U<B;U++){var j=_[U],$=j.unit,H=j.pts;if(void 0!==h)s.duration=Math.round((H-h)/m);else{var G=H-E,q=0;if(i&&e.isAAC&&G){if(G>0&&G<I)q=Math.round((H-E)/g),o.b.log(x(G,!0)+" ms hole between AAC samples detected,filling it"),q>0&&((l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l=$.subarray()),F+=q*l.length);else if(G<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta: "+x(E,!0)+" ms / "+x(H,!0)+" ms / "+x(-G,!0)+" ms"),F-=$.byteLength;continue}H=E}if(c=H,!(F>0))return;F+=w;try{d=new Uint8Array(F)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:r.b.MUX_ERROR,details:r.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating audio mdat "+F})}b||(new DataView(d.buffer).setUint32(0,F),d.set(L.types.mdat,4));for(var K=0;K<q;K++)(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),l=$.subarray()),d.set(l,w),w+=l.byteLength,s={size:l.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s)}d.set($,w);var W=$.byteLength;w+=W,s={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s),h=H}var V=0;if((N=T.length)>=2&&(V=T[N-2].duration,s.duration=V),N){this.nextAudioPts=E=h+m*V,e.samples=T,u=b?new Uint8Array:L.moof(e.sequenceNumber++,c/m,e),e.samples=[];var Y=c/f,z=E/f,X={data1:u,data2:d,startPTS:Y,endPTS:z,startDTS:Y,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:N};return this.observer.trigger(n.a.FRAG_PARSING_DATA,X),X}return null}},t.remuxEmptyAudio=function(e,t,i,n){var r=e.inputTimeScale,a=r/(e.samplerate?e.samplerate:r),s=this.nextAudioPts,l=(void 0!==s?s:n.startDTS*r)+this._initDTS,d=n.endDTS*r+this._initDTS,u=1024*a,c=Math.ceil((d-l)/u),h=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.b.warn("remux empty Audio"),h){for(var f=[],p=0;p<c;p++){var m=l+p*u;f.push({unit:h,pts:m,dts:m})}e.samples=f,this.remuxAudio(e,t,i)}else o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e){var t,i=e.samples.length,r=e.inputTimeScale,a=this._initPTS,s=this._initDTS;if(i){for(var o=0;o<i;o++)(t=e.samples[o]).pts=(t.pts-a)/r,t.dts=(t.dts-s)/r;this.observer.trigger(n.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},t.remuxText=function(e){e.samples.sort((function(e,t){return e.pts-t.pts}));var t,i=e.samples.length,r=e.inputTimeScale,a=this._initPTS;if(i){for(var s=0;s<i;s++)(t=e.samples[s]).pts=(t.pts-a)/r;this.observer.trigger(n.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},t._PTSNormalize=function(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e},e}(),F=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,i,r,a,s,o,l){var d=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),d.trigger(n.a.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),d.trigger(n.a.FRAG_PARSED)},e}(),U=Object(l.a)();try{P=U.performance.now.bind(U.performance)}catch(e){o.b.debug("Unable to use Performance API on this environment"),P=U.Date.now}var B=function(){function e(e,t,i,n){this.observer=e,this.typeSupported=t,this.config=i,this.vendor=n}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,i,r,s,o,l,d,u,c,h,f){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var m=this.decrypter;null==m&&(m=this.decrypter=new a.a(this.observer,this.config));var g=P();m.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var a=P();p.observer.trigger(n.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),r,s,o,l,d,u,c,h,f)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),r,s,o,l,d,u,c,h,f)},t.pushDecrypted=function(e,t,i,a,s,o,l,d,u,c,h,f){var p=this.demuxer;if(!p||(l||d)&&!this.probe(e)){for(var m=this.observer,g=this.typeSupported,v=this.config,w=[{demux:k,remux:N},{demux:b.a,remux:F},{demux:y,remux:N},{demux:A,remux:N}],_=0,T=w.length;_<T;_++){var E=w[_],S=E.demux.probe;if(S(e)){var C=this.remuxer=new E.remux(m,v,g,this.vendor);p=new E.demux(m,C,v,g),this.probe=S;break}}if(!p)return void m.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=p}var R=this.remuxer;(l||d)&&(p.resetInitSegment(i,a,s,c),R.resetInitSegment()),l&&(p.resetTimeStamp(f),R.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,o,u,h)},e}();t.a=B},function(e,t,i){"use strict";var n=i(0),r=i(1),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,i,n,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==i&&(i="mp4a.40.5"),null==n&&(n="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:i+","+n,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:n,initSegment:a?t:null})),this.observer.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else i&&(this.audioCodec=i),n&&(this.videoCodec=n)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},e.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},e.findBox=function(t,i){var n,r,a,s,o,l,d=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!i.length)return null;for(n=o;n<a;)l=(r=e.readUint32(t,n))>1?n+r:a,e.bin2str(t.subarray(n+4,n+8))===i[0]&&(1===i.length?d.push({data:t,start:n+8,end:l}):(s=e.findBox({data:t,start:n+8,end:l},i.slice(1))).length&&(d=d.concat(s))),n=l;return d},e.parseSegmentIndex=function(t){var i,n=e.findBox(t,["moov"])[0],r=n?n.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;i=[];var o=(s=s[0]).data[0];a=0===o?8:16;var l=e.readUint32(s,a);a+=4,a+=0===o?8:16,a+=2;var d=s.end+0,u=e.readUint16(s,a);a+=2;for(var c=0;c<u;c++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var m=e.readUint32(s,h);h+=4,i.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/l,start:d,end:d+p-1}}),d+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:u,references:i,moovEndOffset:r}},e.parseInitSegment=function(t){var i=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var r=e.findBox(t,["tkhd"])[0];if(r){var a=r.data[r.start],s=0===a?12:20,o=e.readUint32(r,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(a=l.data[l.start])?12:20;var d=e.readUint32(l,s),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];if(c){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));n.b.log("MP4Demuxer:"+c+":"+f+" found")}i[o]={timescale:d,type:c},i[c]={timescale:d,id:o}}}}}})),i},e.getStartDTS=function(t,i){var n,r,a;return n=e.findBox(i,["moof","traf"]),r=[].concat.apply([],n.map((function(i){return e.findBox(i,["tfhd"]).map((function(n){var r,a;return r=e.readUint32(n,4),a=t[r].timescale||9e4,e.findBox(i,["tfdt"]).map((function(t){var i,n;return i=t.data[t.start],n=e.readUint32(t,4),1===i&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0]/a}))}))),a=Math.min.apply(null,r),isFinite(a)?a:0},e.offsetStartDTS=function(t,i,n){e.findBox(i,["moof","traf"]).map((function(i){return e.findBox(i,["tfhd"]).map((function(r){var s=e.readUint32(r,4),o=t[s].timescale||9e4;e.findBox(i,["tfdt"]).map((function(t){var i=t.data[t.start],r=e.readUint32(t,4);if(0===i)e.writeUint32(t,4,r-n*o);else{r*=Math.pow(2,32),r+=e.readUint32(t,8),r-=n*o,r=Math.max(r,0);var s=Math.floor(r/(a+1)),l=Math.floor(r%(a+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}}))}))}))},t.append=function(t,i,n,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var d=e.getStartDTS(s,t);this.initPTS=l=d-i,this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,n,a,t)},t.destroy=function(){},e}();t.a=s},function(e,t,i){function n(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var n=i(i.s=ENTRY_MODULE);return n.default||n}var r="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,n){var s={};s[n]=[];var o=t.toString(),l=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var d,u=l[1],c=new RegExp("(\\\\n|\\W)"+a(u)+r,"g");d=c.exec(o);)"dll-reference"!==d[3]&&s[n].push(d[3]);for(c=new RegExp("\\("+a(u)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+r,"g");d=c.exec(o);)e[d[2]]||(s[n].push(d[1]),e[d[2]]=i(d[1]).m),s[d[2]]=s[d[2]]||[],s[d[2]].push(d[4]);for(var h,f=Object.keys(s),p=0;p<f.length;p++)for(var m=0;m<s[f[p]].length;m++)h=s[f[p]][m],isNaN(1*h)||(s[f[p]][m]=1*s[f[p]][m]);return s}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var r={main:i.m},a=t.all?{main:Object.keys(r.main)}:function(e,t){for(var i={main:[t]},n={main:[]},r={main:{}};o(i);)for(var a=Object.keys(i),l=0;l<a.length;l++){var d=a[l],u=i[d].pop();if(r[d]=r[d]||{},!r[d][u]&&e[d][u]){r[d][u]=!0,n[d]=n[d]||[],n[d].push(u);for(var c=s(e,e[d][u],d),h=Object.keys(c),f=0;f<h.length;f++)i[h[f]]=i[h[f]]||[],i[h[f]]=i[h[f]].concat(c[h[f]])}}return n}(r,e),l="";Object.keys(a).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;a[e][t];)t++;a[e].push(t),r[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return JSON.stringify(t)+": "+r[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return JSON.stringify(e)+": "+r.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),c=new window.Worker(u);return c.objectURL=u,c}},function(e,t,i){"use strict";i.r(t);var n=i(9),r=i(1),a=i(0),s=i(8);t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.removeListener.apply(t,[e].concat(n))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",(function(r){var s=r.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new n.a(t,s.typeSupported,o,s.vendor),Object(a.a)(o.debug),i("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}})),t.on(r.a.FRAG_DECRYPTED,i),t.on(r.a.FRAG_PARSING_INIT_SEGMENT,i),t.on(r.a.FRAG_PARSED,i),t.on(r.a.ERROR,i),t.on(r.a.FRAG_PARSING_METADATA,i),t.on(r.a.FRAG_PARSING_USERDATA,i),t.on(r.a.INIT_PTS_FOUND,i),t.on(r.a.FRAG_PARSING_DATA,(function(t,i){var n=[],r={event:t,data:i};i.data1&&(r.data1=i.data1.buffer,n.push(i.data1.buffer),delete i.data1),i.data2&&(r.data2=i.data2.buffer,n.push(i.data2.buffer),delete i.data2),e.postMessage(r,n)}))}},function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"newCue",(function(){return pt}));var r,a,s=i(6),o=i(2),l=i(3),d=i(1),u=i(0),c={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(c[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){u.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(a||(a={}));var f=i(10);function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m,g=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,i;return t=e,(i=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(t.prototype,i),e}();function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(m||(m={}));var y=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[m.AUDIO]=!1,e[m.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,i,n=e.prototype;return n.setByteRange=function(e,t){var i=e.split("@",2),n=[];1===i.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(i[1]),n[1]=parseInt(i[0])+n[0],this._byteRange=n},n.addElementaryStream=function(e){this._elementaryStreams[e]=!0},n.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},n.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new g(e.baseuri,e.reluri)).method=e.method,i.iv=this.createInitializationVector(t)),i},t=e,(i=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&u.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(l.a)(this.programDateTime))return null;var e=Object(l.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&v(t.prototype,i),e}();function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,i;return t=e,(i=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(l.a)(this.fragments[0].programDateTime))}}])&&b(t.prototype,i),e}(),_=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,E=function(){function e(t){for(var i in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=_.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,i={};for(T.lastIndex=0;null!==(t=T.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i},e}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function k(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var A=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),L=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,D=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function e(){}return e.findGroup=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}},e.convertAVC1ToAVCOTI=function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var n,r=[];function a(e,t){["video","audio"].forEach((function(i){var n=e.filter((function(e){return function(e,t){var i=S[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)}));if(n.length){var r=n.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=r.length>0?r[0]:n[0],e=e.filter((function(e){return-1===n.indexOf(e)}))}})),t.unknownCodecs=e}for(A.lastIndex=0;null!=(n=A.exec(t));){var s={},o=s.attrs=new E(n[1]);s.url=e.resolve(n[2],i);var l=o.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),s.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),s.name=o.NAME,a([].concat((o.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=e.convertAVC1ToAVCOTI(s.videoCodec)),r.push(s)}return r},e.parseMasterPlaylistMedia=function(t,i,n,r){var a;void 0===r&&(r=[]);var s=[],o=0;for(C.lastIndex=0;null!==(a=C.exec(t));){var l=new E(a[1]);if(l.TYPE===n){var d={id:o++,groupId:l["GROUP-ID"],name:l.NAME||l.LANGUAGE,type:n,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(d.url=e.resolve(l.URI,i)),r.length){var u=e.findGroup(r,d.groupId);d.audioCodec=u?u.codec:r[0].codec}s.push(d)}}return s},e.parseLevelPlaylist=function(e,t,i,n,r){var a,s,o,d=0,c=0,h=new w(t),f=0,p=null,m=new y,v=null;for(R.lastIndex=0;null!==(a=R.exec(e));){var b=a[1];if(b){m.duration=parseFloat(b);var _=(" "+a[2]).slice(1);m.title=_||null,m.tagList.push(_?["INF",b,_]:["INF",b])}else if(a[3]){if(Object(l.a)(m.duration)){var T=d++;m.type=n,m.start=c,o&&(m.levelkey=o),m.sn=T,m.level=i,m.cc=f,m.urlId=r,m.baseurl=t,m.relurl=(" "+a[3]).slice(1),O(m,p),h.fragments.push(m),p=m,c+=m.duration,m=new y}}else if(a[4]){var S=(" "+a[4]).slice(1);p?m.setByteRange(S,p):m.setByteRange(S)}else if(a[5])m.rawProgramDateTime=(" "+a[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),null===v&&(v=h.fragments.length);else{if(!(a=a[0].match(L))){u.b.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&void 0===a[s];s++);var k=(" "+a[s+1]).slice(1),A=(" "+a[s+2]).slice(1);switch(a[s]){case"#":m.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":h.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":d=h.startSN=parseInt(k);break;case"TARGETDURATION":h.targetduration=parseFloat(k);break;case"VERSION":h.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":var C=new E(k),x=C.enumeratedString("METHOD"),P=C.URI,I=C.hexadecimalInteger("IV");x&&(o=new g(t,P),P&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(x)>=0&&(o.method=x,o.key=null,o.iv=I));break;case"START":var M=new E(k).decimalFloatingPoint("TIME-OFFSET");Object(l.a)(M)&&(h.startTimeOffset=M);break;case"MAP":var N=new E(k);m.relurl=N.URI,N.BYTERANGE&&m.setByteRange(N.BYTERANGE),m.baseurl=t,m.level=i,m.type=n,m.sn="initSegment",h.initSegment=m,(m=new y).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:u.b.warn("line parsed but not handled: "+a)}}}return(m=p)&&!m.relurl&&(h.fragments.pop(),c-=m.duration),h.totalduration=c,h.averagetargetduration=c/h.fragments.length,h.endSN=d-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(e){return D.test(e.relurl)}))&&(u.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(m=new y).relurl=h.fragments[0].relurl,m.baseurl=t,m.level=i,m.type=n,m.sn="initSegment",h.initSegment=m,h.needSidxRanges=!0),v&&function(e,t){for(var i=e[t],n=t-1;n>=0;n--){var r=e[n];r.programDateTime=i.programDateTime-1e3*r.duration,i=r}}(h.fragments,v),h},e}();function O(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(l.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var P=window.performance,I=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADING,d.a.LEVEL_LOADING,d.a.AUDIO_TRACK_LOADING,d.a.SUBTITLE_TRACK_LOADING)||this).loaders={},i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.canHaveQualityLevels=function(e){return e!==r.AUDIO_TRACK&&e!==r.SUBTITLE_TRACK},n.mapContextToLevelType=function(e){switch(e.type){case r.AUDIO_TRACK:return a.AUDIO;case r.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},n.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i};var s=n.prototype;return s.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,n=t.loader,r=new(i||n)(t);return e.loader=r,this.loaders[e.type]=r,r},s.getInternalLoader=function(e){return this.loaders[e.type]},s.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},s.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},s.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},s.onManifestLoading=function(e){this.load({url:e.url,type:r.MANIFEST,level:0,id:null,responseType:"text"})},s.onLevelLoading=function(e){this.load({url:e.url,type:r.LEVEL,level:e.level,id:e.id,responseType:"text"})},s.onAudioTrackLoading=function(e){this.load({url:e.url,type:r.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},s.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:r.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},s.load=function(e){var t=this.hls.config;u.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var i,n,a,s,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url)return u.b.trace("playlist request ongoing"),!1;u.b.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case r.MANIFEST:i=t.manifestLoadingMaxRetry,n=t.manifestLoadingTimeOut,a=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case r.LEVEL:i=0,s=0,a=0,n=t.levelLoadingTimeOut;break;default:i=t.levelLoadingMaxRetry,n=t.levelLoadingTimeOut,a=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var d={timeout:n,maxRetry:i,retryDelay:a,maxRetryDelay:s},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return u.b.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,d,c),!0},s.loadsuccess=function(e,t,i,n){if(void 0===n&&(n=null),i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,n);if(this.resetInternalLoader(i.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var r=e.data;t.tload=P.now(),0===r.indexOf("#EXTM3U")?r.indexOf("#EXTINF:")>0||r.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,i,n):this._handleMasterPlaylist(e,t,i,n):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",n)},s.loaderror=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!1,e)},s.loadtimeout=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!0)},s._handleMasterPlaylist=function(e,t,i,r){var a=this.hls,s=e.data,o=n.getResponseUrl(e,i),l=x.parseMasterPlaylist(s,o);if(l.length){var c=l.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),h=x.parseMasterPlaylistMedia(s,o,"AUDIO",c),f=x.parseMasterPlaylistMedia(s,o,"SUBTITLES");if(h.length){var p=!1;h.forEach((function(e){e.url||(p=!0)})),!1===p&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(u.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1}))}a.trigger(d.a.MANIFEST_LOADED,{levels:l,audioTracks:h,subtitles:f,url:o,stats:t,networkDetails:r})}else this._handleManifestParsingError(e,i,"no level found in manifest",r)},s._handleTrackOrLevelPlaylist=function(e,t,i,a){var s=this.hls,o=i.id,u=i.level,c=i.type,h=n.getResponseUrl(e,i),f=Object(l.a)(o)?o:0,p=Object(l.a)(u)?u:f,m=n.mapContextToLevelType(i),g=x.parseLevelPlaylist(e.data,h,p,m,f);if(g.tload=t.tload,c===r.MANIFEST){var v={url:h,details:g};s.trigger(d.a.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:h,stats:t,networkDetails:a})}if(t.tparsed=P.now(),g.needSidxRanges){var y=g.initSegment.url;this.load({url:y,isSidxRequest:!0,type:c,level:u,levelDetails:g,id:o,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=g,this._handlePlaylistLoaded(e,t,i,a)},s._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var i=f.a.parseSegmentIndex(new Uint8Array(e.data));if(i){var n=i.references,r=t.levelDetails;n.forEach((function(e,t){var i=e.info;if(r){var n=r.fragments[t];0===n.byteRange.length&&n.setByteRange(String(1+i.end-i.start)+"@"+String(i.start))}})),r&&r.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}},s._handleManifestParsingError=function(e,t,i,n){this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:n})},s._handleNetworkError=function(e,t,i,n){var a,s;void 0===i&&(i=!1),void 0===n&&(n=null),u.b.info("A network error occured while loading a "+e.type+"-type playlist");var l=this.getInternalLoader(e);switch(e.type){case r.MANIFEST:a=i?o.a.MANIFEST_LOAD_TIMEOUT:o.a.MANIFEST_LOAD_ERROR,s=!0;break;case r.LEVEL:a=i?o.a.LEVEL_LOAD_TIMEOUT:o.a.LEVEL_LOAD_ERROR,s=!1;break;case r.AUDIO_TRACK:a=i?o.a.AUDIO_TRACK_LOAD_TIMEOUT:o.a.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}l&&(l.abort(),this.resetInternalLoader(e.type));var c={type:o.b.NETWORK_ERROR,details:a,fatal:s,url:e.url,loader:l,context:e,networkDetails:t};n&&(c.response=n),this.hls.trigger(d.a.ERROR,c)},s._handlePlaylistLoaded=function(e,t,i,a){var s=i.type,o=i.level,l=i.id,u=i.levelDetails;if(u&&u.targetduration)if(n.canHaveQualityLevels(i.type))this.hls.trigger(d.a.LEVEL_LOADED,{details:u,level:o||0,id:l||0,stats:t,networkDetails:a});else switch(s){case r.AUDIO_TRACK:this.hls.trigger(d.a.AUDIO_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a});break;case r.SUBTITLE_TRACK:this.hls.trigger(d.a.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"invalid target duration",a)},n}(h),M=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.FRAG_LOADING)||this).loaders={},i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){var t=this.loaders;for(var i in t){var n=t[i];n&&n.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onFragLoading=function(e){var t=e.frag,i=t.type,n=this.loaders,r=this.hls.config,a=r.fLoader,s=r.loader;t.loaded=0;var o,d,c,h=n[i];h&&(u.b.warn("abort previous fragment loader for type: "+i),h.abort()),h=n[i]=t.loader=r.fLoader?new a(r):new s(r),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(l.a)(f)&&Object(l.a)(p)&&(o.rangeStart=f,o.rangeEnd=p),d={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(o,d,c)},r.loadsuccess=function(e,t,i,n){void 0===n&&(n=null);var r=e.data,a=i.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(d.a.FRAG_LOADED,{payload:r,frag:a,stats:t,networkDetails:n})},r.loaderror=function(e,t,i){void 0===i&&(i=null);var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[n.type]=void 0,this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},r.loadtimeout=function(e,t,i){void 0===i&&(i=null);var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[n.type]=void 0,this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},r.loadprogress=function(e,t,i,n){void 0===n&&(n=null);var r=t.frag;r.loaded=e.loaded,this.hls.trigger(d.a.FRAG_LOAD_PROGRESS,{frag:r,stats:e,networkDetails:n})},n}(h),N=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.KEY_LOADING)||this).loaders={},i.decryptkey=null,i.decrypturl=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onKeyLoading=function(e){var t=e.frag,i=t.type,n=this.loaders[i];if(t.decryptdata){var r=t.decryptdata.uri;if(r!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(n&&(u.b.warn("abort previous key loader for type:"+i),n.abort()),!r)return void u.b.warn("key uri is falsy");t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=r,this.decryptkey=null;var s={url:r,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(d.a.KEY_LOADED,{frag:t}))}else u.b.warn("Missing decryption data on fragment in onKeyLoading")},r.loadsuccess=function(e,t,i){var n=i.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(d.a.KEY_LOADED,{frag:n})):u.b.error("after key load, decryptdata unset")},r.loaderror=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},r.loadtimeout=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},n}(h),F="NOT_LOADED",U="APPENDING",B="PARTIAL",j=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.BUFFER_APPENDED,d.a.FRAG_BUFFERED,d.a.FRAG_LOADED)||this).bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=t.config,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},r.getBufferedFrag=function(e,t){var i=this.fragments,n=Object.keys(i).filter((function(n){var r=i[n];if(r.body.type!==t)return!1;if(!r.buffered)return!1;var a=r.body;return a.startPTS<=e&&e<=a.endPTS}));if(0===n.length)return null;var r=n.pop();return i[r].body},r.detectEvictedFragments=function(e,t){var i,n,r=this;Object.keys(this.fragments).forEach((function(a){var s=r.fragments[a];if(!0===s.buffered){var o=s.range[e];if(o){i=o.time;for(var l=0;l<i.length;l++)if(n=i[l],!1===r.isTimeBuffered(n.startPTS,n.endPTS,t)){r.removeFragment(s.body);break}}}}))},r.detectPartialFragments=function(e){var t=this,i=this.getFragmentKey(e),n=this.fragments[i];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(i){if(e.hasElementaryStream(i)){var r=t.timeRanges[i];n.range[i]=t.getBufferedTimes(e.startPTS,e.endPTS,r)}})))},r.getBufferedTimes=function(e,t,i){for(var n,r,a=[],s=!1,o=0;o<i.length;o++){if(n=i.start(o)-this.bufferPadding,r=i.end(o)+this.bufferPadding,e>=n&&t<=r){a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))});break}if(e<r&&t>n)a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))}),s=!0;else if(t<=n)break}return{time:a,partial:s}},r.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},r.getPartialFragment=function(e){var t,i,n,r=this,a=null,s=0;return Object.keys(this.fragments).forEach((function(o){var l=r.fragments[o];r.isPartial(l)&&(i=l.body.startPTS-r.bufferPadding,n=l.body.endPTS+r.bufferPadding,e>=i&&e<=n&&(t=Math.min(e-i,n-e),s<=t&&(a=l.body,s=t)))})),a},r.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],n=F;return void 0!==i&&(n=i.buffered?!0===this.isPartial(i)?B:"OK":U),n},r.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},r.isTimeBuffered=function(e,t,i){for(var n,r,a=0;a<i.length;a++){if(n=i.start(a)-this.bufferPadding,r=i.end(a)+this.bufferPadding,e>=n&&t<=r)return!0;if(t<=n)return!1}return!1},r.onFragLoaded=function(e){var t=e.frag;Object(l.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},r.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var i=t.timeRanges[e];t.detectEvictedFragments(e,i)}))},r.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},r.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},r.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},r.removeAllFragments=function(){this.fragments=Object.create(null)},n}(h),$=function(e,t){for(var i=0,n=e.length-1,r=null,a=null;i<=n;){var s=t(a=e[r=(i+n)/2|0]);if(s>0)i=r+1;else{if(!(s<0))return a;n=r-1}}return null},H=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var i=e.buffered,n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,i){try{if(e){var n,r=e.buffered,a=[];for(n=0;n<r.length;n++)a.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(a,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,i){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=[];if(i)for(var r=0;r<e.length;r++){var a=n.length;if(a){var s=n[a-1].end;e[r].start-s<i?e[r].end>s&&(n[a-1].end=e[r].end):n.push(e[r])}else n.push(e[r])}else n=e;for(var o,l=0,d=t,u=t,c=0;c<n.length;c++){var h=n[c].start,f=n[c].end;if(t+i>=h&&t<f)d=h,l=(u=f)-t;else if(t+i<h){o=h;break}}return{len:l,start:d,end:u,nextStart:o}},e}(),G=i(8),q=i(11),K=i(9);function W(){return window.MediaSource||window.WebKitMediaSource}var V=i(5),Y=function(e){var t,i;function n(){return e.apply(this,arguments)||this}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.prototype.trigger=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.emit.apply(this,[e,e].concat(i))},n}(G.EventEmitter),z=Object(V.a)(),X=W()||{isTypeSupported:function(){return!1}},Q=function(){function e(e,t){var i=this;this.hls=e,this.id=t;var n=this.observer=new Y,r=e.config,a=function(t,n){(n=n||{}).frag=i.frag,n.id=i.id,e.trigger(t,n)};n.on(d.a.FRAG_DECRYPTED,a),n.on(d.a.FRAG_PARSING_INIT_SEGMENT,a),n.on(d.a.FRAG_PARSING_DATA,a),n.on(d.a.FRAG_PARSED,a),n.on(d.a.ERROR,a),n.on(d.a.FRAG_PARSING_METADATA,a),n.on(d.a.FRAG_PARSING_USERDATA,a),n.on(d.a.INIT_PTS_FOUND,a);var s={mp4:X.isTypeSupported("video/mp4"),mpeg:X.isTypeSupported("audio/mpeg"),mp3:X.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(r.enableWorker&&"undefined"!=typeof Worker){var c;u.b.log("demuxing in webworker");try{c=this.w=q(12),this.onwmsg=this.onWorkerMessage.bind(this),c.addEventListener("message",this.onwmsg),c.onerror=function(t){e.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},c.postMessage({cmd:"init",typeSupported:s,vendor:l,id:t,config:JSON.stringify(r)})}catch(e){u.b.warn("Error in worker:",e),u.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),c&&z.URL.revokeObjectURL(c.objectURL),this.demuxer=new K.a(n,s,r,l),this.w=void 0}}else this.demuxer=new K.a(n,s,r,l)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.push=function(e,t,i,n,r,a,s,o){var d=this.w,c=Object(l.a)(r.startPTS)?r.startPTS:r.start,h=r.decryptdata,f=this.frag,p=!(f&&r.cc===f.cc),m=!(f&&r.level===f.level),g=f&&r.sn===f.sn+1,v=!m&&g;if(p&&u.b.log(this.id+":discontinuity detected"),m&&u.b.log(this.id+":switch detected"),this.frag=r,d)d.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:i,videoCodec:n,timeOffset:c,discontinuity:p,trackSwitch:m,contiguous:v,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,h,t,i,n,c,p,m,v,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":z.URL.revokeObjectURL(this.w.objectURL);break;case d.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},e}();function J(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function Z(e,t,i){var n=e[t],r=e[i],a=r.startPTS;Object(l.a)(a)?i>t?(n.duration=a-n.start,n.duration<0&&u.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-a,r.duration<0&&u.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):r.start=i>t?n.start+n.duration:Math.max(n.start-r.duration,0)}function ee(e,t,i,n,r,a){var s=i;if(Object(l.a)(t.startPTS)){var o=Math.abs(t.startPTS-i);Object(l.a)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),n=Math.max(n,t.endPTS),r=Math.min(r,t.startDTS),a=Math.max(a,t.endDTS)}var d=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=n,t.startDTS=r,t.endDTS=a,t.duration=n-i;var u,c,h,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;for(u=f-e.startSN,(c=e.fragments)[u]=t,h=u;h>0;h--)Z(c,h,h-1);for(h=u;h<c.length-1;h++)Z(c,h,h+1);return e.PTSKnown=!0,d}function te(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var i,n=0;if(ie(e,t,(function(e,r){n=e.cc-r.cc,Object(l.a)(e.startPTS)&&(r.start=r.startPTS=e.startPTS,r.endPTS=e.endPTS,r.duration=e.duration,r.backtracked=e.backtracked,r.dropped=e.dropped,i=r),t.PTSKnown=!0})),t.PTSKnown){if(n){u.b.log("discontinuity sliding from playlist, take drift into account");for(var r=t.fragments,a=0;a<r.length;a++)r[a].cc+=n}i?ee(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):function(e,t){var i=t.startSN-e.startSN,n=e.fragments,r=t.fragments;if(!(i<0||i>n.length))for(var a=0;a<r.length;a++)r[a].start+=n[i].start}(e,t),t.PTSKnown=e.PTSKnown}}function ie(e,t,i){if(e&&t)for(var n=Math.max(e.startSN,t.startSN)-t.startSN,r=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=n;s<=r;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;i(o,l,s)}}function ne(e,t,i){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),r=n/2;return e&&t.endSN===e.endSN&&(n=r),i&&(n=Math.max(r,n-(window.performance.now()-i))),Math.round(n)}var re=function(e){for(var t="",i=e.length,n=0;n<i;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t};function ae(e,t){t.fragments.forEach((function(t){if(t){var i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}})),t.PTSKnown=!0}function se(e,t,i){!function(e,t,i){if(function(e,t,i){var n=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(n=!0),n}(e,i,t)){var n=function(e,t){var i=e.fragments,n=t.fragments;if(n.length&&i.length){var r=function(e,t){for(var i=null,n=0;n<e.length;n+=1){var r=e[n];if(r&&r.cc===t){i=r;break}}return i}(i,n[0].cc);if(r&&(!r||r.startPTS))return r;u.b.log("No frag in previous level to align on")}else u.b.log("No fragments to align")}(i.details,t);n&&(u.b.log("Adjusting PTS using last level due to CC increase within current level"),ae(n.start,t))}}(e,i,t),!i.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var i=t.fragments[0].programDateTime,n=(e.fragments[0].programDateTime-i)/1e3+t.fragments[0].start;Object(l.a)(n)&&(u.b.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),ae(n,e))}}(i,t.details)}function oe(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!Object(l.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(var n=0;n<e.length;++n){var r=e[n];if(ue(t,i,r))return r}return null}function le(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var r=e?t[e.sn-t[0].sn+1]:null;return r&&!de(i,n,r)?r:$(t,de.bind(null,i,n))}function de(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0);var n=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-n<=e?1:i.start-n>e&&i.start?-1:0}function ue(e,t,i){var n=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-n>e}var ce=function(){function e(e,t,i,n){this.config=e,this.media=t,this.fragmentTracker=i,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,i=this.media,n=this.stalled,r=i.currentTime,a=i.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,r===e){if((o||s)&&(this.stalled=null),!i.paused&&!i.ended&&0!==i.playbackRate&&i.buffered.length){var l=H.bufferInfo(i,r,0),d=l.len>0,c=l.nextStart||0;if(d||c){if(a){if(l.len>2||!c||c-r>2)return;this.moved=!1}if(!this.moved&&this.stalled){var h=Math.max(c,l.start||0)-r;if(h>0&&h<=2)return void this._trySkipBufferHole(null)}var f=self.performance.now();if(null!==n){var p=f-n;!a&&p>=250&&this._reportStall(l.len);var m=H.bufferInfo(i,r,t.maxBufferHole);this._tryFixBufferStall(m,p)}else this.stalled=f}}}else if(this.moved=!0,null!==n){if(this.stallReported){var g=self.performance.now()-n;u.b.warn("playback not stuck anymore @"+r+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var i=this.config,n=this.fragmentTracker,r=this.media.currentTime,a=n.getPartialFragment(r);a&&this._trySkipBufferHole(a)||e.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(u.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,u.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,i=this.hls,n=this.media,r=n.currentTime,a=0,s=0;s<n.buffered.length;s++){var l=n.buffered.start(s);if(r+t.maxBufferHole>=a&&r<l){var c=Math.max(l+.05,n.currentTime+.1);return u.b.warn("skipping hole, adjusting currentTime from "+r+" to "+c),this.moved=!0,this.stalled=null,n.currentTime=c,e&&i.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+r+" to "+c,frag:e}),c}a=n.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,n=i.currentTime,r=(this.nudgeRetry||0)+1;if(this.nudgeRetry=r,r<e.nudgeMaxRetry){var a=n+r*e.nudgeOffset;u.b.warn("Nudging 'currentTime' from "+n+" to "+a),i.currentTime=a,t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else u.b.error("Playhead still not moving while enough data buffered @"+n+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!0})},e}();var he=function(e){var t,i;function n(t){for(var i,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(i=e.call.apply(e,[this,t].concat(r))||this)._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},r.hasInterval=function(){return!!this._tickInterval},r.hasNextTick=function(){return!!this._tickTimer},r.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},r.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},r.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},r.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},r.doTick=function(){},n}(h),fe="STOPPED",pe="STARTING",me="IDLE",ge="PAUSED",ve="KEY_LOADING",ye="FRAG_LOADING",be="FRAG_LOADING_WAITING_RETRY",we="WAITING_TRACK",_e="PARSING",Te="PARSED",Ee="BUFFER_FLUSHING",Se="ENDED",ke="ERROR",Ae="WAITING_INIT_PTS",Ce="WAITING_LEVEL",Re=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.doTick=function(){},r.startLoad=function(){},r.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=fe},r._streamEnded=function(e,t){var i=this.fragCurrent,n=this.fragmentTracker;if(!t.live&&i&&!i.backtracked&&i.sn===t.endSN&&!e.nextStart){var r=n.getState(i);return r===B||"OK"===r}return!1},r.onMediaSeeking=function(){var e=this.config,t=this.media,i=this.mediaBuffer,n=this.state,r=t?t.currentTime:null,a=H.bufferInfo(i||t,r,this.config.maxBufferHole);if(Object(l.a)(r)&&u.b.log("media seeking to "+r.toFixed(3)),n===ye){var s=this.fragCurrent;if(0===a.len&&s){var o=e.maxFragLookUpTolerance,d=s.start-o,c=s.start+s.duration+o;r<d||r>c?(s.loader&&(u.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=me):u.b.log("seeking outside of buffer but within currently loaded fragment range")}}else n===Se&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=me);t&&(this.lastCurrentTime=r),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=r),this.tick()},r.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},r.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},r.onHandlerDestroyed=function(){this.state=fe,this.fragmentTracker=null},r.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},n}(he);function Le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var De=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.MANIFEST_LOADING,d.a.MANIFEST_PARSED,d.a.LEVEL_LOADED,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.FRAG_LOAD_EMERGENCY_ABORTED,d.a.FRAG_PARSING_INIT_SEGMENT,d.a.FRAG_PARSING_DATA,d.a.FRAG_PARSED,d.a.ERROR,d.a.AUDIO_TRACK_SWITCHING,d.a.AUDIO_TRACK_SWITCHED,d.a.BUFFER_CREATED,d.a.BUFFER_APPENDED,d.a.BUFFER_FLUSHED)||this).fragmentTracker=i,n.config=t.config,n.audioCodecSwap=!1,n._state=fe,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,s,c=n.prototype;return c.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(u.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=me,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=fe},c.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},c.doTick=function(){switch(this.state){case Ee:this.fragLoadError=0;break;case me:this._doTickIdle();break;case Ce:var e=this.levels[this.level];e&&e.details&&(this.state=me);break;case be:var t=window.performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(u.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=me)}this._checkBuffer(),this._checkFragmentChanged()},c._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var n;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,a=this.levels[r];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=H.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,t.maxBufferHole),c=l.len;if(!(c>=s)){u.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==r)this.state=Ce;else{if(this._streamEnded(l,h)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(d.a.BUFFER_EOS,f),void(this.state=Se)}this._fetchPayloadOrEos(n,l,h)}}}}},c._fetchPayloadOrEos=function(e,t,i){var n=this.fragPrevious,r=this.level,a=i.fragments,s=a.length;if(0!==s){var o,l=a[0].start,d=a[s-1].start+a[s-1].duration,c=t.end;if(i.initSegment&&!i.initSegment.data)o=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(s<h)return void u.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(o=this._ensureFragmentAtLivePoint(i,c,l,d,n,a,s)))return}else c<l&&(o=a[0]);o||(o=this._findFragment(l,n,s,a,c,d,i)),o&&(o.encrypted?(u.b.log("Loading key for "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r),this._loadKey(o)):(u.b.log("Loading "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r+", currentTime:"+e.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(o)))}},c._ensureFragmentAtLivePoint=function(e,t,i,n,r,a,s){var o,l=this.hls.config,d=this.media,c=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-l.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);t=h,d&&!d.paused&&d.readyState&&d.duration>h&&h>d.currentTime&&(u.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),d.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>n&&d&&d.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(r)if(e.hasProgramDateTime)u.b.log("live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),o=oe(a,r.endProgramDateTime,l.maxFragLookUpTolerance);else{var f=r.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=a[f-e.startSN];r.cc===p.cc&&(o=p,u.b.log("live playlist, switching playlist, load frag with next SN: "+o.sn))}o||(o=$(a,(function(e){return r.cc-e.cc})))&&u.b.log("live playlist, switching playlist, load frag with same CC: "+o.sn)}o||(o=a[Math.min(s-1,Math.round(s/2))],u.b.log("live playlist, switching playlist, unknown, load middle frag : "+o.sn))}return o},c._findFragment=function(e,t,i,n,r,a,s){var o,l=this.hls.config;if(o=r<a?le(t,n,r,r>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):n[i-1]){var d=o.sn-s.startSN,c=t&&o.level===t.level,h=n[d-1],f=n[d+1];if(t&&o.sn===t.sn)if(c&&!o.backtracked)if(o.sn<s.endSN){var p=t.deltaPTS;p&&p>l.maxBufferHole&&t.dropped&&d?(o=h,u.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=f,u.b.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(f&&f.backtracked?(u.b.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(u.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,h?(o=h).backtracked=!0:d&&(o=null)))}return o},c._loadKey=function(e){this.state=ve,this.hls.trigger(d.a.KEY_LOADING,{frag:e})},c._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(l.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===F||t===B?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(d.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new Q(this.hls,"main")),this.state=ye):t===U&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},c.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,a.MAIN)},c.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},c._checkFragmentChanged=function(){var e,t,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),H.isBuffered(i,t)?e=this.getBufferedFrag(t):H.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(d.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(d.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},c.immediateLevelSwitch=function(){if(u.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},c.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,H.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},c.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i,n;if((i=this.getBufferedFrag(e.currentTime))&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1),e.paused)t=0;else{var r=this.hls.nextLoadLevel,a=this.levels[r],s=this.fragLastKbps;t=s&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*s)+1:0}if((n=this.getBufferedFrag(e.currentTime+t))&&(n=this.followingBufferedFrag(n))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},c.flushMainBuffer=function(e,t){this.state=Ee;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(d.a.BUFFER_FLUSHING,i)},c.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition),this.gapController=new ce(i,t,this.fragmentTracker,this.hls)},c.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},c.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(l.a)(t)&&u.b.log("media seeked to "+t.toFixed(3)),this.tick()},c.onManifestLoading=function(){u.b.log("trigger BUFFER_RESET"),this.hls.trigger(d.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},c.onManifestParsed=function(e){var t,i=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&u.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},c.onLevelLoaded=function(e){var t=e.details,i=e.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],a=t.totalduration,s=0;if(u.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var o=r.details;o&&t.fragments.length>0?(te(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(l.a)(s)?u.b.log("live playlist sliding:"+s.toFixed(3)):(u.b.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,n,t))):(u.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,n,t))}else t.PTSKnown=!1;if(r.details=t,this.levelLastLoaded=i,this.hls.trigger(d.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var c=t.startTimeOffset;Object(l.a)(c)?(c<0&&(u.b.log("negative start time offset "+c+", count from end of last fragment"),c=s+a+c),u.b.log("start time offset found in playlist, adjust startPosition to "+c),this.startPosition=c):t.live?(this.startPosition=this.computeLivePosition(s,t),u.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Ce&&(this.state=me),this.tick()},c.onKeyLoaded=function(){this.state===ve&&(this.state=me,this.tick())},c.onFragLoaded=function(e){var t=this.fragCurrent,i=this.hls,n=this.levels,r=this.media,a=e.frag;if(this.state===ye&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=n[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,u.b.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&i.nextLoadLevel)this.state=me,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),i.trigger(d.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=me,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,i.trigger(d.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{u.b.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=_e,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var c=!(r&&r.seeking)&&(l.PTSKnown||!l.live),h=l.initSegment?l.initSegment.data:[],f=this._getAudioCodec(o);(this.demuxer=this.demuxer||new Q(this.hls,"main")).push(e.payload,h,f,o.videoCodec,t,l.totalduration,c)}}this.fragLoadError=0},c.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===_e){var n,r,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,r=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(u.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==r.container&&(s="mp4a.40.2",u.b.log("Android: force audio codec to "+s)),r.levelCodec=s,r.id=e.id}for(n in(r=a.video)&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),this.hls.trigger(d.a.BUFFER_CODECS,a),a){r=a[n],u.b.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var l=r.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.a.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},c.onFragParsingData=function(e){var t=this,i=this.fragCurrent,n=e.frag;if(i&&"main"===e.id&&n.sn===i.sn&&n.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===_e){var r=this.levels[this.level],a=i;if(Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),!0===e.hasAudio&&a.addElementaryStream(m.AUDIO),!0===e.hasVideo&&a.addElementaryStream(m.VIDEO),u.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)u.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=r.details;if(!s||a.sn!==s.startSN)return u.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=me,this.fragPrevious=a,void this.tick();u.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=ee(r.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),c=this.hls;c.trigger(d.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(i){i&&i.length&&t.state===_e&&(t.appended=!0,t.pendingBuffering=!0,c.trigger(d.a.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))})),this.tick()}},c.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===_e&&(this.stats.tparsed=window.performance.now(),this.state=Te,this._checkAppendedParsed())},c.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){u.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(u.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=me}var r=this.hls;r.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},c.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(u.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},c.onBufferCreated=function(e){var t,i,n=e.tracks,r=!1;for(var a in n){var s=n[a];"main"===s.id?(i=a,t=s,"video"===a&&(this.videoBuffer=n[a].buffer)):r=!0}r&&t?(u.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},c.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==_e&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},c._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;u.b.log("main buffered : "+re(t.buffered)),this.fragPrevious=e;var i=this.stats;i.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),this.hls.trigger(d.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.state=me}this.tick()}},c.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&H.isBuffered(this.media,this.media.currentTime)&&H.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);u.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=be}else u.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ke;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==ke&&(e.fatal?(this.state=ke,u.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Ce||(this.state=me));break;case o.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==_e&&this.state!==Te||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=me):(u.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},c._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,u.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},c._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},c.onFragLoadEmergencyAborted=function(){this.state=me,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},c.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(m.VIDEO,e.buffered),this.state=me,this.fragPrevious=null},c.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},c._seekToStartPos=function(){var e=this.media,t=e.currentTime,i=e.seeking?t:this.startPosition;t!==i&&i>=0&&(u.b.log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+t+" "),e.currentTime=i)},c._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(u.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},r=n,(s=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,u.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(d.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&Le(r.prototype,s),n}(Re);function xe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.performance;var Oe,Pe=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADED,d.a.LEVEL_LOADED,d.a.AUDIO_TRACK_SWITCHED,d.a.FRAG_LOADED,d.a.ERROR)||this).canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,Oe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},s.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},s.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},s.stopLoad=function(){this.canload=!1},s.onManifestLoaded=function(e){var t,i=[],n=[],r={},a=null,s=!1,l=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,l=l||!!e.audioCodec,Oe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=r[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,r[e.bitrate]=e,i.push(e)),t&&(t.AUDIO&&(l=!0,J(a||e,"audio",t.AUDIO)),t.SUBTITLES&&J(a||e,"text",t.SUBTITLES))})),s&&l&&(i=i.filter((function(e){return!!e.videoCodec}))),i=i.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||k(t,"audio"))&&(!i||k(i,"video"))})),e.audioTracks&&(n=e.audioTracks.filter((function(e){return!e.audioCodec||k(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),i.length>0){t=i[0].bitrate,i.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=i;for(var c=0;c<i.length;c++)if(i[c].bitrate===t){this._firstLevel=c,u.b.log("manifest loaded,"+i.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(d.a.MANIFEST_PARSED,{levels:i,audioTracks:n,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:s,altAudio:n.some((function(e){return!!e.url}))})}else this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},s.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){u.b.log("switching to level "+e),this.currentLevelIndex=e;var n=t[e];n.level=e,i.trigger(d.a.LEVEL_SWITCHING,n)}var r=t[e],a=r.details;if(!a||a.live){var s=r.urlId;i.trigger(d.a.LEVEL_LOADING,{url:r.url[s],level:e,id:s})}}else i.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},s.onError=function(e){if(e.fatal)e.type===o.b.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,n=!1;switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:t=e.frag.level,n=!0;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,i=!0;break;case o.a.REMUX_ALLOC_ERROR:t=e.level,i=!0}void 0!==t&&this.recoverLevel(e,t,i,n)}},s.recoverLevel=function(e,t,i,n){var r,a,s,o=this,l=this.hls.config,d=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=n,i){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return u.b.error("level controller, cannot recover from "+d+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),a),e.levelRetry=!0,this.levelRetryCount++,u.b.warn("level controller, "+d+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(i||n)&&((r=c.url.length)>1&&c.loadError<r?(c.urlId=(c.urlId+1)%r,c.details=void 0,u.b.warn("level controller, "+d+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,u.b.warn("level controller, "+d+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):n&&(u.b.warn("level controller, "+d+": reload a fragment"),this.currentLevelIndex=null))},s.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},s.onLevelLoaded=function(e){var t=this,i=e.level,n=e.details;if(i===this.currentLevelIndex){var r=this._levels[i];if(r.fragmentError||(r.loadError=0,this.levelRetryCount=0),n.live){var a=ne(r.details,n,e.stats.trequest);u.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),a)}else this.clearTimer()}},s.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var n=-1,r=0;r<i.audioGroupIds.length;r++)if(i.audioGroupIds[r]===t){n=r;break}n!==i.urlId&&(i.urlId=n,this.startLoad())}},s.loadLevel=function(){if(u.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,i=e.urlId,n=e.url[i];u.b.log("Attempt loading level index "+t+" with URL-id "+i),this.hls.trigger(d.a.LEVEL_LOADING,{url:n,level:t,id:i})}}},r=n,(a=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&xe(r.prototype,a),n}(h),Ie=i(4);function Me(e,t){var i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Ne(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Fe=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.FRAG_PARSING_METADATA,d.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,i.media=void 0,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){h.prototype.destroy.call(this)},r.onMediaAttached=function(e){this.media=e.media,this.media},r.onMediaDetaching=function(){Ne(this.id3Track),this.id3Track=void 0,this.media=void 0},r.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Me(i,this.media),i}return this.media.addTextTrack("metadata","id3")},r.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var a=Ie.a.getID3Frames(i[r].data);if(a){var s=i[r].pts,o=r<i.length-1?i[r+1].pts:t.endPTS;s===o?o+=1e-4:s>o&&(u.b.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),o=s+.25);for(var l=0;l<a.length;l++){var d=a[l];if(!Ie.a.isTimeStampFrame(d)){var c=new n(s,o,"");c.value=d,this.id3Track.addCue(c)}}}}},r.onLiveBackBufferReached=function(e){var t=e.bufferEnd,i=this.id3Track;if(i&&i.cues&&i.cues.length){var n=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var i=0,n=e.length-1;i<=n;){var r=Math.floor((n+i)/2);if(t<e[r].endTime)n=r-1;else{if(!(t>e[r].endTime))return e[r];i=r+1}}return e[i].endTime-t<t-e[n].endTime?e[i]:e[n]}(i.cues,t);if(n)for(;i.cues[0]!==n;)i.removeCue(i.cues[0])}},n}(h),Ue=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Be=function(){function e(e,t,i,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ue(t),this.fast_=new Ue(i)}var t=e.prototype;return t.sample=function(e,t){var i=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/i;this.fast_.sample(i,n),this.slow_.sample(i,n)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function je(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $e=window.performance,He=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.FRAG_LOADING,d.a.FRAG_LOADED,d.a.FRAG_BUFFERED,d.a.ERROR)||this).lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=t,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},s.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var i,n,r=this.hls,a=r.config,s=t.level;r.levels[s].details.live?(i=a.abrEwmaFastLive,n=a.abrEwmaSlowLive):(i=a.abrEwmaFastVoD,n=a.abrEwmaSlowVoD),this._bwEstimator=new Be(r,n,i,a.abrEwmaDefaultEstimate)}},s._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(i){var n=i.loader,r=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return u.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var s=$e.now()-a.trequest,o=Math.abs(t.playbackRate);if(s>500*i.duration/o){var l=e.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/s),h=l[i.level],f=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*f/8)),m=t.currentTime,g=(p-a.loaded)/c,v=(H.bufferInfo(t,m,e.config.maxBufferHole).end-m)/o;if(v<2*i.duration/o&&g>v){var y;for(y=i.level-1;y>r;y--){var b=l[y].realBitrate?Math.max(l[y].realBitrate,l[y].bitrate):l[y].bitrate;if(i.duration*b/(6.4*c)<v)break}void 0<g&&(u.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=y,this._bwEstimator.sample(s,a.loaded),n.abort(),this.clearTimer(),e.trigger(d.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a}))}}}}},s.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(l.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],n=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,r=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},s.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!0!==t.aborted&&"main"===i.type&&Object(l.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;u.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},s.onError=function(e){switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},s.clearTimer=function(){clearInterval(this.timer),this.timer=null},s._findBestLevel=function(e,t,i,n,r,a,s,o,l){for(var d=r;d>=n;d--){var c=l[d];if(c){var h,f=c.details,p=f?f.totalduration/f.fragments.length:t,m=!!f&&f.live;h=d<=e?s*i:o*i;var g=l[d].realBitrate?Math.max(l[d].realBitrate,l[d].bitrate):l[d].bitrate,v=g*p/h;if(u.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(h)+"/"+g+"/"+p+"/"+a+"/"+v),h>g&&(!v||m&&!this.bitrateTestDelay||v<a))return d}}return-1},r=n,(a=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,n=e.config,r=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(H.bufferInfo(a,l,n.maxBufferHole).end-l)/d,f=this._findBestLevel(s,o,c,r,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(f>=0)return f;u.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,m=n.abrBandWidthFactor,g=n.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;v&&(p=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-v,u.b.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),m=g=1)}return f=this._findBestLevel(s,o,c,r,t,h+p,m,g,i),Math.max(f,0)}}])&&je(r.prototype,a),n}(h),Ge=W(),qe=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHING,d.a.MEDIA_DETACHING,d.a.MANIFEST_PARSED,d.a.BUFFER_RESET,d.a.BUFFER_APPENDING,d.a.BUFFER_CODECS,d.a.BUFFER_EOS,d.a.BUFFER_FLUSHING,d.a.LEVEL_PTS_UPDATED,d.a.LEVEL_UPDATED)||this)._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i._needsFlush=!1,i._needsEos=!1,i.config=void 0,i.audioTimestampOffset=void 0,i.bufferCodecEventsExpected=0,i._bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.segments=[],i.parent=void 0,i.appending=!1,i.appended=0,i.appendError=0,i.flushBufferCounter=0,i.tracks={},i.pendingTracks={},i.sourceBuffer={},i.flushRange=[],i._onMediaSourceOpen=function(){u.b.log("media source opened"),i.hls.trigger(d.a.MEDIA_ATTACHED,{media:i.media});var e=i.mediaSource;e&&e.removeEventListener("sourceopen",i._onMediaSourceOpen),i.checkPendingTracks()},i._onMediaSourceClose=function(){u.b.log("media source closed")},i._onMediaSourceEnded=function(){u.b.log("media source ended")},i._onSBUpdateEnd=function(){if(i.audioTimestampOffset&&i.sourceBuffer.audio){var e=i.sourceBuffer.audio;u.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+i.audioTimestampOffset),e.timestampOffset=i.audioTimestampOffset,delete i.audioTimestampOffset}i._needsFlush&&i.doFlush(),i._needsEos&&i.checkEos(),i.appending=!1;var t=i.parent,n=i.segments.reduce((function(e,i){return i.parent===t?e+1:e}),0),r={},a=i.sourceBuffer;for(var s in a){var o=a[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");r[s]=o.buffered}i.hls.trigger(d.a.BUFFER_APPENDED,{parent:t,pending:n,timeRanges:r}),i._needsFlush||i.doAppending(),i.updateMediaElementDuration(),0===n&&i.flushLiveBackBuffer()},i._onSBUpdateError=function(e){u.b.error("sourceBuffer error:",e),i.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},i.config=t.config,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){h.prototype.destroy.call(this)},r.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(!n)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(n.timestampOffset-e.start)>.1){var r=n.updating;try{n.abort()}catch(e){u.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(u.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},r.onManifestParsed=function(e){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e.altAudio?2:1,u.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&Ge){var i=this.mediaSource=new Ge;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(i),this._objectUrl=t.src}},r.onMediaDetaching=function(){u.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){u.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(d.a.MEDIA_DETACHED)},r.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,i=Object.keys(t).length;(i&&!e||2===i)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{i&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this._onSBUpdateEnd),i.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(i){t.pendingTracks[i]=e[i]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},r.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(var n in e)if(!t[n]){var r=e[n];if(!r)throw Error("source buffer exists for track "+n+", however track does not");var a=r.levelCodec||r.codec,s=r.container+";codecs="+a;u.b.log("creating sourceBuffer("+s+")");try{var l=t[n]=i.addSourceBuffer(s);l.addEventListener("updateend",this._onSBUpdateEnd),l.addEventListener("error",this._onSBUpdateError),this.tracks[n]={buffer:l,codec:a,id:r.id,container:r.container,levelCodec:r.levelCodec}}catch(e){u.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(d.a.BUFFER_CREATED,{tracks:this.tracks})},r.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var i=this.sourceBuffer[t];i&&!i.ended&&(i.ended=!0,u.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},r.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var n=e[i];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}u.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){u.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},r.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,i=this.sourceBuffer,n=Object.keys(i),r=t-Math.max(e,this._levelTargetDuration),a=n.length-1;a>=0;a--){var s=n[a],o=i[s];if(o){var l=o.buffered;l.length>0&&r>l.start(0)&&this.removeBufferRange(s,o,0,r)&&this.hls.trigger(d.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r})}}else u.b.error("flushLiveBackBuffer called without attaching media")}},r.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer){var n=this.sourceBuffer[i];if(n&&!0===n.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(u.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(l.a)(e))&&(u.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var n in i){var r=i[n];r&&(t+=r.buffered.length)}}catch(e){u.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(d.a.BUFFER_FLUSHED)}},r.doAppending=function(){var e=this.config,t=this.hls,i=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void u.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var r=i.shift();if(r)try{var a=n[r.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void i.unshift(r);a.ended=!1,this.parent=r.parent,a.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0}catch(n){u.b.error("error while trying to append buffer:"+n.message),i.unshift(r);var s={type:o.b.MEDIA_ERROR,parent:r.parent,details:"",fatal:!1};22===n.code?(this.segments=[],s.details=o.a.BUFFER_FULL_ERROR):(this.appendError++,s.details=o.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(u.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(d.a.ERROR,s)}}}},r.flushBuffer=function(e,t,i){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var r="null";if(this.media&&(r=this.media.currentTime.toFixed(3)),u.b.log("flushBuffer,pos/start/end: "+r+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return u.b.warn("abort flushing too many retries"),!0;var a=n[i];if(a){if(a.ended=!1,a.updating)return u.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(i,a,e,t))return this.flushBufferCounter++,!1}return u.b.log("buffer flushed"),!0},r.removeBufferRange=function(e,t,i,n){try{for(var r=0;r<t.buffered.length;r++){var a=t.buffered.start(r),s=t.buffered.end(r),o=Math.max(a,i),l=Math.min(s,n);if(Math.min(l,s)-o>.5){var d="null";return this.media&&(d=this.media.currentTime.toString()),u.b.log("sb remove "+e+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+d),t.remove(o,l),!0}}}catch(e){u.b.warn("removeBufferRange failed",e)}return!1},n}(h);function Ke(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var We=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.FPS_DROP_LEVEL_CAPPING,d.a.MEDIA_ATTACHING,d.a.MANIFEST_PARSED,d.a.BUFFER_CODECS,d.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s,o=n.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter((function(i,r){return n.isLevelAllowed(r,t.restrictedLevels)&&r<=e}));return n.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var n,r,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=i)&&(n=o,!(r=e[s+1])||n.width!==r.width||n.height!==r.height)){a=s;break}}return a},r=n,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:"mediaWidth",get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=n.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=n.contentScaleFactor),e}}])&&Ke(r.prototype,a),s&&Ke(r,s),n}(h),Ve=window.performance,Ye=function(e){var t,i;function n(t){return e.call(this,t,d.a.MEDIA_ATTACHING)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},r.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},r.checkFPS=function(e,t,i){var n=Ve.now();if(t){if(this.lastTime){var r=n-this.lastTime,a=i-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/r,l=this.hls;if(l.trigger(d.a.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:i}),o>0&&a>l.config.fpsDroppedMonitoringThreshold*s){var c=l.currentLevel;u.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=c)&&(c-=1,l.trigger(d.a.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,l.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},r.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},n}(h),ze=window,Xe=ze.performance,Qe=ze.XMLHttpRequest,Je=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:Xe.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new Qe;var i=this.stats;i.tfirst=0,i.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(i){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,n=this.stats,r=this.context,a=this.config;if(!n.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(Xe.now(),n.trequest)),4===i){var s=t.status;if(s>=200&&s<300){var o,l;n.tload=Math.max(n.tfirst,Xe.now()),l="arraybuffer"===r.responseType?(o=t.response).byteLength:(o=t.responseText).length,n.loaded=n.total=l;var d={url:t.responseURL,data:o};this.callbacks.onSuccess(d,n,r,t)}else n.retry>=a.maxRetry||s>=400&&s<499?(u.b.error(s+" while loading "+r.url),this.callbacks.onError({code:s,text:t.statusText},r,t)):(u.b.warn(s+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){u.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,t)},e}();function Ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var et=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADING,d.a.MANIFEST_PARSED,d.a.AUDIO_TRACK_LOADED,d.a.AUDIO_TRACK_SWITCHED,d.a.LEVEL_LOADED,d.a.ERROR)||this)._trackId=-1,i._selectDefaultTrack=!0,i.tracks=[],i.trackIdBlacklist=Object.create(null),i.audioGroupId=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},s.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(d.a.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},s.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)u.b.warn("Invalid audio track id:",e.id);else{if(u.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},s.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},s.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},s.onError=function(e){e.type===o.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===o.a.AUDIO_TRACK_LOAD_ERROR&&(u.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},s._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)u.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)u.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];u.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var i=t.url,n=t.type,r=t.id;this.hls.trigger(d.a.AUDIO_TRACK_SWITCHING,{id:r,type:n,url:i}),this._loadTrackDetailsIfNeeded(t)}},s.doTick=function(){this._updateTrack(this._trackId)},s._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var i=t.audioGroupIds[t.urlId];this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack())}},s._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var i=this.tracks[this._trackId],n=null;if(i&&(n=i.name),this._selectDefaultTrack){var r=t.filter((function(e){return e.default}));r.length?t=r:u.b.warn("No default audio tracks defined")}var a=!1,s=function(){t.forEach((function(t){a||e.audioGroupId&&t.groupId!==e.audioGroupId||n&&n!==t.name||(e._setAudioTrack(t.id),a=!0)}))};s(),a||(n=null,s()),a||(u.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},s._needsTrackLoading=function(e){var t=e.details,i=e.url;return!(t&&!t.live||!i)},s._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,i=e.id;u.b.log("loading audio-track playlist for id: "+i),this.hls.trigger(d.a.AUDIO_TRACK_LOADING,{url:t,id:i})}},s._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,u.b.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},s._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],i=t.name,n=t.language,r=t.groupId;u.b.warn("Loading failed on audio track id: "+e+", group-id: "+r+', name/language: "'+i+'" / "'+n+'"');for(var a=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===i){a=s;break}a!==e?(u.b.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):u.b.warn('No fallback audio-track found for name/language: "'+i+'" / "'+n+'"')},r=n,(a=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&Ze(r.prototype,a),n}(he);function tt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var it=window.performance,nt=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.AUDIO_TRACKS_UPDATED,d.a.AUDIO_TRACK_SWITCHING,d.a.AUDIO_TRACK_LOADED,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.FRAG_PARSING_INIT_SEGMENT,d.a.FRAG_PARSING_DATA,d.a.FRAG_PARSED,d.a.ERROR,d.a.BUFFER_RESET,d.a.BUFFER_CREATED,d.a.BUFFER_APPENDED,d.a.BUFFER_FLUSHED,d.a.INIT_PTS_FOUND)||this).fragmentTracker=i,n.config=t.config,n.audioCodecSwap=!1,n._state=fe,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[i]=n,this.videoTrackCC=i,u.b.log("InitPTS for cc: "+i+" found from video track: "+n),this.state===Ae&&this.tick())},s.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(u.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=me):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=pe),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=fe},s.doTick=function(){var e,t,i,n=this.hls,r=n.config;switch(this.state){case ke:case ge:case Ee:break;case pe:this.state=we,this.loadedmetadata=!1;break;case me:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,c=H.bufferInfo(s,e,r.maxBufferHole),h=H.bufferInfo(o,e,r.maxBufferHole),f=c.len,p=c.end,m=this.fragPrevious,g=Math.min(r.maxBufferLength,r.maxMaxBufferLength),v=Math.max(g,h.len),y=this.audioSwitch,b=this.trackId;if((f<v||y)&&b<a.length){if(void 0===(i=a[b].details)){this.state=we;break}if(!y&&this._streamEnded(c,i))return this.hls.trigger(d.a.BUFFER_EOS,{type:"audio"}),void(this.state=Se);var w,_=i.fragments,T=_.length,E=_[0].start,S=_[T-1].start+_[T-1].duration;if(y)if(i.live&&!i.PTSKnown)u.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,i.PTSKnown&&e<E){if(!(c.end>E||c.nextStart))return;u.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=E+.05}if(i.initSegment&&!i.initSegment.data)w=i.initSegment;else if(p<=E){if(w=_[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(w=function(e,t){return $(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(_,this.videoTrackCC)),i.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var k=c.nextStart?c.nextStart:E;return u.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(k+.05)),void(this.media.currentTime=k+.05)}}else{var A,C=r.maxFragLookUpTolerance,R=m?_[m.sn-_[0].sn+1]:void 0,L=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=p?1:e.start-t>p&&e.start?-1:0};p<S?(p>S-C&&(C=0),A=R&&!L(R)?R:$(_,L)):A=_[T-1],A&&(w=A,E=A.start,m&&w.level===m.level&&w.sn===m.sn&&(w.sn<i.endSN?(w=_[w.sn+1-i.startSN],u.b.log("SN just loaded, load next one: "+w.sn)):w=null))}w&&(w.encrypted?(u.b.log("Loading key for "+w.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+b),this.state=ve,n.trigger(d.a.KEY_LOADING,{frag:w})):(u.b.log("Loading "+w.sn+", cc: "+w.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+b+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),this.fragCurrent=w,(y||this.fragmentTracker.getState(w)===F)&&("initSegment"!==w.sn&&(this.startFragRequested=!0),Object(l.a)(w.sn)&&(this.nextLoadPosition=w.start+w.duration),n.trigger(d.a.FRAG_LOADING,{frag:w}),this.state=ye)))}break;case we:(t=this.tracks[this.trackId])&&t.details&&(this.state=me);break;case be:var D=it.now(),x=this.retryDate,O=(s=this.media)&&s.seeking;(!x||D>=x||O)&&(u.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=me);break;case Ae:var P=this.videoTrackCC;if(void 0===this.initPTS[P])break;var I=this.waitingFragment;if(I){var M=I.frag.cc;P!==M?(t=this.tracks[this.trackId]).details&&t.details.live&&(u.b.warn("Waiting fragment CC ("+M+") does not match video track CC ("+P+")"),this.waitingFragment=null,this.state=me):(this.state=ye,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=me}},s.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},s.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onAudioTracksUpdated=function(e){u.b.log("audio tracks updated"),this.tracks=e.audioTracks},s.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=ge,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=me),this.tick()},s.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,n=this.tracks[i],r=t.totalduration,a=0;if(u.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var s=n.details;s&&t.fragments.length>0?(te(s,t),a=t.fragments[0].start,t.PTSKnown?u.b.log("live audio playlist sliding:"+a.toFixed(3)):u.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,u.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(l.a)(o)?(u.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(a,t),u.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===we&&(this.state=me),this.tick()},s.onKeyLoaded=function(){this.state===ve&&(this.state=me,this.tick())},s.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===ye&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var n=this.tracks[this.trackId],r=n.details,a=r.totalduration,s=t.level,o=t.sn,l=t.cc,c=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===o)this.state=me,h.tparsed=h.tbuffered=it.now(),r.initSegment.data=e.payload,this.hls.trigger(d.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=_e,this.appended=!1,this.demuxer||(this.demuxer=new Q(this.hls,"audio"));var f=this.initPTS[l],p=r.initSegment?r.initSegment.data:[];r.initSegment||void 0!==f?(this.pendingBuffering=!0,u.b.log("Demuxing "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.demuxer.push(e.payload,p,c,null,t,a,!1,f)):(u.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.waitingFragment=e,this.state=Ae)}}this.fragLoadError=0},s.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===_e){var n,r=e.tracks;if(r.video&&delete r.video,n=r.audio){n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(d.a.BUFFER_CODECS,r),u.b.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var a=n.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.a.BUFFER_APPENDING,s))}this.tick()}}},s.onFragParsingData=function(e){var t=this,i=this.fragCurrent,n=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&n.sn===i.sn&&n.level===i.level&&this.state===_e){var r=this.trackId,a=this.tracks[r],s=this.hls;Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),i.addElementaryStream(m.AUDIO),u.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),ee(a.details,i,e.startPTS,e.endPTS);var c=this.audioSwitch,h=this.media,f=!1;if(c)if(h&&h.readyState){var p=h.currentTime;u.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(u.b.log("switching audio track : flushing all audio"),this.state=Ee,s.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,s.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,s.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:r});var g=this.pendingData;if(!g)return u.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})})),!f&&g.length&&(g.forEach((function(e){t.state===_e&&(t.pendingBuffering=!0,t.hls.trigger(d.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},s.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===_e&&(this.stats.tparsed=it.now(),this.state=Te,this._checkAppendedParsed())},s.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},s.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==_e&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},s._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=it.now(),i.trigger(d.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&u.b.log("audio buffered : "+re(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=me}this.tick()}},s.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n;var a=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);u.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=it.now()+a,this.state=be}else u.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ke}break;case o.a.AUDIO_TRACK_LOAD_ERROR:case o.a.AUDIO_TRACK_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:this.state!==ke&&(this.state=e.fatal?ke:me,u.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===_e||this.state===Te)){var s=this.mediaBuffer,l=this.media.currentTime;if(s&&H.isBuffered(s,l)&&H.isBuffered(s,l+.5)){var c=this.config;c.maxMaxBufferLength>=c.maxBufferLength&&(c.maxMaxBufferLength/=2,u.b.warn("AudioStreamController: reduce max buffer length to "+c.maxMaxBufferLength+"s")),this.state=me}else u.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Ee,this.hls.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},s.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(u.b.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(d.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Te):(this.state=me,this.fragPrevious=null,this.tick())},r=n,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,u.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&tt(r.prototype,a),n}(Re),rt=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function r(t,r,a){var s=this,o={enumerable:!0};s.hasBeenReset=!1;var l="",d=!1,u=t,c=r,h=a,f=null,p="",m=!0,g="auto",v="start",y=50,b="middle",w=50,_="middle";Object.defineProperty(s,"id",n({},o,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(s,"pauseOnExit",n({},o,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(s,"startTime",n({},o,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},o,{get:function(){return p},set:function(t){var i=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");p=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},o,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},o,{get:function(){return g},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},o,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},o,{get:function(){return b},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},o,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},o,{get:function(){return _},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),s.displayState=void 0}return r.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},r}(),at=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function st(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new at,this.regionList=[]}function ot(){this.values=Object.create(null)}function lt(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);2===s.length&&t(s[0],s[1])}}ot.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var dt=new rt(0,0,0),ut="middle"===dt.align?"middle":"center";function ct(e,t,i){var n=e;function r(){var t=function(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),a(),t.endTime=r(),a(),function(e,t){var n=new ot;lt(e,(function(e,t){switch(e){case"region":for(var r=i.length-1;r>=0;r--)if(i[r].id===t){n.set(e,i[r].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",ut,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",ut,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",ut,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var r=n.get("line","auto");"auto"===r&&-1===dt.line&&(r=-1),t.line=r,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",ut);var a=n.get("position","auto");"auto"===a&&50===dt.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function ht(e){return e.replace(/<br(?: \/)?>/gi,"\n")}st.prototype={parse:function(e){var t=this;function i(){var e=t.buffer,i=0;for(e=ht(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var n=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var r=(n=i()).match(/^()?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:n=i(),t.state){case"HEADER":/:/.test(n)?lt(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new rt(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{ct(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(a=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var ft=st;function pt(e,t,i,n){for(var r,a,s,o,l,d=window.VTTCue||TextTrackCue,u=0;u<n.rows.length;u++)if(s=!0,o=0,l="",!(r=n.rows[u]).isEmpty()){for(var c=0;c<r.chars.length;c++)r.chars[c].uchar.match(/\s/)&&s?o++:(l+=r.chars[c].uchar,s=!1);r.cueStartTime=t,t===i&&(i+=1e-4),a=new d(t,i,ht(l.trim())),o>=16?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=u+1:a.line=u>7?u-2:u+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),e.addCue(a)}}var mt,gt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},vt=function(e){var t=e;return gt.hasOwnProperty(e)&&(t=gt[e]),String.fromCharCode(t)},yt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},bt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},wt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},_t={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Tt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(mt||(mt={}));var Et={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e],this.verboseLevel}},St=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},kt=function(){function e(e,t,i,n,r){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=n||"black",this.flash=r||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),At=function(){function e(e,t,i,n,r,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new kt(t,i,n,r,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Ct=function(){function e(){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.chars=[];for(var e=0;e<100;e++)this.chars.push(new At);this.pos=0,this.currPenState=new kt}var t=e.prototype;return t.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(Et.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(Et.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=vt(e);this.pos>=100?Et.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var n=this.chars[i].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Rt=function(){function e(){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.rows=[];for(var e=0;e<15;e++)this.rows.push(new Ct);this.currRow=14,this.nrRollUpRows=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){Et.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){Et.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var a=r.rows[n].cueStartTime;if(a&&Et.time&&a<Et.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(r.rows[n+s])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,d=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[d].penState.foreground}var u={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(u)},t.setBkgData=function(e){Et.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){Et.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),Et.log("INFO","Rolling up")}else Et.log("DEBUG","roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],i="",n=-1,r=0;r<15;r++){var a=this.rows[r].getTextString();a&&(n=r+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},t.getTextAndFormat=function(){return this.rows},e}(),Lt=function(){function e(e,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.lastCueEndTime=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Rt,this.nonDisplayedMemory=new Rt,this.lastOutputScreen=new Rt,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,Et.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";Et.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(Et.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){Et.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){Et.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){Et.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){Et.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){Et.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){Et.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){Et.log("INFO","TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){Et.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){Et.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){Et.log("INFO","CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){Et.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(Et.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,Et.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){Et.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}Et.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=Et.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),Dt=function(){function e(e,t,i){this.field=void 0,this.outputs=void 0,this.channels=void 0,this.currChNr=void 0,this.lastCmdA=void 0,this.lastCmdB=void 0,this.lastTime=void 0,this.dataCounters=void 0,this.field=e||1,this.outputs=[t,i],this.channels=[new Lt(1,t),new Lt(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var i,n,r,a=!1;this.lastTime=e,Et.setTime(e);for(var s=0;s<t.length;s+=2)n=127&t[s],r=127&t[s+1],0!==n||0!==r?(Et.log("DATA","["+St([t[s],t[s+1]])+"] -> ("+St([n,r])+")"),(i=this.parseCmd(n,r))||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),i||(a=this.parseChars(n,r))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):Et.log("WARNING","No channel found yet. TEXT-MODE?")),i?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,Et.log("WARNING","Couldn't parse cleaned data "+St([n,r])+" orig: "+St([t[s],t[s+1]])))):this.dataCounters.padding+=2},t.parseCmd=function(e,t){var i;if(!((20===e||28===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,Et.log("DEBUG","Repeated command ("+St([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var n=this.channels[i-1];return 20===e||28===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&t>=32&&t<=47&&((i=17===e?1:2)!==this.currChNr?(Et.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),Et.log("DEBUG","MIDROW ("+St([e,t])+")"),!0))},t.parsePAC=function(e,t){var i,n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=e<=23?1:2,n=t>=64&&t<=95?1===i?yt[e]:wt[e]:1===i?bt[e]:_t[e];var r=this.interpretPAC(n,t);return this.channels[i-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.interpretPAC=function(e,t){var i,n={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},t.parseChars=function(e,t){var i=null,n=null,r=null;if(e>=25?(i=2,r=e-8):(i=1,r=e),r>=17&&r<=19){var a;a=17===r?t+80:18===r?t+112:t+144,Et.log("INFO","Special char '"+vt(a)+"' in channel "+i),n=[a]}else e>=32&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=St(n);Et.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},t.parseBackgroundAttributes=function(e,t){var i,n,r;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(i={},16===e||24===e?(n=Math.floor((t-32)/2),i.background=Tt[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),r=e<24?1:2,this.channels[r-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)},t.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}(),xt=function(){function e(e,t){this.timelineController=void 0,this.trackName=void 0,this.startTime=void 0,this.endTime=void 0,this.screen=void 0,this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},t.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)},e}(),Ot=function(e,t,i){return e.substr(i||0,t.length)===t},Pt=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()},It=function(e,t,i,n,r,a){var s,o=Object(Ie.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),d="00:00.000",u=0,c=0,h=0,f=[],p=!0,m=!1,g=new ft;g.oncue=function(e){var t=i[n],r=i.ccOffset;t&&t.new&&(void 0!==c?r=i.ccOffset=t.start:function(e,t,i){var n=e[t],r=e[n.prevCC];if(!r||!r.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;r&&r.new;)e.ccOffset+=n.start-r.start,n.new=!1,r=e[(n=r).prevCC];e.presentationOffset=i}(i,n,h)),h&&(r=h-i.presentationOffset),m&&(e.startTime+=r-c,e.endTime+=r-c),e.id=Pt(e.startTime.toString())+Pt(e.endTime.toString())+Pt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&f.push(e)},g.onparsingerror=function(e){s=e},g.onflush=function(){s&&a?a(s):r(f)},o.forEach((function(e){if(p){if(Ot(e,"X-TIMESTAMP-MAP=")){p=!1,m=!0,e.substr(16).split(",").forEach((function(e){Ot(e,"LOCAL:")?d=e.substr(6):Ot(e,"MPEGTS:")&&(u=parseInt(e.substr(7)))}));try{t+(9e4*i[n].start||0)<0&&(t+=8589934592),u-=t,c=function(e){var t=parseInt(e.substr(-3)),i=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),r=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(l.a)(t)&&Object(l.a)(i)&&Object(l.a)(n)&&Object(l.a)(r)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*i,(t+=6e4*n)+36e5*r}(d)/1e3,h=u/9e4}catch(e){m=!1,s=e}return}""===e&&(p=!1)}g.parse(e+"\n")})),g.flush()};function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nt(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ft=function(e){var t,i;function n(t){var i;if((i=e.call(this,t,d.a.MEDIA_ATTACHING,d.a.MEDIA_DETACHING,d.a.FRAG_PARSING_USERDATA,d.a.FRAG_DECRYPTED,d.a.MANIFEST_LOADING,d.a.MANIFEST_LOADED,d.a.FRAG_LOADED,d.a.INIT_PTS_FOUND)||this).media=null,i.config=void 0,i.enabled=!0,i.Cues=void 0,i.textTracks=[],i.tracks=[],i.initPTS=[],i.unparsedVttFrags=[],i.cueRanges=[],i.captionsTracks={},i.captionsProperties=void 0,i.cea608Parser=void 0,i.lastSn=-1,i.prevCC=-1,i.vttCCs=null,i.hls=t,i.config=t.config,i.Cues=t.config.cueHandler,i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode}},i.config.enableCEA708Captions){var n=new xt(Mt(i),"textTrack1"),r=new xt(Mt(i),"textTrack2");i.cea608Parser=new Dt(0,n,r)}return i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.addCues=function(e,t,i,n){for(var r,a,s,o,l=this.cueRanges,d=!1,u=l.length;u--;){var c=l[u],h=(r=c[0],a=c[1],s=t,o=i,Math.min(a,o)-Math.max(r,s));if(h>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],i),d=!0,h/(i-t)>.5))return}d||l.push([t,i]),this.Cues.newCue(this.captionsTracks[e],t,i,n)},r.onInitPtsFound=function(e){var t=this,i=e.frag,n=e.id,r=e.initPTS,a=this.unparsedVttFrags;"main"===n&&(this.initPTS[i.cc]=r),a.length&&(this.unparsedVttFrags=[],a.forEach((function(e){t.onFragLoaded(e)})))},r.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var n=t.textTracks[i];if(n[e])return n}return null},r.createCaptionsTrack=function(e){var t=this.captionsProperties,i=this.captionsTracks,n=this.media,r=t[e],a=r.label,s=r.languageCode;if(!i[e]){var o=this.getExistingTrack(e);if(o)i[e]=o,Ne(i[e]),Me(i[e],n);else{var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,i[e]=l)}}},r.createTextTrack=function(e,t,i){var n=this.media;if(n)return n.addTextTrack(e,t,i)},r.destroy=function(){e.prototype.destroy.call(this)},r.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Ne(e[t]),delete e[t]}))},r.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},r._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)Ne(t[i])}},r.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,n){var r;if(n<i.length){for(var a=null,s=0;s<i.length;s++)if(Nt(i[s],e)){a=i[s];break}a&&(r=a)}r||(r=t.createTextTrack("subtitles",e.name,e.lang)),e.default?r.mode=t.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",t.textTracks.push(r)}))}},r.onFragLoaded=function(e){var t=e.frag,i=e.payload,n=this.cea608Parser,r=this.initPTS,a=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var o=t.sn;t.sn!==a+1&&n&&n.reset(),this.lastSn=o}else if("subtitle"===t.type)if(i.byteLength){if(!Object(l.a)(r[t.cc]))return s.push(e),void(r.length&&this.hls.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var u=t.decryptdata;null!=u&&null!=u.key&&"AES-128"===u.method||this._parseVTTs(t,i)}else this.hls.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},r._parseVTTs=function(e,t){var i=this.hls,n=this.prevCC,r=this.textTracks,a=this.vttCCs;a[e.cc]||(a[e.cc]={start:e.start,prevCC:n,new:!0},this.prevCC=e.cc),It(t,this.initPTS[e.cc],a,e.cc,(function(t){var n=r[e.level];"disabled"!==n.mode?(t.forEach((function(e){if(!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(i){u.b.debug("Failed occurred on adding cues: "+i);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,n.addCue(t)}})),i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}),(function(t){u.b.log("Failed to parse VTT cue: "+t),i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},r.onFragDecrypted=function(e){var t=e.frag,i=e.payload;if("subtitle"===t.type){if(!Object(l.a)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,i)}},r.onFragParsingUserdata=function(e){if(this.enabled&&this.cea608Parser)for(var t=0;t<e.samples.length;t++){var i=e.samples[t].bytes;if(i){var n=this.extractCea608Data(i);this.cea608Parser.addData(e.samples[t].pts,n)}}},r.extractCea608Data=function(e){for(var t,i,n,r=31&e[0],a=2,s=[],o=0;o<r;o++)t=e[a++],i=127&e[a++],n=127&e[a++],0===i&&0===n||0!=(4&t)&&0==(3&t)&&(s.push(i),s.push(n));return s},n}(h);function Ut(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bt(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];"subtitles"===n.kind&&n.label&&t.push(e[i])}return t}var jt,$t=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.MANIFEST_LOADED,d.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],i.trackId=-1,i.media=null,i.stopped=!0,i.subtitleDisplay=!0,i.queuedDefaultTrack=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.destroy=function(){h.prototype.destroy.call(this)},s.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(l.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(l.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Bt(this.media.textTracks).forEach((function(e){Ne(e)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.hls.trigger(d.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},s.onSubtitleTrackLoaded=function(e){var t=this,i=e.id,n=e.details,r=this.trackId,a=this.tracks,s=a[r];if(i>=a.length||i!==r||!s||this.stopped)this._clearReloadTimer();else if(u.b.log("subtitle track "+i+" loaded"),n.live){var o=ne(s.details,n,e.stats.trequest);u.b.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),o)}else this._clearReloadTimer()},s.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},s.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},s._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,i=this.hls,n=t[e];e<0||!n||n.details&&!n.details.live||(u.b.log("Loading subtitle track "+e),i.trigger(d.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))},s._toggleTrackModes=function(e){var t=this.media,i=this.subtitleDisplay,n=this.trackId;if(t){var r=Bt(t.textTracks);if(-1===e)[].slice.call(r).forEach((function(e){e.mode="disabled"}));else{var a=r[n];a&&(a.mode="disabled")}var s=r[e];s&&(s.mode=i?"showing":"hidden")}},s._setSubtitleTrackInternal=function(e){var t=this.hls,i=this.tracks;!Object(l.a)(e)||e<-1||e>=i.length||(this.trackId=e,u.b.log("Switching to subtitle track "+e),t.trigger(d.a.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},s._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=Bt(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},r=n,(a=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Ut(r.prototype,a),n}(h),Ht=i(7),Gt=window.performance,qt=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.ERROR,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.SUBTITLE_TRACKS_UPDATED,d.a.SUBTITLE_TRACK_SWITCH,d.a.SUBTITLE_TRACK_LOADED,d.a.SUBTITLE_FRAG_PROCESSED,d.a.LEVEL_UPDATED)||this).fragmentTracker=i,n.config=t.config,n.state=fe,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new Ht.a(t,t.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.onSubtitleFragProcessed=function(e){var t=e.frag,i=e.success;if(this.fragPrevious=t,this.state=me,i){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var r,a=t.start,s=0;s<n.length;s++)if(a>=n[s].start&&a<=n[s].end){r=n[s];break}var o=t.start+t.duration;r?r.end=o:(r={start:a,end:o},n.push(r))}}},r.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=me},r.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=fe)},r.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=me)},r.onSubtitleTracksUpdated=function(e){var t=this;u.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},r.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e){var t=e.id,i=e.details,n=this.currentTrackId,r=this.tracks,a=r[n];t>=r.length||t!==n||!a||(i.live&&function(e,t,i){void 0===i&&(i=0);var n=-1;ie(e,t,(function(e,t,i){t.start=e.start,n=i}));var r=t.fragments;if(n<0)r.forEach((function(e){e.start+=i}));else for(var a=n+1;a<r.length;a++)r[a].start=r[a-1].start+r[a-1].duration}(a.details,i,this.lastAVStart),a.details=i,this.setInterval(500))},r.onKeyLoaded=function(){this.state===ve&&(this.state=me)},r.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,n=e.frag,r=this.hls;if(this.state===ye&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&i&&i.key&&"AES-128"===i.method){var a=Gt.now();this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,(function(e){var t=Gt.now();r.trigger(d.a.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:a,tdecrypt:t}})}))}},r.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},r.doTick=function(){if(this.media)switch(this.state){case me:var e=this.config,t=this.currentTrackId,i=this.fragmentTracker,n=this.media,r=this.tracks;if(!r||!r[t]||!r[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,l=Math.min(e.maxBufferLength,e.maxMaxBufferLength),c=H.bufferedInfo(this._getBuffered(),n.currentTime,s),h=c.end,f=c.len,p=r[t].details,m=p.fragments,g=m.length,v=m[g-1].start+m[g-1].duration;if(f>l)return;var y=this.fragPrevious;h<v?(y&&p.hasProgramDateTime&&(a=oe(m,y.endProgramDateTime,o)),a||(a=le(y,m,h,o))):a=m[g-1],a&&a.encrypted?(u.b.log("Loading key for "+a.sn),this.state=ve,this.hls.trigger(d.a.KEY_LOADING,{frag:a})):a&&i.getState(a)===F&&(this.fragCurrent=a,this.state=ye,this.hls.trigger(d.a.FRAG_LOADING,{frag:a}))}else this.state=me},r.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},r._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},r.onMediaSeeking=function(){this.fragPrevious=null},n}(Re);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(jt||(jt={}));var Kt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Wt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Vt=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHED,d.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,i._licenseXhrSetup=void 0,i._emeEnabled=void 0,i._requestMediaKeySystemAccess=void 0,i._config=void 0,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._requestLicenseFailureCount=0,i._onMediaEncrypted=function(e){u.b.log('Media is encrypted using "'+e.initDataType+'" init data type'),i._attemptSetMediaKeys(),i._generateRequestWithPreferredKeySession(e.initDataType,e.initData)},i._config=t.config,i._widevineLicenseUrl=i._config.widevineLicenseUrl,i._licenseXhrSetup=i._config.licenseXhrSetup,i._emeEnabled=i._config.emeEnabled,i._requestMediaKeySystemAccess=i._config.requestMediaKeySystemAccessFunc,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.getLicenseServerUrl=function(e){switch(e){case jt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},s._attemptKeySystemAccess=function(e,t,i){var n=this,r=function(e,t,i){if(e===jt.WIDEVINE)return function(e,t){var i={videoCapabilities:[]};return t.forEach((function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})})),[i]}(0,i);throw new Error("Unknown key-system: "+e)}(e,0,i);u.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,r).then((function(t){n._onMediaKeySystemAccessObtained(e,t)})).catch((function(t){u.b.error('Failed to obtain key-system "'+e+'" access:',t)}))},s._onMediaKeySystemAccessObtained=function(e,t){var i=this;u.b.log('Access for key-system "'+e+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(n),t.createMediaKeys().then((function(t){n.mediaKeys=t,u.b.log('Media-keys created for key-system "'+e+'"'),i._onMediaKeysCreated()})).catch((function(e){u.b.error("Failed to create media-keys:",e)}))},s._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},s._onNewMediaKeySession=function(e){var t=this;u.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(i){t._onKeySessionMessage(e,i.message)}),!1)},s._onKeySessionMessage=function(e,t){u.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){u.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},s._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return u.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});u.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},s._generateRequestWithPreferredKeySession=function(e,t){var i=this,n=this._mediaKeysList[0];if(!n)return u.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)u.b.warn("Key-Session already initialized but requested again");else{var r=n.mediaKeysSession;if(!r)return u.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return u.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});u.b.log('Generating key-session request for "'+e+'" init data type'),n.mediaKeysSessionInitialized=!0,r.generateRequest(e,t).then((function(){u.b.debug("Key-session generation succeeded")})).catch((function(e){u.b.error("Error generating key-session request:",e),i.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},s._createLicenseXhr=function(e,t,i){var n=new XMLHttpRequest,r=this._licenseXhrSetup;try{if(r)try{r(n,e)}catch(t){n.open("POST",e,!0),r(n,e)}n.readyState||n.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,e,t,i),n},s._onLicenseRequestReadyStageChange=function(e,t,i,n){if(4===e.readyState)if(200===e.status)this._requestLicenseFailureCount=0,u.b.log("License request succeeded"),"arraybuffer"!==e.responseType&&u.b.warn("xhr response type was not set to the expected arraybuffer for license request"),n(e.response);else{if(u.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var r=3-this._requestLicenseFailureCount+1;u.b.warn("Retrying license request, "+r+" attempts left"),this._requestLicense(i,n)}},s._generateLicenseRequestChallenge=function(e,t){if(e.mediaKeySystemDomain===jt.WIDEVINE)return t;throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},s._requestLicense=function(e,t){u.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return u.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(i.mediaKeySystemDomain),r=this._createLicenseXhr(n,e,t);u.b.log("Sending license request to URL: "+n);var a=this._generateLicenseRequestChallenge(i,e);r.send(a)}catch(e){u.b.error("Failure requesting DRM license: "+e),this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},s.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},s.onMediaDetached=function(){this._media&&(this._media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null)},s.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),i=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(jt.WIDEVINE,t,i)}},r=n,(a=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Wt(r.prototype,a),n}(h);function Yt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var zt=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){Yt(e,t,i[t])}))}return e}({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Je,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:He,bufferController:qe,capLevelController:We,fpsController:Ye,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:Kt},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},{subtitleStreamController:qt,subtitleTrackController:$t,timelineController:Ft,audioStreamController:nt,audioTrackController:et,emeController:Vt});function Xt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zt(e,t,i){return t&&Jt(e.prototype,t),i&&Jt(e,i),e}i.d(t,"default",(function(){return ei}));var ei=function(e){var t,i;function n(t){var i;void 0===t&&(t={}),(i=e.call(this)||this).config=void 0,i._autoLevelCapping=void 0,i.abrController=void 0,i.capLevelController=void 0,i.levelController=void 0,i.streamController=void 0,i.networkControllers=void 0,i.audioTrackController=void 0,i.subtitleTrackController=void 0,i.emeController=void 0,i.coreComponents=void 0,i.media=null,i.url=null;var r=n.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");i.config=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){Xt(e,t,i[t])}))}return e}({},r,t);var a=Qt(i).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(u.a)(a.debug),i._autoLevelCapping=-1;var s=i.abrController=new a.abrController(Qt(i)),o=new a.bufferController(Qt(i)),l=i.capLevelController=new a.capLevelController(Qt(i)),d=new a.fpsController(Qt(i)),c=new I(Qt(i)),h=new M(Qt(i)),f=new N(Qt(i)),p=new Fe(Qt(i)),m=i.levelController=new Pe(Qt(i)),g=new j(Qt(i)),v=[m,i.streamController=new De(Qt(i),g)],y=a.audioStreamController;y&&v.push(new y(Qt(i),g)),i.networkControllers=v;var b=[c,h,f,s,o,l,d,p,g];if(y=a.audioTrackController){var w=new y(Qt(i));i.audioTrackController=w,b.push(w)}if(y=a.subtitleTrackController){var _=new y(Qt(i));i.subtitleTrackController=_,v.push(_)}if(y=a.emeController){var T=new y(Qt(i));i.emeController=T,b.push(T)}return(y=a.subtitleStreamController)&&v.push(new y(Qt(i),g)),(y=a.timelineController)&&b.push(new y(Qt(i))),i.coreComponents=b,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.isSupported=function(){return function(){var e=W();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!n}()},Zt(n,null,[{key:"version",get:function(){return"0.13.2"}},{key:"Events",get:function(){return d.a}},{key:"ErrorTypes",get:function(){return o.b}},{key:"ErrorDetails",get:function(){return o.a}},{key:"DefaultConfig",get:function(){return n.defaultConfig?n.defaultConfig:zt},set:function(e){n.defaultConfig=e}}]);var r=n.prototype;return r.destroy=function(){u.b.log("destroy"),this.trigger(d.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},r.attachMedia=function(e){u.b.log("attachMedia"),this.media=e,this.trigger(d.a.MEDIA_ATTACHING,{media:e})},r.detachMedia=function(){u.b.log("detachMedia"),this.trigger(d.a.MEDIA_DETACHING),this.media=null},r.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),u.b.log("loadSource:"+e),this.url=e,this.trigger(d.a.MANIFEST_LOADING,{url:e})},r.startLoad=function(e){void 0===e&&(e=-1),u.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},r.stopLoad=function(){u.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},r.swapAudioCodec=function(){u.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},r.recoverMediaError=function(){u.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},Zt(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){u.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){u.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){u.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){u.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){u.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){u.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,n=0;n<i;n++)if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),n}(Y);ei.defaultConfig=void 0}]).default})),window.Playlist={},window.players=[],function(e){"use strict";Playlist=function(t,i,n){var r=this;this.player=null,this.repeat=0,this.shuffle=!1,this.adsing=!1,this.items=i||[],this.item=null,this.active=0,this.oitems=e.merge([],i),this.timeout=null,this.adsInter=1,this.timer=0,this.live=!1,this.livePaused=!0,this.liveServer="",this.liveAPI="liveAPI",this.async=!0,this.type="audio",this.provider="html5",this.resource=!0,this.autoplay=!1,this.preview=!1,this.init=!1,this.options=e.extend(!0,{},this._options,n),this.el=e.extend({},this._el(),t),e.get(this.options.iconUrl,(function(e){var t=document.createElement("div");t.setAttribute("hidden",""),t.setAttribute("id","plyr-sprite"),t.innerHTML=(new XMLSerializer).serializeToString(e.documentElement),document.body.insertBefore(t,document.body.childNodes[0])})),e.each(this.el,(function(e,t){"playlist"!==e&&"controls"!==e&&(r.el[e]=r.el.playlist+" "+r.el[e])})),this.player=new Plyr(this.el.player,this.options),players.push(this.player),this.log("Init"),this._init()},Playlist.prototype={_options:{theme:0,bufferingClass:"is-buffering",initingClass:"plyr-initing",liveClass:"plyr--live",adsClass:"plyr--adsing",adsInterval:3,timeoutCount:1e4,debug:!1,iconUrl:"",autoplay:!1,autonext:!0,hideControls:!0,history:!0,expand:!1,fullscreen:{enabled:!0},controls:["play","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],i18n:{queue:"Queue",clear:"Clear",nextup:"Next up",empty:"Your queue is empty",live:"Live",preview:"Preview"}},_el:function(){return{playlist:"#playlist",player:"audio",plyr:".plyr",control:".plyr__controls",col:".plyr__col",row:".plyr__row",btns:".plyr-control-btns",ctrl:".plyr-control-ctrl",info:".plyr-control-info",wrap:".plyr-list-wrap",durationWrap:".plyr-duration-wrap",items:".plyr-list",item:".plyr-item",clear:".plyr-clear",cover:".plyr__controls .plyr__cover",title:".plyr__title",author:".plyr__author",content:".plyr__content",preview:".plyr-preview",progress:".plyr__progress__container",time:".plyr__time",current:".plyr__time--current",duration:".plyr__time--duration",queue:".plyr__queue",volume:".plyr__volume",prev:'[data-plyr="prev"]',play:'[data-plyr="play"]',next:'[data-plyr="next"]',shuffle:'[data-plyr="shuffle"]',repeat:'[data-plyr="repeat"]',like:'[data-plyr="like"]',download:'[data-plyr="download"]',purchase:'[data-plyr="purchase"]',captions:'[data-plyr="captions"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',video:'[data-plyr="video"]',fullscreen:'[data-plyr="fullscreen"]',menu:".plyr__menu",close:'[data-plyr="close"]',list:'[data-plyr="list"]',msg:".plyr__msg",waveform:".plyr__waveform",controls:{col:'<div class="plyr__col"></div>',row:'<div class="plyr__row"></div>',btns:'<div class="plyr-control-btns"></div>',ctrl:'<div class="plyr-control-ctrl"></div>',info:'<div class="plyr-control-info"></div>',wrap:'<div class="plyr-list-wrap"><div class="plyr-list"><div class="plyr-list-header"><h4>'+this.options.i18n.nextup+'</h4><button class="plyr-clear">'+this.options.i18n.clear+'</button><button class="plyr-close-queue"><svg role="presentation"><use xlink:href="#plyr-close"></use></svg></button></div><div class="plyr-list-content"></div></div></div>',durationWrap:'<div class="plyr-duration-wrap"></div>',prev:'<button type="button" class="plyr__control" data-plyr="prev"><svg role="presentation"><use xlink:href="#plyr-prev"></use></svg></button>',next:'<button type="button" class="plyr__control" data-plyr="next"><svg role="presentation"><use xlink:href="#plyr-next"></use></svg></button>',shuffle:'<button type="button" class="plyr__control" data-plyr="shuffle"><svg role="presentation"><use xlink:href="#plyr-shuffle"></use></svg></button>',repeat:'<button type="button" class="plyr__control" data-plyr="repeat"><svg class="icon-repeat"><use xlink:href="#plyr-repeat"></use></svg><svg class="icon-repeat-once"><use xlink:href="#plyr-repeat-once"></use></svg></button>',cover:'<div class="plyr__cover"></div>',content:'<div class="plyr__content"><span class="plyr-preview">'+this.options.i18n.preview+'</span><a class="plyr__title ajax" href="#"></a><div class="plyr__author"></div></div>',like:'<button type="button" class="plyr__control btn-like" data-action="like" data-type="post" data-plyr="like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button>',download:'<a target="_blank" class="plyr__control no-ajax" data-plyr="download"><svg role="presentation"><use xlink:href="#plyr-download"></use></svg></a>',purchase:'<a target="_blank" class="plyr__control" data-plyr="purchase"></a>',list:'<button type="button" class="plyr__control" data-plyr="list"><svg role="presentation"><use xlink:href="#plyr-list"></use></svg></button>',video:'<button type="button" class="plyr__control" data-plyr="video"><svg class="plyr-video-off"><use xlink:href="#plyr-video-off"></use></svg><svg class="plyr-video-on"><use xlink:href="#plyr-video-on"></use></svg></button>',msg:'<div class="plyr__msg"><div class="plyr__msg_content"><div class="plyr__msg_desc"></div><button class="close">&times;</button></div></div>',queue:'<div class="plyr__queue" data-plyr="list"><span></span><svg role="presentation"><use xlink:href="#plyr-expander"></use></svg></span>',item:'<div class="plyr-item"><div class="plyr-item-cover"><button class="btn-play"></button></div><div class="plyr-item-content"><a class="plyr-item-title"></a><div class="plyr-item-author"></div></div><button class="plyr-item-close close">&times;</button><button data-action="like" data-type="post" class="btn-like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button></div>',close:'<button class="plyr__control" data-plyr="close"><svg role="presentation"><use xlink:href="#plyr-close"></use></svg></button>',waveform:'<div class="plyr__waveform waveform"><div class="waveform-container"></div></div>'}}},_init:function(){var e=this;e._createItems(),e._initPlayerEvent(),e._initNavigatorPlayer()},_initPlayerEvent:function(){var t=this;this.log("Init plyr event"),this.player.on("ready",(function(i){if(e(t.el.plyr).removeClass(t.options.initingClass),t._createControls(),t._initEvents(),t._initState(),t.autoplay){t.isIOS()&&"youtube"==t.provider&&(t.player.currentTime=0),t.log("Play");var n=t.player.play();void 0!==n&&n.catch((function(e){t.log(e)})).then((function(){}))}else t._initHistory()})),this.player.on("play",(function(e){t._activeItem(),t.stopAds(),players.forEach((function(e){e!==t.player&&e.pause()})),t.live&&t.livePaused&&(t.log("Live restart"),t._play(t.active),t.livePaused=!1),t.isPlayable()||t.player.stop()})),this.player.on("pause",(function(i){t._activeItem(),e("html").removeClass(t.options.bufferingClass),t.live&&(t.livePaused=!0)})),this.player.on("enterfullscreen",(function(i){e(t.el.plyr).addClass("plyr-fullscreen")})),this.player.on("exitfullscreen",(function(i){e(t.el.plyr).removeClass("plyr-fullscreen")})),this.player.on("loadstart",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("waiting",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("seeking",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("canplay",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("playing",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("seeked",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("pause",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("stop",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("error",(function(i){e("html").removeClass(t.options.bufferingClass),4==t.player.media.error.code&&t.showMsg(t.options.i18n.error),t.next()})),this.player.on("adsimpression",(function(e){t.startAds()})),this.player.on("adscomplete",(function(e){t.stopAds()})),this.player.on("timeupdate",(function(i){t.timer++,5==t.timer&&(0==t.player.duration||t.player.duration>=2**32)&&(t.live=!0,e(t.el.plyr).addClass(t.options.liveClass),e(t.el.duration).html('<span class="plyr-live">'+t.options.i18n.live+"</span>")),t.item&&(t.timer/4==parseInt(t.options.timeoutCount)/1e3&&e(document).trigger("played",{id:t.item.id}),t.item.start&&t.item.start>0&&t.item.start/1e3>t.player.currentTime&&(t.player.currentTime=parseInt(t.item.start)/1e3),t.item.end&&t.item.end>0&&t.item.end/1e3==parseInt(t.player.currentTime)&&triggerEvent.call(t.player,t.player.media,"ended"))})),this.player.on("ended",(function(){t._activeItem(),t.player.stop(),t.preview?e(document).trigger("player_preview_end"):2!=t.repeat?1!=t.repeat||t.active!=t.items.length-1?t.options.autonext&&(t.items.length>1&&(t.active<t.items.length-1||t.shuffle)?t.next():t.autoNext()):t.next():t._play(t.active)})),e(document).on("pjax:success",(function(e){t._activeItem()}))},_initNavigatorPlayer:function(){var e=this;navigator.mediaSession&&(this.log("Init navigator event"),navigator.mediaSession.setActionHandler("play",(function(){e.player.play()})),navigator.mediaSession.setActionHandler("pause",(function(){e.player.pause()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){e.prev()})),navigator.mediaSession.setActionHandler("nexttrack",(function(){e.next()})),e.isIOS()||(navigator.mediaSession.setActionHandler("seekbackward",(function(t){e.player.rewind()})),navigator.mediaSession.setActionHandler("seekforward",(function(t){e.player.forward()}))))},isIOS:function(){return/iPhone|iPod|iPad/.test(navigator.platform)},_initState:function(){this.shuffle?e(this.el.shuffle).addClass("is--shuffle"):e(this.el.shuffle).removeClass("is--shuffle"),0==this.repeat&&e(this.el.repeat).removeClass("is--repeat is--repeat-once"),1==this.repeat&&e(this.el.repeat).addClass("is--repeat"),2==this.repeat&&e(this.el.repeat).addClass("is--repeat is--repeat-once")},_initEvents:function(){var t=this;e(this.el.prev).off().on("click",(function(){t.prev()})),e(this.el.next).off().on("click",(function(){t.active!=t.items.length-1?t.next():t.autoNext()})),e(this.el.shuffle).off().on("click",(function(){t.shuffle=!t.shuffle,t._initState()})),e(this.el.repeat).off().on("click",(function(){t.repeat++,3==t.repeat&&(t.repeat=0),t._initState()})),e(this.el.control).off().on("click",(function(i){t.options.expand&&e(i.target).hasClass("plyr__controls")&&e(t.el.playlist).toggleClass("plyr-expand")})),e(this.el.list).off().on("click",(function(){e(t.el.playlist).toggleClass("open")})),e(".plyr-close-queue").off().on("click",(function(){e(t.el.playlist).toggleClass("open")})),e(this.el.video).off().on("click",(function(){e(t.el.plyr).toggleClass("plyr__toggle-video")})),e(this.el.clear).off().on("click",(function(){t.setItems([])})),e(this.el.close).off().on("click",(function(){t.pause(),t.setItems([]),e(t.el.playlist).addClass("close-player")}))},_initHistory:function(){!this.init&&this.items.length>0&&(this.log("Start history"),this.init=!0,this.setSource())},_createControls:function(){if(this.resource){switch(this.log("Create controls"),e(this.el.controls.prev).insertBefore(e(this.el.play)),e(this.el.controls.next).insertAfter(e(this.el.play)),e(this.el.controls.repeat).insertAfter(e(this.el.next)),e(this.el.controls.shuffle).insertAfter(e(this.el.repeat)),e(this.el.controls.cover).insertAfter(e(this.el.shuffle)),e(this.el.controls.content).insertAfter(this.el.cover),e(this.el.controls.purchase).insertAfter(e(this.el.volume)),e(this.el.controls.download).insertAfter(e(this.el.volume)),e(this.el.controls.like).insertAfter(e(this.el.volume)),e(this.el.controls.video).insertAfter(e(this.el.menu)),e(this.el.controls.list).insertAfter(e(this.el.menu)),e(this.el.control).append(this.el.controls.btns),e(this.el.control).append(this.el.controls.ctrl),e(this.el.control).append(this.el.controls.info),e(this.el.btns).append(e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat),e(this.el.shuffle)),e(this.el.ctrl).append(e(this.el.current),e(this.el.progress),e(this.el.duration),e(this.el.volume),e(this.el.captions),e(this.el.pip),e(this.el.fullscreen),e(this.el.airplay),e(this.el.video),e(this.el.menu)),e(this.el.info).append(e(this.el.cover),e(this.el.content),e(this.el.purchase),e(this.el.download),e(this.el.like),e(this.el.list)),this.options.theme){case"1":e(this.el.info).append(e(this.el.controls.col).append(e(this.el.controls.row).append(e(this.el.content),e(this.el.preview),e(this.el.time)),e(this.el.progress))),e(this.el.ctrl).append(e(this.el.purchase),e(this.el.download),e(this.el.like),e(this.el.list));break;case"2":e(this.el.shuffle).insertBefore(e(this.el.prev)),e(this.el.current).insertBefore(e(this.el.duration)),e(this.el.list).appendTo(e(this.el.ctrl));break;case"3":e(this.el.list).appendTo(e(this.el.ctrl)),e(this.el.btns).append(e(this.el.controls.row).append(e(this.el.shuffle),e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat))),e(this.el.btns).append(e(this.el.controls.row).append(e(this.el.current),e(this.el.progress),e(this.el.duration)));break;case"4":e(this.el.repeat).insertBefore(e(this.el.prev)),e(this.el.shuffle).insertBefore(e(this.el.prev)),e(this.el.list).appendTo(e(this.el.btns));break;case"radio":e(this.el.current).insertBefore(e(this.el.duration)),e(this.el.list).appendTo(e(this.el.ctrl));break;case"video":e(this.el.btns).append(e(this.el.controls.durationWrap).append(e(this.el.time)),this.el.controls.close),e(this.el.control).append(e(this.el.cover),e(this.el.progress)),e(this.el.content).first().append(this.el.controls.queue).insertBefore(this.el.items)}this.select()}},_createItems:function(){this.log("Create queque");var t=this;e(t.el.playlist).addClass("plyr-theme-"+t.options.theme).append(e(t.el.controls.wrap)),0!=t.oitems.length&&e.each(t.oitems,(function(e,i){t._buildItem(i,e-1)}))},_buildItem:function(t,i){var n=this,r=e(this.el.controls.item),a=e(".plyr-list-content",this.el.items);return r.attr("data-play-id",t.id),r.find(".plyr-item-cover").css("background-image","url("+t.artwork_url+")"),r.find(".btn-play").attr("data-play-id",t.id),r.find(".btn-like").attr("data-id",t.id).addClass(t.like?"active":""),r.find(".plyr-item-title").html(t.title).attr("href",t.uri),r.find(".plyr-item-author").html(this.buildAuthor(t)),t.el=r,e(".plyr-list-empty",this.el.items).remove(),0==a.children().length?t.el.prependTo(a):t.el.insertAfter(a.children().eq(i)),r.on("click",".plyr-item-close",(function(t){t.preventDefault();var i=e(this).closest("[data-play-id]").attr("data-play-id");n._removeItem({id:i})})),e(document).trigger("refresh"),t},_addItem:function(e,t){t<0&&(t=0),e=this._buildItem(e,t),this.items.splice(t+1,0,e)},_removeItem:function(e){var t=this;if(null!=e.id){var i=this.getIndex(e.id);i>-1&&(this.items[i].el.remove(),this.items.splice(i,1),this.active==i&&this.setIndex(t.active,(function(){t._play(t.active)})))}},_activeItem:function(){var t=this.getCurrent();if(t){this.log("Active item"),e("[data-play-id]").removeClass("active is-current");var i='[data-play-id="'+t.id+'"]';e(i).addClass("active is-current"),t.from&&e('[data-play-id="'+t.from.id+'"]').addClass("active"),this.player.media&&this.player.paused&&(e(i).removeClass("active"),t.from&&e('[data-play-id="'+t.from.id+'"]').removeClass("active"))}},_history:function(){if(this.options.history){this.log("Store history");var e=this._store("plyr");e.active=this.active,e.items=this.items,this._store("plyr",e)}},_store:function(e,t){try{if(arguments.length>1)return localStorage.setItem(e,JSON.stringify(t));var i=localStorage.getItem(e);return i&&JSON.parse(i)||{}}catch(e){}},_play:function(e){var t=this;t.timer=0,t.items[e]&&(t.autoplay=!0,t.active=e,t._activeItem(),t.setSource(),t.updateLive(),t.playAds())},setSource:function(){if(this.player.stop(),this.isPlayable()){var t=this,i=this.getCurrent(),n=i.stream_url,r={type:i.type||"audio",sources:[{src:n,size:"576"}]};i.sources&&(r.sources=r.sources.concat(i.sources));var a=i.provider;if(""!==a&&(r.sources[0].provider=a),t.hideMsg(),this.log("Set source: "+n+" : "+a),t.live=!1,e(t.el.plyr).removeClass(t.options.liveClass),(n.toLowerCase().indexOf("icecast")>-1||n.toLowerCase().indexOf("shoutcast")>-1||n.toLowerCase().indexOf("azuracast")>-1||n.toLowerCase().indexOf(t.liveAPI)>-1)&&(t.live=!0),i.tracks&&(r.tracks=i.tracks),"audio"===r.type&&this.player.fullscreen.active&&this.player.fullscreen.exit(),t.async&&r.type==this.type&&a==this.provider&&"vimeo"!==a){if(t.log("Ansyc load"),t.resource=!1,t.select(),"html5"==a)e(this.el.playlist).find("video, audio").removeAttr("src").children().remove(),window.Plyr.source.insertElements.call(t.player,"source",r.sources),Object.keys(r).includes("tracks")&&(window.Plyr.source.insertElements.call(t.player,"track",r.tracks),t.player.language=i.tracks[0].srclang,t.player.currentTrack=0),t.player.media.load();else{var s=i.provider_id||n;switch(a){case"youtube":this.player.embed.loadVideoById(s);break;case"vimeo":this.player.embed.loadVideo(s);break;default:this.player.embed.load(s,{auto_play:!0})}}setTimeout((function(){t.player.media.dispatchEvent(new CustomEvent("ready"))}),0)}else t.log("Sync load"),this.resource=!0,this.player.source=r,e(this.el.plyr).addClass(this.options.initingClass);if(n.indexOf(".m3u8")>-1&&Hls.isSupported()){var o=new Hls;o.loadSource(n),o.attachMedia(e(this.el.playlist).find("video, audio")[0])}this.type=r.type,this.provider=a}},getItems:function(){return this.items},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t];return!1},setItems:function(t){var i=this;this.items=t,e(".plyr-list-content",this.el.items).html('<div class="plyr-list-empty">'+this.options.i18n.empty+"</div>"),e.each(i.items,(function(e,t){i._buildItem(t,e-1)})),this._history()},select:function(t){this.log("Select item");var i=this;if(t>-1&&(this.active=t),clearTimeout(this.timeout),this.timeout=null,0!=this.items.length){var n=this.getCurrent();if(this.updateInfo(),n.stream_url.indexOf("preview")>-1?this.preview=!0:this.preview=!1,i.preview?e(this.el.playlist).addClass("plyr-is-preview"):e(this.el.playlist).removeClass("plyr-is-preview"),""!==n.purchase_url?e(this.el.purchase).addClass("is-purchasable"):e(this.el.purchase).removeClass("is-purchasable"),e(this.el.purchase).html(n.purchase_title),e(this.el.purchase).attr("href",n.purchase_url),e(this.el.purchase).next(".plyr_purchase").remove(),""!==n.purchase_link&&e(this.el.purchase).after(e(n.purchase_link).addClass("plyr_purchase")),n.downloadable?e(this.el.download).addClass("is-downloadable"):e(this.el.download).removeClass("is-downloadable"),e(this.el.download).attr("href",n.download_url),e(this.el.like).attr("data-id",n.id),n.like?e(this.el.like).addClass("active"):e(this.el.like).removeClass("active"),e(this.el.waveform).remove(),n.waveform||n.forceWaveform){var r=e(this.el.controls.waveform);e(this.el.progress).prepend(r);var a={container:r.find(".waveform-container"),id:n.id,duration:n.duration,height:40};"object"==typeof play&&play.waveform_option&&(a=e.extend(!0,{},a,play.waveform_option));var s=new Waveform(a),o=n.waveform?n.waveform:n.stream_url;s.load(o),e(s.wrap).on("update",(function(e,t,n){i.player.currentTime=i.player.duration*t}))}if(e("span",this.el.queue).html(this.options.i18n.queue+"  "+(this.active+1)+" / "+this.items.length),n.msg&&this.showMsg(n.msg),RangeTouch.setup('input[type="range"]',{}),e(document).trigger("refresh"),window.location.href!==n.uri&&"video"==this.options.theme&&e(".single-station").length){var l=n.uri;void 0!==typeof Pjax&&-1===l.toLowerCase().indexOf("reload")?e(document).trigger("reload",[l]):location.href=l}e(document).trigger("selected:player",{id:n.id}),this._history()}},updateInfo:function(){this.log("Update info");var t=this.getCurrent(),i={title:t.title,artist:t.artist,artwork:[{src:t.artwork_url}]},n=e(this.el.playlist).find("video, audio");e(this.el.cover).css("background-image","url("+t.artwork_url+")"),n.attr("poster",t.artwork_url),e(this.el.title).html("<span>"+t.title+" </span>"),n.attr("title",t.title),e(this.el.title).attr("href",t.uri),e(this.el.author).html(this.buildAuthor(t)),this.buildMarquee(e(this.el.title)),this.buildMarquee(e(this.el.author)),navigator.mediaSession&&(this.log("Navigator mediaSession"),navigator.mediaSession.metadata=new MediaMetadata(i))},buildAuthor:function(e){var t='<a href="'+e.user_url+'">'+e.user+"</a>";if(e.artist&&e.artist_url){var i=e.artist.split(","),n=e.artist_url.split(",");t=[];for(var r=0;r<i.length;++r)t.push('<a href="'+n[r]+'">'+i[r]+"</a>");t=t.join("<span>, </span>").replace(/, ((?:.(?!, ))+)$/," & $1 ")}return t},buildMarquee:function(t){if("video"!=this.options.theme){t.removeClass("marquee-scroller is-animating").attr("style","");var i=0;t.children().each((function(){var t=e(this)[0].getBoundingClientRect().width;i+=t})),Math.ceil(i)>Math.ceil(t.width())&&(t.addClass("marquee-scroller is-animating").attr("style","--marquee-scroll-width:"+i),t.append(t.children().clone()),t[0].addEventListener("animationend",(()=>{t.removeClass("is-animating")})),t[0].addEventListener("mouseover",(()=>{t.addClass("is-animating")})))}},setIndex:function(e,t){this.active=e>this.items.length-1?0:e<0?this.items.length-1:e,this.shuffle&&(this.active=Math.floor(Math.random()*this.items.length)),t&&t()},getIndex:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return t;return-1},getCurrent:function(){return this.item=this.items[this.active],this.item},isPlayable:function(){var e=this.getCurrent();return!(!e||""===e.stream_url)},updateLive:function(){if(this.live){this.log("Update live");var t,i,n,r=this,a=this.getCurrent(),s="",o="",l={},d={};r.liveServer="",a&&(s=(t=a.stream_url).substring(0,t.lastIndexOf("/")),t.toLowerCase().indexOf("icecast")>-1&&(r.liveServer="icecast",o="/status-json.xsl"),t.toLowerCase().indexOf("shoutcast")>-1&&(r.liveServer="shoutcast",o="/stats?sid=1&json=1",l.dataType="jsonp"),t.toLowerCase().indexOf("azuracast")>-1&&(r.liveServer="azuracast",o="/api/nowplaying"),t.toLowerCase().indexOf(r.liveAPI)>-1&&(r.liveServer=r.liveAPI,s="",o=t.substring(t.lastIndexOf(r.liveAPI+"=")+1)),clearTimeout(r.timeout),l.url=s+o,e.ajax(l).then((function(e){if("icecast"==r.liveServer){if(i=e.icestats.source,(n=i.length)>0){i=e.icestats.source[n-1];for(var s=0;s<n;++s)if(t.indexOf(e.icestats.source[s].listenurl)>-1){i=e.icestats.source[s];break}}i.title&&(d.title=i.title),i.artist&&(d.artist=i.artist)}else if("shoutcast"==r.liveServer)d.title=e.songtitle;else if("azuracast"==r.liveServer){for(i=e[e.length-1].now_playing.song,s=0;s<e.length;++s)if(t.indexOf(e[s].station.listen_url)>-1){i=e[s].now_playing.song;break}i.text&&(d.title=i.text),i.art&&(d.artwork_url=i.art)}else r.liveServer==r.liveAPI&&"object"==typeof e&&(d=e);if(d.title,r.timeout&&d.title&&d.title!==a.title){a.title=d.title;for(const e in d)a[e]=d[e];r.updateInfo()}r.timeout=setTimeout((function(){r.updateLive()}),5e3)})))}},playAds:function(){this.log("Play ads");var e=this;e.player.ads&&(e.adsInter%(parseInt(e.options.adsInterval)+1)==0&&e.player.ads.cancel(),e.adsInter++)},startAds:function(){this.log("Start ads"),this.adsing=!0,this.player.pause(),e(this.el.plyr).addClass(this.options.adsClass),e("html").removeClass(this.options.bufferingClass)},stopAds:function(){this.log("Stop ads"),this.adsing=!1,e(this.el.plyr).removeClass(this.options.adsClass)},showMsg:function(t){this.log("Show msg");var i=this;0==e(i.el.msg).length&&e(i.el.playlist).append(i.el.controls.msg),e(i.el.msg+" .close").off().on("click",(function(){i.hideMsg()})),e(i.el.msg).show().find(".plyr__msg_desc").html(t)},hideMsg:function(){this.log("Hide msg"),e(this.el.msg).hide()},play:function(t,i){var n;if(e(this.el.playlist).removeClass("close-player"),e.isArray(t))t.length&&(this.setItems(t),n=i||0,this._play(n));else if(-1==(n=this.getIndex(t.id)))n=1==i?this.active:this.items.length-1,this.add(t,n),1!=this.items.length&&0!=i||this._play(this.items.length-1);else{if(1==i){var r=this.getItem(t.id);return this.remove(t.id),void this.add(r,this.active)}if(-1==i)return;n!==this.active?this._play(n):this.adsing||this.player.togglePlay()}},pause:function(){this.player.pause()},prev:function(){var e=this;this.setIndex(e.active-1,(function(){e._play(e.active)}))},next:function(){var e=this;this.setIndex(e.active+1,(function(){e._play(e.active)}))},autoNext:function(){var t=e.map(this.items,(function(e){return e.id}));e(document).trigger("complete.play",{ids:t,shuffle:this.shuffle})},add:function(e,t){this._addItem(e,t)},remove:function(e){var t=this.getCurrent();this._removeItem({id:e}),this.active=this.getIndex(t.id)},log:function(e){this.player.debug.log("> "+e)}}}(jQuery);var spotify={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.spotify="spotify","object"!=typeof window.SpotifyIFrameAPI?spotify.loadScript.call(e):spotify.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("spotify.com")){var i=e.config.urls.spotify+t.replace("https://open.spotify.com","").replace(/\//gi,":"),n=document.createElement("iframe");n.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(n,e.media),SpotifyIFrameAPI.createController(n,{uri:i},(t=>{e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.embed=t,e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.hasPlayed?e.embed.togglePlay():e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.pause(),e.media.currentTime=0},e.embed.load=function(t){e.embed.loadUri(e.config.urls.spotify+t.replace(/\//gi,":"))};var i=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>i,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seek(parseInt(t))}}),e.embed.addListener("ready",(function(t){triggerEvent.call(e,e.media,"waiting")})),e.embed.addListener("playback_update",(function(t){t.data.duration>0&&t.data.position==t.data.duration?triggerEvent.call(e,e.media,"ended"):(assurePlaybackState.call(e,!t.data.isPaused),t.data.isBuffering||(e.media.seeking&&t.data.isPaused&&e.media.play(),e.media.seeking=!1,triggerEvent.call(e,e.media,"seeked")),i=parseInt(t.data.position/1e3),triggerEvent.call(e,e.media,"timeupdate"),e.media.duration!=t.data.duration/1e3&&(e.media.duration=t.data.duration/1e3,triggerEvent.call(e,e.media,"durationchange")),triggerEvent.call(e,e.media,t.data.isBuffering?"seeking":"playing"))}))})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){window.onSpotifyIframeApiReady=t=>{window.SpotifyIFrameAPI=t,spotify.ready.call(e)}},t.src="//open.spotify.com/embed-podcast/iframe-api/v1",document.head.appendChild(t)}},soundcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.soundcloud="https://w.soundcloud.com/player/?url=","object"!=typeof window.SC?soundcloud.loadScript.call(e):soundcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("soundcloud.com")){var i=e.config.urls.soundcloud+t+"&auto_play=true",n=document.createElement("iframe");n.setAttribute("src",i),n.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(n,e.media),e.embed=SC.Widget(n),e.embed.bind(SC.Widget.Events.READY,(function(){var t;e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seekTo(0),e.embed.pause(),e.media.paused=!0},e.embed.getCurrentSound((function(e){t=e.uri})),Object.defineProperty(e.media,"currentSrc",{get:()=>t});var i=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>i,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seekTo(1e3*t)}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration((function(t){e.media.duration=t/1e3,triggerEvent.call(e,e.media,"durationchange")})),e.embed.bind(window.SC.Widget.Events.PLAY,(function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.bind(window.SC.Widget.Events.PAUSE,(function(){assurePlaybackState.call(e,!1)})),e.embed.bind(window.SC.Widget.Events.FINISH,(function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.bind(window.SC.Widget.Events.LOAD_PROGRESS,(function(t){e.media.buffered=t.loadProgress,triggerEvent.call(e,e.media,"progress"),1===parseInt(t.loadProgress)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.bind(window.SC.Widget.Events.PLAY_PROGRESS,(function(t){e.media.seeking=!1,i=parseInt(t.currentPosition/1e3),triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){soundcloud.ready.call(e)},t.src="//w.soundcloud.com/player/api.js",document.head.appendChild(t)}},mixcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.mixcloud="https://www.mixcloud.com/widget/iframe/?hide_cover=1&mini=1&feed=","object"!=typeof window.Mixcloud?mixcloud.loadScript.call(e):mixcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("soundcloud.com")){var i=e.config.urls.mixcloud+t,n=document.createElement("iframe");n.setAttribute("src",i),n.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(n,e.media),e.embed=Mixcloud.PlayerWidget(n),e.embed.ready.then((function(){e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seek(0),e.embed.pause(),e.media.paused=!0};var t=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>t,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seek(t).then((function(){e.media.seeking=!1,e.embed.play()}))}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration().then((function(t){e.media.duration=t,triggerEvent.call(e,e.media,"durationchange")})),e.embed.events.play.on((function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.events.pause.on((function(){assurePlaybackState.call(e,!1)})),e.embed.events.ended.on((function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.events.buffering.on((function(t){e.media.buffered=t,1===parseInt(t)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.events.progress.on((function(i){e.media.seeking=!1,t=i,triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){mixcloud.ready.call(e)},t.src="//widget.mixcloud.com/media/js/widgetApi.js",document.head.appendChild(t)}};"object"==typeof navigator&&function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Plyr",t):(e="undefined"!=typeof globalThis?globalThis:e||self).Plyr=t()}(this,(function(){"use strict";!function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw new Error("Could not prevent default")}catch(e){var t=function(e,t){var i,n;return(t=t||{}).bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n=i.preventDefault,i.preventDefault=function(){n.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},i};t.prototype=window.Event.prototype,window.CustomEvent=t}}();var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),i=function(e){var i={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(i[Symbol.iterator]=function(){return i}),i},n=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},r=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(e){return!1}})()||function(){var r=function(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var t=typeof e;if("undefined"===t);else if("string"===t)""!==e&&this._fromString(e);else if(e instanceof r){var i=this;e.forEach((function(e,t){i.append(t,e)}))}else{if(null===e||"object"!==t)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;n++){var a=e[n];if("[object Array]"!==Object.prototype.toString.call(a)&&2===a.length)throw new TypeError("Expected [string, any] as entry at index "+n+" of URLSearchParams's input");this.append(a[0],a[1])}else for(var s in e)e.hasOwnProperty(s)&&this.append(s,e[s])}},a=r.prototype;a.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},a.delete=function(e){delete this._entries[e]},a.get=function(e){return e in this._entries?this._entries[e][0]:null},a.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},a.has=function(e){return e in this._entries},a.set=function(e,t){this._entries[e]=[String(t)]},a.forEach=function(e,t){var i;for(var n in this._entries)if(this._entries.hasOwnProperty(n)){i=this._entries[n];for(var r=0;r<i.length;r++)e.call(t,i[r],n,this)}},a.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),i(e)},a.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),i(e)},a.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),i(e)},t&&(a[Symbol.iterator]=a.entries),a.toString=function(){var e=[];return this.forEach((function(t,i){e.push(n(i)+"="+n(t))})),e.join("&")},e.URLSearchParams=r}();var a=e.URLSearchParams.prototype;"function"!=typeof a.sort&&(a.sort=function(){var e=this,t=[];this.forEach((function(i,n){t.push([n,i]),e._entries||e.delete(n)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var i=0;i<t.length;i++)this.append(t[i][0],t[i][1])}),"function"!=typeof a._fromString&&Object.defineProperty(a,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,i){t.push(i)}));for(var i=0;i<t.length;i++)this.delete(t[i])}var n,a=(e=e.replace(/^\?/,"")).split("&");for(i=0;i<a.length;i++)n=a[i].split("="),this.append(r(n[0]),n.length>1?r(n[1]):"")}})}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||function(){var t=e.URL,i=function(t,i){"string"!=typeof t&&(t=String(t)),i&&"string"!=typeof i&&(i=String(i));var n,r=document;if(i&&(void 0===e.location||i!==e.location.href)){i=i.toLowerCase(),(n=(r=document.implementation.createHTMLDocument("")).createElement("base")).href=i,r.head.appendChild(n);try{if(0!==n.href.indexOf(i))throw new Error(n.href)}catch(e){throw new Error("URL unable to set base "+i+" due to "+e)}}var a=r.createElement("a");a.href=t,n&&(r.body.appendChild(a),a.href=a.href);var s=r.createElement("input");if(s.type="url",s.value=t,":"===a.protocol||!/:/.test(a.href)||!s.checkValidity()&&!i)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:a});var o=new e.URLSearchParams(this.search),l=!0,d=!0,u=this;["append","delete","set"].forEach((function(e){var t=o[e];o[e]=function(){t.apply(o,arguments),l&&(d=!1,u.search=o.toString(),d=!0)}})),Object.defineProperty(this,"searchParams",{value:o,enumerable:!0});var c=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==c&&(c=this.search,d&&(l=!1,this.searchParams._fromString(this.search),l=!0))}})},n=i.prototype;["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(n,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(n,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(n,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),i.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},i.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=i}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(i){setInterval((function(){e.location.origin=t()}),100)}}}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e);var s={addCSS:!0,thumbWidth:15,watch:!0},o=function(e){return null!=e?e.constructor:null},l=function(e,t){return!!(e&&t&&e instanceof t)},d=function(e){return o(e)===String},u=function(e){return Array.isArray(e)},c=function(e){return l(e,NodeList)},h=d,f=u,p=c,m=function(e){return l(e,Element)},g=function(e){return l(e,Event)},v=function(e){return function(e){return null==e}(e)||(d(e)||u(e)||c(e))&&!e.length||function(e){return o(e)===Object}(e)&&!Object.keys(e).length};var y=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),m(t)?this.element=t:h(t)&&(this.element=document.querySelector(t)),m(this.element)&&v(this.element.rangeTouch)&&(this.config=a({},s,{},i),this.init())}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,i=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[i](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!g(t))return null;var i,n=t.target,r=t.changedTouches[0],a=parseFloat(n.getAttribute("min"))||0,s=parseFloat(n.getAttribute("max"))||100,o=parseFloat(n.getAttribute("step"))||1,l=n.getBoundingClientRect(),d=100/l.width*(this.config.thumbWidth/2)/100;return 0>(i=100/l.width*(r.clientX-l.left))?i=0:100<i&&(i=100),50>i?i-=(100-2*i)*d:50<i&&(i+=2*(i-50)*d),a+function(e,t){if(1>t){var i=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(i))}return Math.round(e/t)*t}(i/100*(s-a),o)}},{key:"set",value:function(t){e.enabled&&g(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var i=new Event(t,{bubbles:!0});e.dispatchEvent(i)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=null;if(v(t)||h(t)?n=Array.from(document.querySelectorAll(h(t)?t:'input[type="range"]')):m(t)?n=[t]:p(t)?n=Array.from(t):f(t)&&(n=t.filter(m)),v(n))return null;var r=a({},s,{},i);if(h(t)&&r.watch){var o=new MutationObserver((function(i){Array.from(i).forEach((function(i){Array.from(i.addedNodes).forEach((function(i){m(i)&&function(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}(i,t)&&new e(i,r)}))}))}));o.observe(document.body,{childList:!0,subtree:!0})}return n.map((function(t){return new e(t,i)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();window.RangeTouch=y;const b=e=>null!=e?e.constructor:null,w=(e,t)=>Boolean(e&&t&&e instanceof t),_=e=>null==e,T=e=>b(e)===Object,E=e=>b(e)===String,S=e=>"function"==typeof e,k=e=>Array.isArray(e),A=e=>w(e,NodeList),C=e=>_(e)||(E(e)||k(e)||A(e))&&!e.length||T(e)&&!Object.keys(e).length;var R={nullOrUndefined:_,object:T,number:e=>b(e)===Number&&!Number.isNaN(e),string:E,boolean:e=>b(e)===Boolean,function:S,array:k,weakMap:e=>w(e,WeakMap),nodeList:A,element:e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,textNode:e=>b(e)===Text,event:e=>w(e,Event),keyboardEvent:e=>w(e,KeyboardEvent),cue:e=>w(e,window.TextTrackCue)||w(e,window.VTTCue),track:e=>w(e,TextTrack)||!_(e)&&E(e.kind),promise:e=>w(e,Promise)&&S(e.then),url:e=>{if(w(e,window.URL))return!0;if(!E(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!C(new URL(t).hostname)}catch(e){return!1}},empty:C};const L=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i=Object.keys(t).find((t=>void 0!==e.style[t]));return!!R.string(i)&&t[i]})();function D(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}var x={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function O(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function P(e={},...t){if(!t.length)return e;const i=t.shift();return R.object(i)?(Object.keys(i).forEach((t=>{R.object(i[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),P(e[t],i[t])):Object.assign(e,{[t]:i[t]})})),P(e,...t)):e}function I(e,t){const i=e.length?e:[e];Array.from(i).reverse().forEach(((e,i)=>{const n=i>0?t.cloneNode(!0):t,r=e.parentNode,a=e.nextSibling;n.appendChild(e),a?r.insertBefore(n,a):r.appendChild(n)}))}function M(e,t){R.element(e)&&!R.empty(t)&&Object.entries(t).filter((([,e])=>!R.nullOrUndefined(e))).forEach((([t,i])=>e.setAttribute(t,i)))}function N(e,t,i){const n=document.createElement(e);return R.object(t)&&M(n,t),R.string(i)&&(n.innerText=i),n}function F(e,t,i,n){R.element(t)&&t.appendChild(N(e,i,n))}function U(e){R.nodeList(e)||R.array(e)?Array.from(e).forEach(U):R.element(e)&&R.element(e.parentNode)&&e.parentNode.removeChild(e)}function B(e){if(!R.element(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function j(e,t){return R.element(t)&&R.element(t.parentNode)&&R.element(e)?(t.parentNode.replaceChild(e,t),e):null}function $(e,t){if(!R.string(e)||R.empty(e))return{};const i={},n=P({},t);return e.split(",").forEach((e=>{const t=e.trim(),r=t.replace(".",""),a=t.replace(/[[\]]/g,"").split("="),[s]=a,o=a.length>1?a[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":R.string(n.class)?i.class=`${n.class} ${r}`:i.class=r;break;case"#":i.id=t.replace("#","");break;case"[":i[s]=o}})),P(n,i)}function H(e,t){if(!R.element(e))return;let i=t;R.boolean(i)||(i=!e.hidden),e.hidden=i}function G(e,t,i){if(R.nodeList(e))return Array.from(e).map((e=>G(e,t,i)));if(R.element(e)){let n="toggle";return void 0!==i&&(n=i?"add":"remove"),e.classList[n](t),e.classList.contains(t)}return!1}function q(e,t){return R.element(e)&&e.classList.contains(t)}function K(e,t){const{prototype:i}=Element;return(i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function W(e){return this.elements.container.querySelectorAll(e)}function V(e){return this.elements.container.querySelector(e)}function Y(e=null,t=!1){R.element(e)&&e.focus({preventScroll:!0,focusVisible:t})}const z={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},X={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t){const i=X[e]||"html5"!==t;return{api:i,ui:i&&X.rangeInput}},pip:!(x.isIPhone||!R.function(N("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||N("video").disablePictureInPicture)),airplay:R.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(R.empty(e))return!1;const[t]=e.split("/");let i=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(z).includes(i)&&(i+=`; codecs="${z[e]}"`);try{return Boolean(i&&this.media.canPlayType(i).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==L,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Q=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function J(e,t,i,n=!1,r=!0,a=!1){if(!e||!("addEventListener"in e)||R.empty(t)||!R.function(i))return;const s=t.split(" ");let o=a;Q&&(o={passive:r,capture:a}),s.forEach((t=>{this&&this.eventListeners&&n&&this.eventListeners.push({element:e,type:t,callback:i,options:o}),e[n?"addEventListener":"removeEventListener"](t,i,o)}))}function Z(e,t="",i,n=!0,r=!1){J.call(this,e,t,i,!0,n,r)}function ee(e,t="",i,n=!0,r=!1){J.call(this,e,t,i,!1,n,r)}function te(e,t="",i,n=!0,r=!1){const a=(...s)=>{ee(e,t,a,n,r),i.apply(this,s)};J.call(this,e,t,a,!0,n,r)}function ie(e,t="",i=!1,n={}){if(!R.element(e)||R.empty(t))return;const r=new CustomEvent(t,{bubbles:i,detail:{...n,plyr:this}});e.dispatchEvent(r)}function ne(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:i,callback:n,options:r}=e;t.removeEventListener(i,n,r)})),this.eventListeners=[])}function re(){return new Promise((e=>this.ready?setTimeout(e,0):Z.call(this,this.elements.container,"ready",e))).then((()=>{}))}function ae(e){R.promise(e)&&e.then(null,(()=>{}))}function se(e){return R.array(e)?e.filter(((t,i)=>e.indexOf(t)===i)):e}function oe(e,t){return R.array(e)&&e.length?e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)):null}function le(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const de=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,i])=>({...e,[t/i]:[t,i]})),{});function ue(e){return!!(R.array(e)||R.string(e)&&e.includes(":"))&&(R.array(e)?e:e.split(":")).map(Number).every(R.number)}function ce(e){if(!R.array(e)||!e.every(R.number))return null;const[t,i]=e,n=(e,t)=>0===t?e:n(t,e%t),r=n(t,i);return[t/r,i/r]}function he(e){const t=e=>ue(e)?e.split(":").map(Number):null;let i=t(e);if(null===i&&(i=t(this.config.ratio)),null===i&&!R.empty(this.embed)&&R.array(this.embed.ratio)&&({ratio:i}=this.embed),null===i&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;i=[e,t]}return ce(i)}function fe(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,i=he.call(this,e);if(!R.array(i))return{};const[n,r]=ce(i),a=100/n*r;if(le(`aspect-ratio: ${n}/${r}`)?t.style.aspectRatio=`${n}/${r}`:t.style.paddingBottom=`${a}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),i=(e-a)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${i}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:a,ratio:i}}function pe(e,t,i=.05){const n=e/t,r=oe(Object.keys(de),n);return Math.abs(r-n)<=i?de[r]:[e,t]}const me={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!R.empty(t)||X.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:me.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,R.empty(this.config.ratio)||fe.call(e),Object.defineProperty(e.media,"quality",{get(){const t=me.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&R.function(e.config.quality.onChange))e.config.quality.onChange(t);else{const i=me.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!i)return;const{currentTime:n,paused:r,preload:a,readyState:s,playbackRate:o}=e.media;e.media.src=i.getAttribute("src"),("none"!==a||s)&&(e.once("loadedmetadata",(()=>{e.speed=o,e.currentTime=n,r||ae(e.play())})),e.media.load())}ie.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(U(me.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function ge(e,...t){return R.empty(e)?e:e.toString().replace(/{(\d+)}/g,((e,i)=>t[i].toString()))}const ve=(e="",t="",i="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),i.toString()),ye=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function be(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const we={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},_e={get(e="",t={}){if(R.empty(e)||R.empty(t))return"";let i=O(t.i18n,e);if(R.empty(i))return Object.keys(we).includes(e)?we[e]:"";const n={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(n).forEach((([e,t])=>{i=ve(i,e,t)})),i}};class Te{constructor(e){t(this,"get",(e=>{if(!Te.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(R.empty(t))return null;const i=JSON.parse(t);return R.string(e)&&e.length?i[e]:i})),t(this,"set",(e=>{if(!Te.supported||!this.enabled)return;if(!R.object(e))return;let t=this.get();R.empty(t)&&(t={}),P(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Ee(e,t="text"){return new Promise(((i,n)=>{try{const n=new XMLHttpRequest;if(!("withCredentials"in n))return;n.addEventListener("load",(()=>{if("text"===t)try{i(JSON.parse(n.responseText))}catch(e){i(n.responseText)}else i(n.response)})),n.addEventListener("error",(()=>{throw new Error(n.status)})),n.open("GET",e,!0),n.responseType=t,n.send()}catch(e){n(e)}}))}function Se(e,t){if(!R.string(e))return;const i="cache",n=R.string(t);let r=!1;const a=()=>null!==document.getElementById(t),s=(e,t)=>{e.innerHTML=t,n&&a()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!a()){const a=Te.supported,o=document.createElement("div");if(o.setAttribute("hidden",""),n&&o.setAttribute("id",t),a){const e=window.localStorage.getItem(`${i}-${t}`);if(r=null!==e,r){const t=JSON.parse(e);s(o,t.content)}}Ee(e).then((e=>{if(!R.empty(e)){if(a)try{window.localStorage.setItem(`${i}-${t}`,JSON.stringify({content:e}))}catch(e){}s(o,e)}})).catch((()=>{}))}}const ke=e=>Math.trunc(e/60/60%60,10);function Ae(e=0,t=!1,i=!1){if(!R.number(e))return Ae(void 0,t,i);const n=e=>`0${e}`.slice(-2);let r=ke(e);const a=(s=e,Math.trunc(s/60%60,10));var s;const o=(e=>Math.trunc(e%60,10))(e);return r=t||r>0?`${r}:`:"",`${i&&e>0?"-":""}${r}${n(a)}:${n(o)}`}const Ce={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,i=e.host!==t||x.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:i}},findElements(){try{return this.elements.controls=V.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:W.call(this,this.config.selectors.buttons.play),pause:V.call(this,this.config.selectors.buttons.pause),restart:V.call(this,this.config.selectors.buttons.restart),rewind:V.call(this,this.config.selectors.buttons.rewind),fastForward:V.call(this,this.config.selectors.buttons.fastForward),mute:V.call(this,this.config.selectors.buttons.mute),pip:V.call(this,this.config.selectors.buttons.pip),airplay:V.call(this,this.config.selectors.buttons.airplay),settings:V.call(this,this.config.selectors.buttons.settings),captions:V.call(this,this.config.selectors.buttons.captions),fullscreen:V.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=V.call(this,this.config.selectors.progress),this.elements.inputs={seek:V.call(this,this.config.selectors.inputs.seek),volume:V.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:V.call(this,this.config.selectors.display.buffer),currentTime:V.call(this,this.config.selectors.display.currentTime),duration:V.call(this,this.config.selectors.display.duration)},R.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const i="http://www.w3.org/2000/svg",n=Ce.getIconUrl.call(this),r=`${n.cors?"":n.url}#${this.config.iconPrefix}`,a=document.createElementNS(i,"svg");M(a,P(t,{"aria-hidden":"true",focusable:"false"}));const s=document.createElementNS(i,"use"),o=`${r}-${e}`;return"href"in s&&s.setAttributeNS("http://www.w3.org/1999/xlink","href",o),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),a.appendChild(s),a},createLabel(e,t={}){const i=_e.get(e,this.config);return N("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},i)},createBadge(e){if(R.empty(e))return null;const t=N("span",{class:this.config.classNames.menu.value});return t.appendChild(N("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const i=P({},t);let n=function(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=ve(t,"-"," "),t=ve(t,"_"," "),t=ye(t),ve(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}(e);const r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(i).includes(e)&&(r[e]=i[e],delete i[e])})),"button"!==r.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some((e=>e===this.config.classNames.control))||P(i,{class:`${i.class} ${this.config.classNames.control}`}):i.class=this.config.classNames.control,e){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":i.class+=` ${this.config.classNames.control}--overlaid`,n="play",r.label="play",r.icon="play";break;default:R.empty(r.label)&&(r.label=n),R.empty(r.icon)&&(r.icon=e)}const a=N(r.element);return r.toggle?(a.appendChild(Ce.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),a.appendChild(Ce.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),a.appendChild(Ce.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),a.appendChild(Ce.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(a.appendChild(Ce.createIcon.call(this,r.icon)),a.appendChild(Ce.createLabel.call(this,r.label))),P(i,$(this.config.selectors.buttons[n],i)),M(a,i),"play"===n?(R.array(this.elements.buttons[n])||(this.elements.buttons[n]=[]),this.elements.buttons[n].push(a)):this.elements.buttons[n]=a,a},createRange(e,t){const i=N("input",P($(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":_e.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=i,Ce.updateRangeFill.call(this,i),y.setup(i),i},createProgress(e,t){const i=N("progress",P($(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){i.appendChild(N("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],n=t?_e.get(t,this.config):"";i.innerText=`% ${n.toLowerCase()}`}return this.elements.display[e]=i,i},createTime(e,t){const i=$(this.config.selectors.display[e],t),n=N("div",P(i,{class:`${i.class?i.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":_e.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=n,n},bindMenuItemShortcuts(e,t){Z.call(this,e,"keydown keyup",(i=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(i.key))return;if(i.preventDefault(),i.stopPropagation(),"keydown"===i.type)return;const n=K(e,'[role="menuitemradio"]');if(!n&&[" ","ArrowRight"].includes(i.key))Ce.showMenuPanel.call(this,t,!0);else{let t;" "!==i.key&&("ArrowDown"===i.key||n&&"ArrowRight"===i.key?(t=e.nextElementSibling,R.element(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,R.element(t)||(t=e.parentNode.lastElementChild)),Y.call(this,t,!0))}}),!1),Z.call(this,e,"keyup",(e=>{"Return"===e.key&&Ce.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:i,title:n,badge:r=null,checked:a=!1}){const s=$(this.config.selectors.inputs[i]),o=N("button",P(s,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${s.class?s.class:""}`.trim(),"aria-checked":a,value:e})),l=N("span");l.innerHTML=n,R.element(r)&&l.appendChild(r),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter((e=>K(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",(t=>{if(!R.keyboardEvent(t)||" "===t.key){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,i){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}Ce.showMenuPanel.call(this,"home",R.keyboardEvent(t))}}),i,!1),Ce.bindMenuItemShortcuts.call(this,o,i),t.appendChild(o)},formatTime(e=0,t=!1){return R.number(e)?Ae(e,ke(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,i=!1){R.element(e)&&R.number(t)&&(e.innerText=Ce.formatTime(t,i))},updateVolume(){this.supported.ui&&(R.element(this.elements.inputs.volume)&&Ce.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),R.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){R.element(e)&&(e.value=t,Ce.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!R.event(e))return;let t=0;const i=(e,t)=>{const i=R.number(t)?t:0,n=R.element(e)?e:this.elements.display.buffer;if(R.element(n)){n.value=i;const e=n.getElementsByTagName("span")[0];R.element(e)&&(e.childNodes[0].nodeValue=i)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":n=this.currentTime,r=this.duration,t=0===n||0===r||Number.isNaN(n)||Number.isNaN(r)?0:(n/r*100).toFixed(2),"timeupdate"===e.type&&Ce.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":i(this.elements.display.buffer,100*this.buffered)}var n,r},updateRangeFill(e){const t=R.event(e)?e.target:e;if(R.element(t)&&"range"===t.getAttribute("type")){if(K(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=Ce.formatTime(this.currentTime),i=Ce.formatTime(this.duration),n=_e.get("seekLabel",this.config);t.setAttribute("aria-valuetext",n.replace("{currentTime}",e).replace("{duration}",i))}else if(K(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);(x.isWebKit||x.isIPadOS)&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,i;if(!this.config.tooltips.seek||!R.element(this.elements.inputs.seek)||!R.element(this.elements.display.seekTooltip)||0===this.duration)return;const n=this.elements.display.seekTooltip,r=`${this.config.classNames.tooltip}--visible`,a=e=>G(n,r,e);if(this.touch)return void a(!1);let s=0;const o=this.elements.progress.getBoundingClientRect();if(R.event(e))s=100/o.width*(e.pageX-o.left);else{if(!q(n,r))return;s=parseFloat(n.style.left,10)}s<0?s=0:s>100&&(s=100);const l=this.duration/100*s;n.innerText=Ce.formatTime(l);const d=null===(t=this.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(l)));d&&n.insertAdjacentHTML("afterbegin",`${d.label}<br>`),n.style.left=`${s}%`,R.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&a("mouseenter"===e.type)},timeUpdate(e){const t=!R.element(this.elements.display.duration)&&this.config.invertTime;Ce.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Ce.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return H(this.elements.display.currentTime,!0),void H(this.elements.progress,!0);R.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=R.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Ce.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Ce.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ce.setMarkers.call(this),Ce.updateSeekTooltip.call(this)},toggleMenuButton(e,t){H(this.elements.settings.buttons[e],!t)},updateSetting(e,t,i){const n=this.elements.settings.panels[e];let r=null,a=t;if("captions"===e)r=this.currentTrack;else{if(r=R.empty(i)?this[e]:i,R.empty(r)&&(r=this.config[e].default),!R.empty(this.options[e])&&!this.options[e].includes(r))return void this.debug.warn(`Unsupported value of '${r}' for ${e}`);if(!this.config[e].options.includes(r))return void this.debug.warn(`Disabled value of '${r}' for ${e}`)}if(R.element(a)||(a=n&&n.querySelector('[role="menu"]')),!R.element(a))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=Ce.getLabel.call(this,e,r);const s=a&&a.querySelector(`[value="${r}"]`);R.element(s)&&(s.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?_e.get("normal",this.config):`${t}&times;`;case"quality":if(R.number(t)){const e=_e.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return ye(t);case"captions":return De.getLabel.call(this);default:return null}},setQualityMenu(e){if(!R.element(this.elements.settings.panels.quality))return;const t="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');R.array(e)&&(this.options.quality=se(e).filter((e=>this.config.quality.options.includes(e))));const n=!R.empty(this.options.quality)&&this.options.quality.length>1;if(Ce.toggleMenuButton.call(this,t,n),B(i),Ce.checkMenu.call(this),!n)return;const r=e=>{const t=_e.get(`qualityBadge.${e}`,this.config);return t.length?Ce.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const i=this.config.quality.options;return i.indexOf(e)>i.indexOf(t)?1:-1})).forEach((e=>{Ce.createMenuItem.call(this,{value:e,list:i,type:t,title:Ce.getLabel.call(this,"quality",e),badge:r(e)})})),Ce.updateSetting.call(this,t,i)},setCaptionsMenu(){if(!R.element(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=De.getTracks.call(this),n=Boolean(i.length);if(Ce.toggleMenuButton.call(this,e,n),B(t),Ce.checkMenu.call(this),!n)return;const r=i.map(((e,i)=>({value:i,checked:this.captions.toggled&&this.currentTrack===i,title:De.getLabel.call(this,e),badge:e.language&&Ce.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));r.unshift({value:-1,checked:!this.captions.toggled,title:_e.get("disabled",this.config),list:t,type:"language"}),r.forEach(Ce.createMenuItem.bind(this)),Ce.updateSetting.call(this,e,t)},setSpeedMenu(){if(!R.element(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const i=!R.empty(this.options.speed)&&this.options.speed.length>1;Ce.toggleMenuButton.call(this,e,i),B(t),Ce.checkMenu.call(this),i&&(this.options.speed.forEach((i=>{Ce.createMenuItem.call(this,{value:i,list:t,type:e,title:Ce.getLabel.call(this,"speed",i)})})),Ce.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!R.empty(e)&&Object.values(e).some((e=>!e.hidden));H(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let i=e;R.element(i)||(i=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const n=i.querySelector('[role^="menuitem"]');Y.call(this,n,t)},toggleMenu(e){const{popup:t}=this.elements.settings,i=this.elements.buttons.settings;if(!R.element(t)||!R.element(i))return;const{hidden:n}=t;let r=n;if(R.boolean(e))r=e;else if(R.keyboardEvent(e)&&"Escape"===e.key)r=!1;else if(R.event(e)){const n=R.function(e.composedPath)?e.composedPath()[0]:e.target,a=t.contains(n);if(a||!a&&e.target!==i&&r)return}i.setAttribute("aria-expanded",r),H(t,!r),G(this.elements.container,this.config.classNames.menu.open,r),r&&R.keyboardEvent(e)?Ce.focusFirstMenuItem.call(this,null,!0):r||n||Y.call(this,i,R.keyboardEvent(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const i=t.scrollWidth,n=t.scrollHeight;return U(t),{width:i,height:n}},showMenuPanel(e="",t=!1){const i=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!R.element(i))return;const n=i.parentNode,r=Array.from(n.children).find((e=>!e.hidden));if(X.transitions&&!X.reducedMotion){n.style.width=`${r.scrollWidth}px`,n.style.height=`${r.scrollHeight}px`;const e=Ce.getMenuSize.call(this,i),t=e=>{e.target===n&&["width","height"].includes(e.propertyName)&&(n.style.width="",n.style.height="",ee.call(this,n,L,t))};Z.call(this,n,L,t),n.style.width=`${e.width}px`,n.style.height=`${e.height}px`}H(r,!0),H(i,!1),Ce.focusFirstMenuItem.call(this,i,t)},setDownloadUrl(){const e=this.elements.buttons.download;R.element(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:i,createProgress:n,createRange:r,createTime:a,setQualityMenu:s,setSpeedMenu:o,showMenuPanel:l}=Ce;this.elements.controls=null,R.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));const d=N("div",$(this.config.selectors.controls.wrapper));this.elements.controls=d;const u={class:"plyr__controls__item"};return se(R.array(this.config.controls)?this.config.controls:[]).forEach((s=>{if("restart"===s&&d.appendChild(i.call(this,"restart",u)),"rewind"===s&&d.appendChild(i.call(this,"rewind",u)),"play"===s&&d.appendChild(i.call(this,"play",u)),"fast-forward"===s&&d.appendChild(i.call(this,"fast-forward",u)),"progress"===s){const t=N("div",{class:`${u.class} plyr__progress__container`}),i=N("div",$(this.config.selectors.progress));if(i.appendChild(r.call(this,"seek",{id:`plyr-seek-${e.id}`})),i.appendChild(n.call(this,"buffer")),this.config.tooltips.seek){const e=N("span",{class:this.config.classNames.tooltip},"00:00");i.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=i,t.appendChild(this.elements.progress),d.appendChild(t)}if("current-time"===s&&d.appendChild(a.call(this,"currentTime",u)),"duration"===s&&d.appendChild(a.call(this,"duration",u)),"mute"===s||"volume"===s){let{volume:t}=this.elements;if(R.element(t)&&d.contains(t)||(t=N("div",P({},u,{class:`${u.class} plyr__volume`.trim()})),this.elements.volume=t,d.appendChild(t)),"mute"===s&&t.appendChild(i.call(this,"mute")),"volume"===s&&!x.isIos&&!x.isIPadOS){const i={max:1,step:.05,value:this.config.volume};t.appendChild(r.call(this,"volume",P(i,{id:`plyr-volume-${e.id}`})))}}if("captions"===s&&d.appendChild(i.call(this,"captions",u)),"settings"===s&&!R.empty(this.config.settings)){const n=N("div",P({},u,{class:`${u.class} plyr__menu`.trim(),hidden:""}));n.appendChild(i.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const r=N("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),a=N("div"),s=N("div",{id:`plyr-settings-${e.id}-home`}),o=N("div",{role:"menu"});s.appendChild(o),a.appendChild(s),this.elements.settings.panels.home=s,this.config.settings.forEach((i=>{const n=N("button",P($(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,n,i),Z.call(this,n,"click",(()=>{l.call(this,i,!1)}));const r=N("span",null,_e.get(i,this.config)),s=N("span",{class:this.config.classNames.menu.value});s.innerHTML=e[i],r.appendChild(s),n.appendChild(r),o.appendChild(n);const d=N("div",{id:`plyr-settings-${e.id}-${i}`,hidden:""}),u=N("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});u.appendChild(N("span",{"aria-hidden":!0},_e.get(i,this.config))),u.appendChild(N("span",{class:this.config.classNames.hidden},_e.get("menuBack",this.config))),Z.call(this,d,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),Z.call(this,u,"click",(()=>{l.call(this,"home",!1)})),d.appendChild(u),d.appendChild(N("div",{role:"menu"})),a.appendChild(d),this.elements.settings.buttons[i]=n,this.elements.settings.panels[i]=d})),r.appendChild(a),n.appendChild(r),d.appendChild(n),this.elements.settings.popup=r,this.elements.settings.menu=n}if("pip"===s&&X.pip&&d.appendChild(i.call(this,"pip",u)),"airplay"===s&&X.airplay&&d.appendChild(i.call(this,"airplay",u)),"download"===s){const e=P({},u,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!R.url(t)&&this.isEmbed&&P(e,{icon:`logo-${this.provider}`,label:this.provider}),d.appendChild(i.call(this,"download",e))}"fullscreen"===s&&d.appendChild(i.call(this,"fullscreen",u))})),this.isHTML5&&s.call(this,me.getQualityOptions.call(this)),o.call(this),d},inject(){if(this.config.loadSprite){const e=Ce.getIconUrl.call(this);e.cors&&Se(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let i,n=!0;if(R.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),R.element(this.config.controls)||R.string(this.config.controls)?e=this.config.controls:(e=Ce.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:De.getLabel.call(this)}),n=!1),n&&R.string(this.config.controls)&&(e=(e=>{let i=e;return Object.entries(t).forEach((([e,t])=>{i=ve(i,`{${e}}`,t)})),i})(e)),R.string(this.config.selectors.controls.container)&&(i=document.querySelector(this.config.selectors.controls.container)),R.element(i)||(i=this.elements.container),i[R.element(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),R.element(this.elements.controls)||Ce.findElements.call(this),!R.empty(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>q(e,t),set(i=!1){G(e,t,i),e.setAttribute("aria-pressed",i?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{R.array(t)||R.nodeList(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(x.isEdge&&D(i),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,i=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,n=W.call(this,i);Array.from(n).forEach((e=>{G(e,this.config.classNames.hidden,!1),G(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const i=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==i||!i.length)return;const n=document.createDocumentFragment(),r=document.createDocumentFragment();let a=null;const s=`${this.config.classNames.tooltip}--visible`,o=e=>G(a,s,e);i.forEach((e=>{const t=N("span",{class:this.config.classNames.marker},""),i=e.time/this.duration*100+"%";a&&(t.addEventListener("mouseenter",(()=>{e.label||(a.style.left=i,a.innerHTML=e.label,o(!0))})),t.addEventListener("mouseleave",(()=>{o(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=i,r.appendChild(t)})),n.appendChild(r),this.config.tooltips.seek||(a=N("span",{class:this.config.classNames.tooltip},""),n.appendChild(a)),this.elements.markers={points:r,tip:a},this.elements.progress.appendChild(n)}};function Re(e,t=!0){let i=e;if(t){const e=document.createElement("a");e.href=i,i=e.href}try{return new URL(i)}catch(e){return null}}function Le(e){const t=new URLSearchParams;return R.object(e)&&Object.entries(e).forEach((([e,i])=>{t.set(e,i)})),t}const De={setup(){if(!this.supported.ui)return;if(this.isYouTube||this.isHTML5&&!X.textTracks)return void(R.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ce.setCaptionsMenu.call(this));var e,t;if(R.element(this.elements.captions)||(this.elements.captions=N("div",$(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper?this.elements.wrapper:this.elements.controls,R.element(e)&&R.element(t)&&t.parentNode.insertBefore(e,t.nextSibling)),x.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),i=Re(t);null!==i&&i.hostname!==window.location.href.hostname&&["http:","https:"].includes(i.protocol)&&Ee(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{U(e)}))}))}const i=se((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===n&&([n]=i);let r=this.storage.get("captions");if(R.boolean(r)||({active:r}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:r,language:n,languages:i}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";Z.call(this,this.media.textTracks,e,De.update.bind(this))}setTimeout(De.update.bind(this),0)},update(){const e=De.getTracks.call(this,!0),{active:t,language:i,meta:n,currentTrackNode:r}=this.captions,a=Boolean(e.find((e=>e.language===i)));this.isHTML5&&e.filter((e=>!n.get(e))).forEach((e=>{this.debug.log("Track added",e),n.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),Z.call(this,e,"cuechange",(()=>De.updateCues.call(this)))})),(a&&this.language!==i||!e.includes(r))&&(De.setLanguage.call(this,i),De.toggle.call(this,t&&a)),this.elements&&G(this.elements.container,this.config.classNames.captions.enabled,!R.empty(e)),R.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ce.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:i}=this.captions,n=this.config.classNames.captions.active,r=R.nullOrUndefined(e)?!i:e;if(r!==i){if(t||(this.captions.active=r,this.storage.set({captions:r})),!this.language&&r&&!t){const e=De.getTracks.call(this),t=De.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void De.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=r),G(this.elements.container,n,r),this.captions.toggled=r,Ce.updateSetting.call(this,"captions"),ie.call(this,this.media,r?"captionsenabled":"captionsdisabled")}setTimeout((()=>{r&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const i=De.getTracks.call(this);if(-1!==e)if(R.number(e))if(e in i){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const n=i[e],{language:r}=n||{};this.captions.currentTrackNode=n,Ce.updateSetting.call(this,"captions"),t||(this.captions.language=r,this.storage.set({language:r})),this.isVimeo&&this.embed.enableTextTrack(r),ie.call(this,this.media,"languagechange")}De.toggle.call(this,!0,t),this.isHTML5&&De.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else De.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!R.string(e))return void this.debug.warn("Invalid language argument",e);const i=e.toLowerCase();this.captions.language=i;const n=De.getTracks.call(this),r=De.findTrack.call(this,[i]);De.set.call(this,n.indexOf(r),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const i=De.getTracks.call(this),n=e=>Number((this.captions.meta.get(e)||{}).default),r=Array.from(i).sort(((e,t)=>n(t)-n(e)));let a;return e.every((e=>(a=r.find((t=>t.language===e)),!a))),a||(t?r[0]:void 0)},getCurrentTrack(){return De.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!R.track(t)&&X.textTracks&&this.captions.toggled&&(t=De.getCurrentTrack.call(this)),R.track(t)?R.empty(t.label)?R.empty(t.language)?_e.get("enabled",this.config):e.language.toUpperCase():t.label:_e.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!R.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!R.nullOrUndefined(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=De.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(be)}const i=t.map((e=>e.trim())).join("\n");if(i!==this.elements.captions.innerHTML){B(this.elements.captions);const e=N("span",$(this.config.selectors.caption));e.innerHTML=i,this.elements.captions.appendChild(e),ie.call(this,this.media,"cuechange")}}},xe={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Oe="picture-in-picture",Pe={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Ie="video",Me=()=>{};class Ne{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Me}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Me}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Me}}class Fe{constructor(e){t(this,"onChange",(()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;R.element(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;ie.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),t(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",G(this.target,this.player.config.classNames.fullscreen.fallback,e),x.isIos){let t=document.head.querySelector('meta[name="viewport"]');const i="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const n=R.string(t.content)&&t.content.includes(i);e?(this.cleanupViewport=!n,n||(t.content+=`,${i}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==i)).join(","))}this.onChange()})),t(this,"trapFocus",(e=>{if(x.isIos||x.isIPadOS||!this.active||"Tab"!==e.key)return;const t=document.activeElement,i=W.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[n]=i,r=i[i.length-1];t!==r||e.shiftKey?t===n&&e.shiftKey&&(r.focus(),e.preventDefault()):(n.focus(),e.preventDefault())})),t(this,"update",(()=>{if(this.supported){let e;e=this.forceFallback?"Fallback (forced)":Fe.nativeSupported?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");G(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)})),t(this,"enter",(()=>{this.supported&&(x.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Fe.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?R.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),t(this,"exit",(()=>{if(this.supported)if(x.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),ae(this.player.play());else if(!Fe.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!R.empty(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),t(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=e,this.prefix=Fe.prefix,this.property=Fe.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===e.config.fullscreen.fallback,this.player.elements.fullscreen=e.config.fullscreen.container&&function(e,t){const{prototype:i}=Element;return(i.closest||function(){let e=this;do{if(K.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,e.config.fullscreen.container),Z.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),Z.call(this.player,this.player.elements.container,"dblclick",(e=>{R.element(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),Z.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Fe.nativeSupported&&!this.forceFallback}static get prefix(){if(R.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!R.function(document[`${t}ExitFullscreen`])&&!R.function(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Fe.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Fe.nativeSupported||!x.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Fe.nativeSupported||this.forceFallback)return q(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return x.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function Ue(e,t=1){return new Promise(((i,n)=>{const r=new Image,a=()=>{delete r.onload,delete r.onerror,(r.naturalWidth>=t?i:n)(r)};Object.assign(r,{onload:a,onerror:a,src:e})}))}const Be={addStyleHook(){G(this.elements.container,this.config.selectors.container.replace(".",""),!0),G(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Be.toggleNativeControls.call(this,!0);R.element(this.elements.controls)||(Ce.inject.call(this),this.listeners.controls()),Be.toggleNativeControls.call(this),this.isHTML5&&De.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ce.updateVolume.call(this),Ce.timeUpdate.call(this),Ce.durationUpdate.call(this),Be.checkPlaying.call(this),G(this.elements.container,this.config.classNames.pip.supported,X.pip&&this.isHTML5&&this.isVideo),G(this.elements.container,this.config.classNames.airplay.supported,X.airplay&&this.isHTML5),G(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{ie.call(this,this.media,"ready")}),0),Be.setTitle.call(this),this.poster&&Be.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&Ce.durationUpdate.call(this),this.config.mediaMetadata&&Ce.setMediaMetadata.call(this)},setTitle(){let e=_e.get("play",this.config);if(R.string(this.config.title)&&!R.empty(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=V.call(this,"iframe");if(!R.element(e))return;const t=R.empty(this.config.title)?"video":this.config.title,i=_e.get("frameTitle",this.config);e.setAttribute("title",i.replace("{title}",t))}},togglePoster(e){G(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),re.call(this).then((()=>Ue(e))).catch((t=>{throw e===this.poster&&Be.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Be.togglePoster.call(this,!0),e))))},checkPlaying(e){G(this.elements.container,this.config.classNames.playing,this.playing),G(this.elements.container,this.config.classNames.paused,this.paused),G(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",_e.get(this.playing?"pause":"play",this.config))})),R.event(e)&&"timeupdate"===e.type||Be.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{G(this.elements.container,this.config.classNames.loading,this.loading),Be.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const i=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||i))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!R.empty(e)&&R.string(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),R.empty(this.media.style)&&this.media.removeAttribute("style")}};class je{constructor(e){t(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,G(t.container,e.config.classNames.isTouch,!0)})),t(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&J.call(t,window,"keydown keyup",this.handleKey,e,!1),J.call(t,document.body,"click",this.toggleMenu,e),te.call(t,document.body,"touchstart",this.firstTouch)})),t(this,"container",(()=>{const{player:e}=this,{config:t,elements:i,timers:n}=e;!t.keyboard.global&&t.keyboard.focused&&Z.call(e,i.container,"keydown keyup",this.handleKey,!1),Z.call(e,i.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:r}=i;r&&"enterfullscreen"===t.type&&(r.pressed=!1,r.hover=!1);let a=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(Be.toggleControls.call(e,!0),a=e.touch?3e3:2e3),clearTimeout(n.controls),n.controls=setTimeout((()=>Be.toggleControls.call(e,!1)),a)}));const r=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=i.wrapper,{active:n}=e.fullscreen,[r,a]=he.call(e),s=le(`aspect-ratio: ${r} / ${a}`);if(!n)return void(s?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],d=o/l>r/a;s?(t.style.width=d?"auto":"100%",t.style.height=d?"100%":"auto"):(t.style.maxWidth=d?l/a*r+"px":null,t.style.margin=d?"0 auto":null)},a=()=>{clearTimeout(n.resized),n.resized=setTimeout(r,50)};Z.call(e,i.container,"enterfullscreen exitfullscreen",(t=>{const{target:n}=e.fullscreen;n===i.container&&(!e.isEmbed&&R.empty(e.config.ratio)||(r(),("enterfullscreen"===t.type?Z:ee).call(e,window,"resize",a)))}))})),t(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(Z.call(e,e.media,"timeupdate seeking seeked",(t=>Ce.timeUpdate.call(e,t))),Z.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>Ce.durationUpdate.call(e,t))),Z.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),Z.call(e,e.media,"progress playing seeking seeked",(t=>Ce.updateProgress.call(e,t))),Z.call(e,e.media,"volumechange",(t=>Ce.updateVolume.call(e,t))),Z.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>Be.checkPlaying.call(e,t))),Z.call(e,e.media,"waiting canplay seeked playing",(t=>Be.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const i=V.call(e,`.${e.config.classNames.video}`);if(!R.element(i))return;Z.call(e,t.container,"click",(n=>{([t.container,i].includes(n.target)||i.contains(n.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(n,e.restart,"restart"),this.proxy(n,(()=>{ae(e.play())}),"play")):this.proxy(n,(()=>{ae(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&Z.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),Z.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),Z.call(e,e.media,"ratechange",(()=>{Ce.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),Z.call(e,e.media,"qualitychange",(t=>{Ce.updateSetting.call(e,"quality",null,t.detail.quality)})),Z.call(e,e.media,"ready qualitychange",(()=>{Ce.setDownloadUrl.call(e)}));const i=e.config.events.concat(["keyup","keydown"]).join(" ");Z.call(e,e.media,i,(i=>{let{detail:n={}}=i;"error"===i.type&&(n=e.media.error),ie.call(e,t.container,i.type,!0,n)}))})),t(this,"proxy",((e,t,i)=>{const{player:n}=this,r=n.config.listeners[i];let a=!0;R.function(r)&&(a=r.call(n,e)),!1!==a&&R.function(t)&&t.call(n,e)})),t(this,"bind",((e,t,i,n,r=!0)=>{const{player:a}=this,s=a.config.listeners[n],o=R.function(s);Z.call(a,e,t,(e=>this.proxy(e,i,n)),r&&!o)})),t(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,i=x.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{ae(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{ie.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),Ce.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{[" ","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),Ce.toggleMenu.call(e,t)):Ce.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&Ce.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const i=t.progress.getBoundingClientRect(),n=100/i.width*(e.pageX-i.left);e.currentTarget.setAttribute("seek-value",n)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const i=t.currentTarget,n="play-on-seeked";if(R.keyboardEvent(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const r=i.hasAttribute(n),a=["mouseup","touchend","keyup"].includes(t.type);r&&a?(i.removeAttribute(n),ae(e.play())):!a&&e.playing&&(i.setAttribute(n,""),e.pause())})),x.isIos){const t=W.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,i,(e=>D(e.target)))))}this.bind(t.inputs.seek,i,(t=>{const i=t.currentTarget;let n=i.getAttribute("seek-value");R.empty(n)&&(n=i.value),i.removeAttribute("seek-value"),e.currentTime=n/i.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>Ce.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.endScrubbing(t)})),x.isWebKit&&Array.from(W.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>Ce.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!R.element(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,Ce.timeUpdate.call(e))})),this.bind(t.inputs.volume,i,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(i=>{t.controls.hover=!e.touch&&"mouseenter"===i.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((i=>{this.bind(i,"mouseenter mouseleave",(i=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===i.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:i,timers:n}=e;G(t.controls,i.classNames.noTransition,!0),Be.toggleControls.call(e,!0),setTimeout((()=>{G(t.controls,i.classNames.noTransition,!1)}),0);const r=this.touch?3e3:4e3;clearTimeout(n.controls),n.controls=setTimeout((()=>Be.toggleControls.call(e,!1)),r)})),this.bind(t.inputs.volume,"wheel",(t=>{const i=t.webkitDirectionInvertedFromDevice,[n,r]=[t.deltaX,-t.deltaY].map((e=>i?-e:e)),a=Math.sign(Math.abs(n)>Math.abs(r)?n:r);e.increaseVolume(a/50);const{volume:s}=e.media;(1===a&&s<1||-1===a&&s>0)&&t.preventDefault()}),"volume",!1)})),this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:i}=t,{key:n,type:r,altKey:a,ctrlKey:s,metaKey:o,shiftKey:l}=e,d="keydown"===r,u=d&&n===this.lastKey;var c;if(!(a||s||o||l)&&n)if(d){const r=document.activeElement;if(R.element(r)){const{editable:n}=t.config.selectors,{seek:a}=i.inputs;if(r!==a&&K(r,n))return;if(" "===e.key&&K(r,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(n)&&(e.preventDefault(),e.stopPropagation()),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u||(c=parseInt(n,10),t.currentTime=t.duration/10*c);break;case" ":case"k":u||ae(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":u||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":u||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===n&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}toggleMenu(e){Ce.toggleMenu.call(this.player,e)}}var $e=function(e,t){return function(e,t){e.exports=function(){var e=function(){},t={},i={},n={};function r(e,t){e=e.push?e:[e];var r,a,s,o=[],l=e.length,d=l;for(r=function(e,i){i.length&&o.push(e),--d||t(o)};l--;)a=e[l],(s=i[a])?r(a,s):(n[a]=n[a]||[]).push(r)}function a(e,t){if(e){var r=n[e];if(i[e]=t,r)for(;r.length;)r[0](e,t),r.splice(0,1)}}function s(t,i){t.call&&(t={success:t}),i.length?(t.error||e)(i):(t.success||e)(t)}function o(t,i,n,r){var a,s,l=document,d=n.async,u=(n.numRetries||0)+1,c=n.before||e,h=t.replace(/[\?|#].*$/,""),f=t.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(h)?((s=l.createElement("link")).rel="stylesheet",s.href=f,(a="hideFocus"in s)&&s.relList&&(a=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(s=l.createElement("img")).src=f:((s=l.createElement("script")).src=t,s.async=void 0===d||d),s.onload=s.onerror=s.onbeforeload=function(e){var l=e.type[0];if(a)try{s.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((r+=1)<u)return o(t,i,n,r)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";i(t,l,e.defaultPrevented)},!1!==c(t,s)&&l.head.appendChild(s)}function l(e,t,i){var n,r,a=(e=e.push?e:[e]).length,s=a,l=[];for(n=function(e,i,n){if("e"==i&&l.push(e),"b"==i){if(!n)return;l.push(e)}--a||t(l)},r=0;r<s;r++)o(e[r],n,i)}function d(e,i,n){var r,o;if(i&&i.trim&&(r=i),o=(r?n:i)||{},r){if(r in t)throw"LoadJS";t[r]=!0}function d(t,i){l(e,(function(e){s(o,e),t&&s({success:t,error:i},e),a(r,e)}),o)}if(o.returnPromise)return new Promise(d);d()}return d.ready=function(e,t){return r(e,(function(e){s(t,e)})),d},d.done=function(e){a(e,[])},d.reset=function(){t={},i={},n={}},d.isDefined=function(e){return e in t},d}()}(t={exports:{}}),t.exports}();function He(e){return new Promise(((t,i)=>{$e(e,{success:t,error:i})}))}function Ge(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ie.call(this,this.media,e?"play":"pause"))}const qe={setup(){const e=this;"vimeo"===e.provider&&(G(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,fe.call(e),R.object(window.Vimeo)?qe.ready.call(e):He(e.config.urls.vimeo.sdk).then((()=>{qe.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)})))},ready(){const e=this,t=e.config.vimeo,{premium:i,referrerPolicy:n,...r}=t;let a=e.media.getAttribute("src"),s="";R.empty(a)?(a=e.media.getAttribute(e.config.attributes.embed.id),s=e.media.getAttribute(e.config.attributes.embed.hash)):s=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(a);const o=s?{h:s}:{};i&&Object.assign(r,{controls:!1,sidedock:!1});const l=Le({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:e.config.playsinline,...o,...r}),d=(u=a,R.empty(u)?null:R.number(Number(u))?u:u.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:u);var u;const c=N("iframe"),h=ge(e.config.urls.vimeo.iframe,d,l);if(c.setAttribute("src",h),c.setAttribute("allowfullscreen",""),c.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),R.empty(n)||c.setAttribute("referrerPolicy",n),i||!t.customControls)c.setAttribute("data-poster",e.poster),e.media=j(c,e.media);else{const t=N("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(c),e.media=j(t,e.media)}t.customControls||Ee(ge(e.config.urls.vimeo.api,h)).then((t=>{!R.empty(t)&&t.thumbnail_url&&Be.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(c,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(Ge.call(e,!0),e.embed.play()),e.media.pause=()=>(Ge.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:f}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>f,set(t){const{embed:i,media:n,paused:r,volume:a}=e,s=r&&!i.hasPlayed;n.seeking=!0,ie.call(e,n,"seeking"),Promise.resolve(s&&i.setVolume(0)).then((()=>i.setCurrentTime(t))).then((()=>s&&i.pause())).then((()=>s&&i.setVolume(a))).catch((()=>{}))}});let p=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>p,set(t){e.embed.setPlaybackRate(t).then((()=>{p=t,ie.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,ie.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const i=!!R.boolean(t)&&t;e.embed.setMuted(!!i||e.config.muted).then((()=>{g=i,ie.call(e,e.media,"volumechange")}))}});let v,{loop:y}=e.config;Object.defineProperty(e.media,"loop",{get:()=>y,set(t){const i=R.boolean(t)?t:e.config.loop.active;e.embed.setLoop(i).then((()=>{y=i}))}}),e.embed.getVideoUrl().then((t=>{v=t,Ce.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>v}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[i,n]=t;e.embed.ratio=pe(i,n),fe.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,Be.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{f=t,ie.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,ie.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,De.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const i=t.map((e=>function(e){const t=document.createDocumentFragment(),i=document.createElement("div");return t.appendChild(i),i.innerHTML=e,t.firstChild.innerText}(e.text)));De.updateCues.call(e,i)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{Ge.call(e,!t),t||ie.call(e,e.media,"playing")})),R.element(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{ie.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{ie.call(e,e.media,"playing")})),e.embed.on("play",(()=>{Ge.call(e,!0),ie.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{Ge.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,f=t.seconds,ie.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,ie.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&ie.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,ie.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,ie.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,ie.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,ie.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>Be.build.call(e)),0)}};function Ke(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ie.call(this,this.media,e?"play":"pause"))}function We(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const Ve={setup(){if(G(this.elements.wrapper,this.config.classNames.embed,!0),R.object(window.YT)&&R.function(window.YT.Player))Ve.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{R.function(e)&&e(),Ve.ready.call(this)},He(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Ee(ge(this.config.urls.youtube.api,e)).then((e=>{if(R.object(e)){const{title:t,height:i,width:n}=e;this.config.title=t,Be.setTitle.call(this),this.embed.ratio=pe(n,i)}fe.call(this)})).catch((()=>{fe.call(this)}))},ready(){const e=this;if("youtube"!==e.provider)return;const t=e.config.youtube,i=e.media&&e.media.getAttribute("id");if(!R.empty(i)&&i.startsWith("youtube-"))return;let n=e.media.getAttribute("src");R.empty(n)&&(n=e.media.getAttribute(this.config.attributes.embed.id));const r=(a=n,R.empty(a)?null:a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:a);var a;const s=N("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=j(s,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${r}/${e}default.jpg`;Ue(t("maxres"),121).catch((()=>Ue(t("sd"),121))).catch((()=>Ue(t("hq")))).then((t=>Be.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:r,host:We(t),playerVars:P({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.playsinline&&!e.config.fullscreen.iosNative?1:0,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const i=t.data,n={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[i]||"An unknown error occurred";e.media.error={code:i,message:n},ie.call(e,e.media,"error")}},onPlaybackRateChange(t){const i=t.target;e.media.playbackRate=i.getPlaybackRate(),ie.call(e,e.media,"ratechange")},onReady(i){if(R.function(e.media.play))return;const n=i.target;Ve.getTitle.call(e,r),e.media.play=()=>{Ke.call(e,!0),n.playVideo()},e.media.pause=()=>{Ke.call(e,!1),n.pauseVideo()},e.media.stop=()=>{n.stopVideo()},e.media.duration=n.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(n.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,ie.call(e,e.media,"seeking"),n.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>n.getPlaybackRate(),set(e){n.setPlaybackRate(e)}});let{volume:a}=e.config;Object.defineProperty(e.media,"volume",{get:()=>a,set(t){a=t,n.setVolume(100*a),ie.call(e,e.media,"volumechange")}});let{muted:s}=e.config;Object.defineProperty(e.media,"muted",{get:()=>s,set(t){const i=R.boolean(t)?t:s;s=i,n[i?"mute":"unMute"](),n.setVolume(100*a),ie.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>n.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const o=n.getAvailablePlaybackRates();e.options.speed=o.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),ie.call(e,e.media,"timeupdate"),ie.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=n.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&ie.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),ie.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>Be.build.call(e)),50)},onStateChange(i){const n=i.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(i.data)&&(e.media.seeking=!1,ie.call(e,e.media,"seeked")),i.data){case-1:ie.call(e,e.media,"timeupdate"),e.media.buffered=n.getVideoLoadedFraction(),ie.call(e,e.media,"progress");break;case 0:Ke.call(e,!1),e.media.loop?(n.stopVideo(),n.playVideo()):ie.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(Ke.call(e,!0),ie.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{ie.call(e,e.media,"timeupdate")}),50),e.media.duration!==n.getDuration()&&(e.media.duration=n.getDuration(),ie.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),Ke.call(e,!1);break;case 3:ie.call(e,e.media,"waiting")}ie.call(e,e.elements.container,"statechange",!1,{code:i.data})}}})}},Ye={setup(){this.media?(G(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),G(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&G(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=N("div",{class:this.config.classNames.video}),I(this.media,this.elements.wrapper),this.elements.poster=N("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?(me.setup.call(this),window.Plyr.source=et):this.isYouTube?Ve.setup.call(this):this.isVimeo?qe.setup.call(this):""!==this.provider&&(window.Plyr.ui=Be,window[this.provider].setup.call(this))):this.debug.warn("No media element found!")}};class ze{constructor(e){t(this,"load",(()=>{this.enabled&&(R.object(window.google)&&R.object(window.google.ima)?this.ready():He(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),t(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),t(this,"setupIMA",(()=>{this.elements.container=N("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),t(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),t(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=Ae(Math.max(this.manager.getRemainingTime(),0)),t=`${_e.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),t(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),t(this,"addCuePoints",(()=>{R.empty(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(R.element(t)){const i=100/this.player.duration*e,n=N("span",{class:this.player.config.classNames.cues});n.style.left=`${i.toString()}%`,t.appendChild(n)}}}))})),t(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,i=e.getAd(),n=e.getAdData();switch((e=>{ie.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=t.offsetWidth,i.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:n.adError&&this.player.debug.warn(`Non-fatal ad error: ${n.adError.getMessage()}`)}})),t(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),t(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;R.empty(this.cuePoints)||this.cuePoints.forEach(((i,n)=>{t<i&&i<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(n,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),t(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),t(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,ae(this.player.media.play())})),t(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),t(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),t(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),t(this,"trigger",((e,...t)=>{const i=this.events[e];R.array(i)&&i.forEach((e=>{R.function(e)&&e.apply(this,t)}))})),t(this,"on",((e,t)=>(R.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),t(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),t(this,"clearSafetyTimer",(e=>{R.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&e.enabled&&(!R.empty(e.publisherId)||R.url(e.tagUrl))}get tagUrl(){const{config:e}=this;return R.url(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${Le({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function Xe(e=0,t=0,i=255){return Math.min(Math.max(e,t),i)}const Qe=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const i={};e.split(/\r\n|\n|\r/).forEach((e=>{if(R.number(i.startTime)){if(!R.empty(e.trim())&&R.empty(i.text)){const t=e.trim().split("#xywh=");[i.text]=t,t[1]&&([i.x,i.y,i.w,i.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(i.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),i.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),i.text&&t.push(i)})),t},Je=(e,t)=>{const i={};return e>t.width/t.height?(i.width=t.width,i.height=1/e*t.width):(i.height=t.height,i.width=e*t.height),i};class Ze{constructor(e){t(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)}))})),t(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(R.empty(t))throw new Error("Missing previewThumbnails.src config attribute");const i=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(R.function(t))t((e=>{this.thumbnails=e,i()}));else{const e=(R.string(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(i)}})))),t(this,"getThumbnail",(e=>new Promise((t=>{Ee(e).then((i=>{const n={frames:Qe(i),height:null,urlPrefix:""};n.frames[0].text.startsWith("/")||n.frames[0].text.startsWith("http://")||n.frames[0].text.startsWith("https://")||(n.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const r=new Image;r.onload=()=>{n.height=r.naturalHeight,n.width=r.naturalWidth,this.thumbnails.push(n),t()},r.src=n.urlPrefix+n.frames[0].text}))})))),t(this,"startMove",(e=>{if(this.loaded&&R.event(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,i;const n=this.player.elements.progress.getBoundingClientRect(),r=100/n.width*(e.pageX-n.left);this.seekTime=this.player.media.duration*(r/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=Ae(this.seekTime);const a=null===(t=this.player.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(this.seekTime)));a&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${a.label}<br>`)}this.showImageAtCurrentTime()}})),t(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),t(this,"startScrubbing",(e=>{(R.nullOrUndefined(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),t(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):te.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),t(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),t(this,"render",(()=>{this.elements.thumb.container=N("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=N("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=N("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=N("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),R.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=N("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),t(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),t(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let i=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,n)=>{this.loadedImages.includes(t.frames[e].text)&&(i=n)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(i)))})),t(this,"loadImage",((e=0)=>{const t=this.showingThumb,i=this.thumbnails[e],{urlPrefix:n}=i,r=i.frames[t],a=i.frames[t].text,s=n+a;if(this.currentImageElement&&this.currentImageElement.dataset.filename===a)this.showImage(this.currentImageElement,r,e,t,a,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const i=new Image;i.src=s,i.dataset.index=t,i.dataset.filename=a,this.showingThumbFilename=a,this.player.debug.log(`Loading image: ${s}`),i.onload=()=>this.showImage(i,r,e,t,a,!0),this.loadingImage=i,this.removeOldImages(i)}})),t(this,"showImage",((e,t,i,n,r,a=!0)=>{this.player.debug.log(`Showing thumb: ${r}. num: ${n}. qual: ${i}. newimg: ${a}`),this.setImageSizeAndOffset(e,t),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(r)||this.loadedImages.push(r)),this.preloadNearby(n,!0).then(this.preloadNearby(n,!1)).then(this.getHigherQuality(i,e,t,r))})),t(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const i=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),i)}}))})),t(this,"preloadNearby",((e,t=!0)=>new Promise((i=>{setTimeout((()=>{const n=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===n){let r;r=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let a=!1;r.forEach((e=>{const t=e.text;if(t!==n&&!this.loadedImages.includes(t)){a=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],n=e+t,r=new Image;r.src=n,r.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),i()}}})),a||i()}}),300)})))),t(this,"getHigherQuality",((e,t,i,n)=>{if(e<this.thumbnails.length-1){let r=t.naturalHeight;this.usingSprites&&(r=i.h),r<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===n&&(this.player.debug.log(`Showing higher quality thumb for: ${n}`),this.loadImage(e+1))}),300)}})),t(this,"toggleThumbContainer",((e=!1,t=!1)=>{const i=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(i,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),t(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),t(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:i}=this.elements.thumb,n=t.left-e.left+10,r=t.right-e.left-i.clientWidth-10,a=this.mousePosX-e.left-i.clientWidth/2,s=Xe(a,n,r);i.style.left=`${s}px`,i.style.setProperty("--preview-arrow-offset",a-s+"px")})),t(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=Je(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),t(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const i=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*i+"px",e.style.width=e.naturalWidth*i+"px",e.style.left=`-${t.x*i}px`,e.style.top=`-${t.y*i}px`})),this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=Je(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const et={insertElements(e,t){R.string(t)?F(e,this.media,{src:t}):R.array(t)&&t.forEach((t=>{F(e,this.media,t)}))},change(e){O(e,"sources.length")?(me.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],U(this.media),this.media=null,R.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:i}=e,[{provider:n=Pe.html5,src:r}]=t,a="html5"===n?i:"div",s="html5"===n?{}:{src:r};Object.assign(this,{provider:n,type:i,supported:X.check(i,n,this.config.playsinline),media:N(a,s)}),this.elements.container.appendChild(this.media),R.boolean(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),R.empty(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Be.addStyleHook.call(this),this.isHTML5&&et.insertElements.call(this,"source",t),this.config.title=e.title,Ye.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&et.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Be.build.call(this),this.isHTML5&&this.media.load(),R.empty(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Ze(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class tt{constructor(e,i){if(t(this,"play",(()=>R.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>ae(this.media.play()))),this.media.play()):null)),t(this,"pause",(()=>this.playing&&R.function(this.media.pause)?this.media.pause():null)),t(this,"togglePlay",(e=>(R.boolean(e)?e:!this.playing)?this.play():this.pause())),t(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):R.function(this.media.stop)&&this.media.stop()})),t(this,"restart",(()=>{this.currentTime=0})),t(this,"rewind",(e=>{this.currentTime-=R.number(e)?e:this.config.seekTime})),t(this,"forward",(e=>{this.currentTime+=R.number(e)?e:this.config.seekTime})),t(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(R.number(e)?e:0)})),t(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),t(this,"airplay",(()=>{X.airplay&&this.media.webkitShowPlaybackTargetPicker()})),t(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=q(this.elements.container,this.config.classNames.hideControls),i=void 0===e?void 0:!e,n=G(this.elements.container,this.config.classNames.hideControls,i);if(n&&R.array(this.config.controls)&&this.config.controls.includes("settings")&&!R.empty(this.config.settings)&&Ce.toggleMenu.call(this,!1),n!==t){const e=n?"controlshidden":"controlsshown";ie.call(this,this.media,e)}return!n}return!1})),t(this,"on",((e,t)=>{Z.call(this,this.elements.container,e,t)})),t(this,"once",((e,t)=>{te.call(this,this.elements.container,e,t)})),t(this,"off",((e,t)=>{ee(this.elements.container,e,t)})),t(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const i=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(U(this.elements.buttons.play),U(this.elements.captions),U(this.elements.controls),U(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),R.function(e)&&e()):(ne.call(this),me.cancelRequests.call(this),j(this.elements.original,this.elements.container),ie.call(this,this.elements.original,"destroyed",!0),R.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Be.toggleNativeControls.call(this,!0),i()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&R.function(this.embed.destroy)&&this.embed.destroy(),i()):this.isVimeo?(null!==this.embed&&this.embed.unload().then(i),setTimeout(i,200)):i()})),t(this,"supports",(e=>X.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=X.touch,this.media=e,R.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||R.nodeList(this.media)||R.array(this.media))&&(this.media=this.media[0]),this.config=P({},xe,tt.defaults,i||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Ne(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",X),R.nullOrUndefined(this.media)||!R.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!X.check().api)return void this.debug.error("Setup failed: no support");const n=this.media.cloneNode(!0);n.autoplay=!1,this.elements.original=n;const r=this.media.tagName.toLowerCase();let a=null,s=null;switch(r){case"div":if(a=this.media.querySelector("iframe"),R.element(a)){if(s=Re(a.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Pe.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Pe.vimeo:null}(s.toString()),this.elements.container=this.media,this.media=a,this.elements.container.className="",s.search.length){const e=["1","true"];e.includes(s.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(s.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(s.searchParams.get("playsinline")),this.config.youtube.hl=s.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(R.empty(this.provider)||!Object.values(Pe).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ie;break;case"video":case"audio":this.type=r,this.provider=Pe.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=X.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new je(this),this.storage=new Te(this),this.media.plyr=this,R.element(this.elements.container)||(this.elements.container=N("div"),I(this.media,this.elements.container)),Be.migrateStyles.call(this),Be.addStyleHook.call(this),Ye.setup.call(this),this.config.debug&&Z.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new Fe(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Be.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new ze(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>ae(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Ze(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Pe.html5}get isEmbed(){return this.isYouTube||this.isVimeo||this.provider!==Pe.html5}get isYouTube(){return this.provider===Pe.youtube}get isVimeo(){return this.provider===Pe.vimeo}get isVideo(){return this.type===Ie}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=R.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return R.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,i=R.number(t)&&t!==1/0?t:0;return e||i}set volume(e){let t=e;R.string(t)&&(t=Number(t)),R.number(t)||(t=this.storage.get("volume")),R.number(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!R.empty(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;R.boolean(t)||(t=this.storage.get("muted")),R.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;R.number(e)&&(t=e),R.number(t)||(t=this.storage.get("speed")),R.number(t)||(t=this.config.speed.selected);const{minimumSpeed:i,maximumSpeed:n}=this;t=Xe(t,i,n),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,i=this.options.quality;if(!i.length)return;let n=[!R.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(R.number),r=!0;if(!i.includes(n)){const e=oe(i,n);this.debug.warn(`Unsupported quality option: ${n}, using ${e} instead`),n=e,r=!1}t.selected=n,this.media.quality=n,r&&this.storage.set({quality:n})}get quality(){return this.media.quality}set loop(e){const t=R.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){et.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return R.url(e)?e:this.source}set download(e){R.url(e)&&(this.config.urls.download=e,Ce.setDownloadUrl.call(this))}set poster(e){this.isVideo?Be.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=ce(he.call(this));return R.array(e)?e.join(":"):e}set ratio(e){this.isVideo?R.string(e)&&ue(e)?(this.config.ratio=ce(e),fe.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=R.boolean(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){De.toggle.call(this,e,!1)}set currentTrack(e){De.set.call(this,e,!1),De.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){De.setLanguage.call(this,e,!1)}get language(){return(De.getCurrentTrack.call(this)||{}).language}set pip(e){if(!X.pip)return;const t=R.boolean(e)?e:!this.pip;R.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?Oe:"inline"),R.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return X.pip?R.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Oe:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Ze(this))}static supported(e,t){return X.check(e,t)}static loadSprite(e,t){return Se(e,t)}static setup(e,t={}){let i=null;return R.string(e)?i=Array.from(document.querySelectorAll(e)):R.nodeList(e)?i=Array.from(e):R.array(e)&&(i=e.filter(R.element)),R.empty(i)?null:i.map((e=>new tt(e,t)))}}var it;return tt.defaults=(it=xe,JSON.parse(JSON.stringify(it))),tt})),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DetectBPM=e()}((function(){return function e(t,i,n){function r(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[s]={exports:{}};t[s][0].call(u.exports,(function(e){return r(t[s][1][e]||e)}),u,u.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){var t=function(e){var t=e.length,i=e.numberOfChannels,r=e.sampleRate,a=new n(i,t,r),s=a.createBufferSource();s.buffer=e;var o=a.createBiquadFilter();return o.type="lowpass",s.connect(o),o.connect(a.destination),s}(e);return t.start(0),[a,o,l(e.sampleRate),r].reduce((function(e,t){return t(e)}),t.buffer.getChannelData(0))};var n=window.OfflineAudioContext||window.webkitOfflineAudioContext;function r(e){return e.sort((function(e,t){return t.count-e.count})).splice(0,5)[0].tempo}function a(e){for(var t=[],i=.9;t.length<15&&i>=.01;)t=s(e,i),i-=.005;if(t.length<15)throw new Error("Could not find enough samples for a reliable detection.");return t}function s(e,t){for(var i=[],n=0,r=e.length;n<r;n+=1)e[n]>t&&(i.push(n),n+=100);return i}function o(e){var t=[];return e.forEach((function(i,n){for(var r=function(r){var a=e[n+r]-i;t.some((function(e){if(e.interval===a)return e.count+=1}))||t.push({interval:a,count:1})},a=0;a<10;a+=1)r(a)})),t}function l(e){return function(t){var i=[];return t.forEach((function(t){if(0!==t.interval){for(var n=60/(t.interval/e);n<90;)n*=2;for(;n>180;)n/=2;n=Math.round(n),i.some((function(e){if(e.tempo===n)return e.count+=t.count}))||i.push({tempo:n,count:t.count})}})),i}}},{}],2:[function(e,t,i){t.exports=e("./detect").default},{"./detect":1}]},{},[2])(2)})),window.Waveform={},function(e){"use strict";Waveform=function(e){this.data=[],this.peaks=[],this.wrap=null,this.progress=null,this.wave=null,this.waveme=null,this.percent=0,this.options=this._extends({},this._options,e),"string"==typeof this.options.duration&&this.options.duration.indexOf(":")>-1&&(this.options.duration=this.timeToMS(this.options.duration)),this.init()},Waveform.prototype={_options:{id:Math.random().toString(32).substring(2),rtl:"rtl"==getComputedStyle(document.body).direction,barSpacing:1,barWidth:2,barHeight:50,padding:20,barRadius:0,waveLength:180,sampleLength:1800,color:"rgba(160,160,160,0.4)",progressColor:!1,cursorColor:"currentColor",width:300,height:40,duration:0,align:"bottom"},_extends:function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},init:function(){var t=this;t.container="string"==typeof t.options.container?document.querySelector(t.options.container):t.options.container,t.container&&(t.wrap=e('<div class="waveform_wrap" data-id="'+t.options.id+'" style="position:relative;"></div>'),t.wrap.css("height",t.options.height+"px"),t.progress=e('<div class="waveform_progress" style="position:absolute;width:0;height:100%;overflow:hidden;border-right:0.5px solid transparent">'),t.wave=t.createWave(),t.wrap.append(t.wave).appendTo(t.container),t.waveme=t.createWave(),t.progress.append(t.waveme).appendTo(t.wrap),t.wrap.append('<span class="waveform-time" style="position:absolute;height:100%;width:100%;display:flex;align-items:'+t.getAlign()+'"><span class="waveform-elapsed"></span><span class="waveform-duration"></span></span>'),t.wrap.find(".waveform-duration").html(t.msToTime(t.options.duration)),t.initEvents())},createWave:function(){var e=document.createElement("canvas");return e.style.position="absolute",e.style.height="100%",e.width=2*this.options.width,e.height=2*this.options.height,e},clearWave:function(){var e=this.wave.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height);var t=this.waveme.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)},drawWave:function(){if(0!=this.data.length&&this.container){this.options.width=parseInt(this.wrap.width()),this.wave.width=this.waveme.width=2*this.options.width,this.wave.style.width=this.waveme.style.width=this.options.width+"px",this.clearWave(),this.prepareData();var t=this.options.progressColor?this.options.progressColor:e(this.container).css("borderTopColor");this.draw(this.wave.getContext("2d")),this.draw(this.waveme.getContext("2d"),t)}},draw:function(e,t,i){var n=this.peaks,r=n.length,a=this.wave.height,s=Math.round(r*(i||1)),o=0,l=0,d=0,u=2*this.options.barWidth;e.fillStyle=t||this.options.color;for(var c=0;c<s;c++){switch(o=c*(2*this.options.barSpacing+u),this.options.rtl&&(o=2*this.options.width-o),d=n[c],this.options.align){case"top":l=0;break;case"middle":l=Math.ceil((a-n[c])/2);break;case"center":e.setTransform(1,0,0,1,this.wave.width/2,this.wave.height/2),e.rotate(2*c*Math.PI/r-Math.PI/2),e.translate(0,(this.wave.height-2*this.options.barHeight)/2),o=-this.options.barWidth/2,l=0;break;default:l=a-n[c]}e.save(),this.options.barRadius>0?this.drawRoundRect(e,o,l,u,d,this.options.barRadius):e.fillRect(o,l,u,d),e.restore()}},drawRoundRect:function(e,t,i,n,r,a){0!==r&&(e.beginPath(),e.moveTo(t+a,i),e.lineTo(t+n-a,i),e.quadraticCurveTo(t+n,i,t+n,i+a),e.lineTo(t+n,i+r-a),e.quadraticCurveTo(t+n,i+r,t+n-a,i+r),e.lineTo(t+a.bl,i+r),e.quadraticCurveTo(t,i+r,t,i+r-a),e.lineTo(t,i+a),e.quadraticCurveTo(t,i,t+a,i),e.closePath(),e.fill())},prepareData:function(){var e=this.options.width,t=2*this.options.height-this.options.padding;"center"==this.options.align&&(e=(this.options.height-2*this.options.barHeight)*Math.PI,t=this.options.barHeight);var i=Math.max.apply(null,this.data)/t;this.peaks=this.data.map((function(e){return Math.round((0==e?.5:e)/i)}));var n=Math.round(e/(this.options.barWidth+this.options.barSpacing));this.peaks=this.resizeData(this.peaks,n)},resizeData:function(e,t){var i=e.length-t,n=(e.length-1)/t,r=[],a=0,s=0;if(0==i)return e;for(var o=0;o<t;o++)if(a=Math.round(o*n),i<0)s=s==a?0:a,r[o]=s>0?r[o-1]+Math.round((e[a]-e[a-1])*n):e[a];else{for(var l=0,d=0;d<Math.round(n);d++){var u=e[a+d];u>l&&(l=u)}r[o]=l}return r},initEvents:function(){var t,i=this;window.addEventListener("resize",(function(){clearTimeout(t),t=setTimeout((function(){i.options.width=i.wrap.width(),i.drawWave()}),500)})),this.wrap.on("click",(function(e){var t=i.getPercent(e);i.wrap.trigger("update",[t,i.options.id])})),this.wrap.on("timeupdate",(function(e,t,n){i.update(t,n)})),e(document).trigger("waveform:ready",[this])},update:function(e,t){var i=this,n=.5;i.updateTime(e),i.progress.css("width",100*e+"%"),i.progress.css("border-right-color",0==e?"transparent":i.options.cursorColor),(Math.abs(e-i.percent)>.02||0==e||t)&&(n=.1),e>.99&&(n=.2),1==e&&setTimeout((function(){i.update(0)}),200),i.progress.css("transition","width "+n+"s linear"),i.percent=e},drawTime:function(){this.wrap.find(".waveform-duration").html(this.msToTime(this.options.duration)),this.updateTime(0)},updateTime:function(e){var t=this.options.duration*e,i=this.msToTime(t);this.wrap.find(".waveform-elapsed").html(i)},load:function(t){var i=this;i.container&&e(i.container).parent().removeClass("loaded"),"string"!=typeof t?(i.data=t,setTimeout((function(){i.drawWave()}),100),i.drawTime(),i.container&&e(i.container).parent().addClass("loaded")):this.loadAudioData(t)},loadAudioData:function(e,t){var i=this,n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(n.response,(function(e){i.options.duration=1e3*e.duration,i.data=e.data=i.parsePeaks(e);try{e.bpm=DetectBPM(e)}catch(e){}i.container&&i.load(i.data),t&&t(e)}))},n.send()},parsePeaks:function(e){for(var t=this.options.sampleLength,i=e.length/t,n=~~(i/10)||1,r=e.numberOfChannels,a=[],s=!0,o=0;o<r;o++)for(var l=e.getChannelData(o),d=0;d<t;d++){for(var u=~~(d*i),c=~~(u+i),h=0,f=u;f<c;f+=n){var p=Math.abs(l[f]);p>h&&(h=p)}(0==o||h>a[d])&&(a[d]=Math.round(100*h),h>0&&(s=!1))}return s?[]:this.resizeData(a,this.options.waveLength)},msToTime:function(e,t){if(""==e&&0!=e)return"";var i=parseInt(e%1e3),n=parseInt(e/1e3%60),r=parseInt(e/6e4%60),a=parseInt(e/36e5%24);n=n<10?"0"+n:n,r=r<10?"0"+r:r;var s="";return t&&(s=":"+(i<10?"00"+i:i<100?"0"+i:i)),""!=a?(a=a<10?"0"+a:a)+":"+r+":"+n+s:r+":"+n+s},timeToMS:function(e){var t=e.match(/[0-9]+[HMS]/g);if(t){var i=0;return t.forEach((function(e){var t=e.charAt(e.length-1),n=parseInt(e.slice(0,-1));switch(t){case"H":i+=60*n*60;break;case"M":i+=60*n;break;case"S":i+=n}})),1e3*i}var n=e.split(":");return 1==n.length?1e3*Number(n[0]):2==n.length?60*Number(n[0])*1e3+1e3*Number(n[1]):60*Number(n[0])*60*1e3+60*Number(n[1])*1e3+1e3*Number(n[2])},getAlign:function(){var e="flex-end";switch(this.options.align){case"top":e="flex-start";break;case"middle":e="center"}return e},getPercent:function(e){var t=this,i=0,n=t.wrap[0].getBoundingClientRect(),r=e.targetTouches?e.targetTouches[0].clientX:e.clientX,a=r-n.left;if(t.options.rtl&&(a=t.options.width-a),i=(a/t.options.width).toFixed(6),"center"==t.options.align){var s=(e.targetTouches?e.targetTouches[0].clientY:e.clientY)-n.top,o=r-n.left,l=s-t.options.height/4,d=o-t.options.width/2,u=Math.atan2(l,d);(u*=180/Math.PI)<0&&(u=360+u),i=(u/360).toFixed(6)}return i<0&&(i=0),i>1&&(i=1),i}}}(jQuery),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Popper=t()}(this,(function(){"use strict";function e(e){return e&&"[object Function]"==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function i(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function n(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var r=t(e),a=r.overflow,s=r.overflowX,o=r.overflowY;return/(auto|scroll|overlay)/.test(a+o+s)?e:n(i(e))}function r(e){return e&&e.referenceNode?e.referenceNode:e}function a(e){return 11===e?X:10===e?Q:X||Q}function s(e){if(!e)return document.documentElement;for(var i=a(10)?document.body:null,n=e.offsetParent||null;n===i&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===t(n,"position")?s(n):n:e?e.ownerDocument.documentElement:document.documentElement}function o(e){return null===e.parentNode?e:o(e.parentNode)}function l(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=i?e:t,r=i?t:e,a=document.createRange();a.setStart(n,0),a.setEnd(r,0);var d=a.commonAncestorContainer;if(e!==d&&t!==d||n.contains(r))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||s(e.firstElementChild)===e)}(d)?d:s(d);var u=o(e);return u.host?l(u.host,t):l(e,o(t).host)}function d(e){var t="top"===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",i=e.nodeName;if("BODY"===i||"HTML"===i){var n=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||n)[t]}return e[t]}function u(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=d(t,"top"),r=d(t,"left"),a=i?-1:1;return e.top+=n*a,e.bottom+=n*a,e.left+=r*a,e.right+=r*a,e}function c(e,t){var i="x"===t?"Left":"Top",n="Left"==i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"])+parseFloat(e["border"+n+"Width"])}function h(e,t,i,n){return W(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],a(10)?parseInt(i["offset"+e])+parseInt(n["margin"+("Height"===e?"Top":"Left")])+parseInt(n["margin"+("Height"===e?"Bottom":"Right")]):0)}function f(e){var t=e.body,i=e.documentElement,n=a(10)&&getComputedStyle(i);return{height:h("Height",t,i,n),width:h("Width",t,i,n)}}function p(e){return ee({},e,{right:e.left+e.width,bottom:e.top+e.height})}function m(e){var i={};try{if(a(10)){i=e.getBoundingClientRect();var n=d(e,"top"),r=d(e,"left");i.top+=n,i.left+=r,i.bottom+=n,i.right+=r}else i=e.getBoundingClientRect()}catch(e){}var s={left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top},o="HTML"===e.nodeName?f(e.ownerDocument):{},l=o.width||e.clientWidth||s.width,u=o.height||e.clientHeight||s.height,h=e.offsetWidth-l,m=e.offsetHeight-u;if(h||m){var g=t(e);h-=c(g,"x"),m-=c(g,"y"),s.width-=h,s.height-=m}return p(s)}function g(e,i){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=a(10),o="HTML"===i.nodeName,l=m(e),d=m(i),c=n(e),h=t(i),f=parseFloat(h.borderTopWidth),g=parseFloat(h.borderLeftWidth);r&&o&&(d.top=W(d.top,0),d.left=W(d.left,0));var v=p({top:l.top-d.top-f,left:l.left-d.left-g,width:l.width,height:l.height});if(v.marginTop=0,v.marginLeft=0,!s&&o){var y=parseFloat(h.marginTop),b=parseFloat(h.marginLeft);v.top-=f-y,v.bottom-=f-y,v.left-=g-b,v.right-=g-b,v.marginTop=y,v.marginLeft=b}return(s&&!r?i.contains(c):i===c&&"BODY"!==c.nodeName)&&(v=u(v,i)),v}function v(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,n=g(e,i),r=W(i.clientWidth,window.innerWidth||0),a=W(i.clientHeight,window.innerHeight||0),s=t?0:d(i),o=t?0:d(i,"left");return p({top:s-n.top+n.marginTop,left:o-n.left+n.marginLeft,width:r,height:a})}function y(e){var n=e.nodeName;if("BODY"===n||"HTML"===n)return!1;if("fixed"===t(e,"position"))return!0;var r=i(e);return!!r&&y(r)}function b(e){if(!e||!e.parentElement||a())return document.documentElement;for(var i=e.parentElement;i&&"none"===t(i,"transform");)i=i.parentElement;return i||document.documentElement}function w(e,t,a,s){var o=4<arguments.length&&void 0!==arguments[4]&&arguments[4],d={top:0,left:0},u=o?b(e):l(e,r(t));if("viewport"===s)d=v(u,o);else{var c;"scrollParent"===s?"BODY"===(c=n(i(t))).nodeName&&(c=e.ownerDocument.documentElement):c="window"===s?e.ownerDocument.documentElement:s;var h=g(c,u,o);if("HTML"!==c.nodeName||y(u))d=h;else{var p=f(e.ownerDocument),m=p.height,w=p.width;d.top+=h.top-h.marginTop,d.bottom=m+h.top,d.left+=h.left-h.marginLeft,d.right=w+h.left}}var _="number"==typeof(a=a||0);return d.left+=_?a:a.left||0,d.top+=_?a:a.top||0,d.right-=_?a:a.right||0,d.bottom-=_?a:a.bottom||0,d}function _(e){return e.width*e.height}function T(e,t,i,n,r){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=w(i,n,a,r),o={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(o).map((function(e){return ee({key:e},o[e],{area:_(o[e])})})).sort((function(e,t){return t.area-e.area})),d=l.filter((function(e){var t=e.width,n=e.height;return t>=i.clientWidth&&n>=i.clientHeight})),u=0<d.length?d[0].key:l[0].key,c=e.split("-")[1];return u+(c?"-"+c:"")}function E(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return g(i,n?b(t):l(t,r(i)),n)}function S(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),n=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+n,height:e.offsetHeight+i}}function k(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function A(e,t,i){i=i.split("-")[0];var n=S(e),r={width:n.width,height:n.height},a=-1!==["right","left"].indexOf(i),s=a?"top":"left",o=a?"left":"top",l=a?"height":"width",d=a?"width":"height";return r[s]=t[s]+t[l]/2-n[l]/2,r[o]=i===o?t[o]-n[d]:t[k(o)],r}function C(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function R(t,i,n){var r=void 0===n?t:t.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var n=C(e,(function(e){return e[t]===i}));return e.indexOf(n)}(t,"name",n));return r.forEach((function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=t.function||t.fn;t.enabled&&e(n)&&(i.offsets.popper=p(i.offsets.popper),i.offsets.reference=p(i.offsets.reference),i=n(i,t))})),i}function L(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=E(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=T(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=A(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=R(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function D(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function x(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var r=t[n],a=r?""+r+i:e;if(void 0!==document.body.style[a])return a}return null}function O(){return this.state.isDestroyed=!0,D(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[x("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function P(e){var t=e.ownerDocument;return t?t.defaultView:window}function I(e,t,i,r){var a="BODY"===e.nodeName,s=a?e.ownerDocument.defaultView:e;s.addEventListener(t,i,{passive:!0}),a||I(n(s.parentNode),t,i,r),r.push(s)}function M(e,t,i,r){i.updateBound=r,P(e).addEventListener("resize",i.updateBound,{passive:!0});var a=n(e);return I(a,"scroll",i.updateBound,i.scrollParents),i.scrollElement=a,i.eventsEnabled=!0,i}function N(){this.state.eventsEnabled||(this.state=M(this.reference,this.options,this.state,this.scheduleUpdate))}function F(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(e,t){return P(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}(this.reference,this.state))}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function B(e,t){Object.keys(t).forEach((function(i){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&U(t[i])&&(n="px"),e.style[i]=t[i]+n}))}function j(e,t,i){var n=C(e,(function(e){return e.name===t})),r=!!n&&e.some((function(e){return e.name===i&&e.enabled&&e.order<n.order}));if(!r){var a="`"+t+"`";console.warn("`"+i+"` modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return r}function $(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=ne.indexOf(e),n=ne.slice(i+1).concat(ne.slice(0,i));return t?n.reverse():n}function H(e,t,i,n){var r=[0,0],a=-1!==["right","left"].indexOf(n),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),o=s.indexOf(C(s,(function(e){return-1!==e.search(/,|\s/)})));s[o]&&-1===s[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,d=-1===o?[s]:[s.slice(0,o).concat([s[o].split(l)[0]]),[s[o].split(l)[1]].concat(s.slice(o+1))];return d=d.map((function(e,n){var r=(1===n?!a:a)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,n){var r=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+r[1],s=r[2];if(!a)return e;if(0===s.indexOf("%")){return p("%p"===s?i:n)[t]/100*a}return"vh"===s||"vw"===s?("vh"===s?W(document.documentElement.clientHeight,window.innerHeight||0):W(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,r,t,i)}))})),d.forEach((function(e,t){e.forEach((function(i,n){U(i)&&(r[t]+=i*("-"===e[n-1]?-1:1))}))})),r}var G=Math.min,q=Math.floor,K=Math.round,W=Math.max,V="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,Y=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(V&&0<=navigator.userAgent.indexOf(e[t]))return 1;return 0}(),z=V&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),Y))}},X=V&&!(!window.MSInputMethodContext||!document.documentMode),Q=V&&/MSIE 10/.test(navigator.userAgent),J=function(){function e(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Z=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},ee=Object.assign||function(e){for(var t,i=1;i<arguments.length;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},te=V&&/Firefox/i.test(navigator.userAgent),ie=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ne=ie.slice(3),re="flip",ae="clockwise",se="counterclockwise",oe=function(){function t(i,n){var r=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=z(this.update.bind(this)),this.options=ee({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=i&&i.jquery?i[0]:i,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(ee({},t.Defaults.modifiers,a.modifiers)).forEach((function(e){r.options.modifiers[e]=ee({},t.Defaults.modifiers[e]||{},a.modifiers?a.modifiers[e]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return ee({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(t){t.enabled&&e(t.onLoad)&&t.onLoad(r.reference,r.popper,r.options,t,r.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return J(t,[{key:"update",value:function(){return L.call(this)}},{key:"destroy",value:function(){return O.call(this)}},{key:"enableEventListeners",value:function(){return N.call(this)}},{key:"disableEventListeners",value:function(){return F.call(this)}}]),t}();return oe.Utils=("undefined"==typeof window?global:window).PopperUtils,oe.placements=ie,oe.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],n=t.split("-")[1];if(n){var r=e.offsets,a=r.reference,s=r.popper,o=-1!==["bottom","top"].indexOf(i),l=o?"left":"top",d=o?"width":"height",u={start:Z({},l,a[l]),end:Z({},l,a[l]+a[d]-s[d])};e.offsets.popper=ee({},s,u[n])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i,n=t.offset,r=e.placement,a=e.offsets,s=a.popper,o=a.reference,l=r.split("-")[0];return i=U(+n)?[+n,0]:H(n,s,o,l),"left"===l?(s.top+=i[0],s.left-=i[1]):"right"===l?(s.top+=i[0],s.left+=i[1]):"top"===l?(s.left+=i[0],s.top-=i[1]):"bottom"===l&&(s.left+=i[0],s.top+=i[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||s(e.instance.popper);e.instance.reference===i&&(i=s(i));var n=x("transform"),r=e.instance.popper.style,a=r.top,o=r.left,l=r[n];r.top="",r.left="",r[n]="";var d=w(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);r.top=a,r.left=o,r[n]=l,t.boundaries=d;var u=t.priority,c=e.offsets.popper,h={primary:function(e){var i=c[e];return c[e]<d[e]&&!t.escapeWithReference&&(i=W(c[e],d[e])),Z({},e,i)},secondary:function(e){var i="right"===e?"left":"top",n=c[i];return c[e]>d[e]&&!t.escapeWithReference&&(n=G(c[i],d[e]-("right"===e?c.width:c.height))),Z({},i,n)}};return u.forEach((function(e){var t=-1===["left","top"].indexOf(e)?"secondary":"primary";c=ee({},c,h[t](e))})),e.offsets.popper=c,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,n=t.reference,r=e.placement.split("-")[0],a=q,s=-1!==["top","bottom"].indexOf(r),o=s?"right":"bottom",l=s?"left":"top",d=s?"width":"height";return i[o]<a(n[l])&&(e.offsets.popper[l]=a(n[l])-i[d]),i[l]>a(n[o])&&(e.offsets.popper[l]=a(n[o])),e}},arrow:{order:500,enabled:!0,fn:function(e,i){var n;if(!j(e.instance.modifiers,"arrow","keepTogether"))return e;var r=i.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],s=e.offsets,o=s.popper,l=s.reference,d=-1!==["left","right"].indexOf(a),u=d?"height":"width",c=d?"Top":"Left",h=c.toLowerCase(),f=d?"left":"top",m=d?"bottom":"right",g=S(r)[u];l[m]-g<o[h]&&(e.offsets.popper[h]-=o[h]-(l[m]-g)),l[h]+g>o[m]&&(e.offsets.popper[h]+=l[h]+g-o[m]),e.offsets.popper=p(e.offsets.popper);var v=l[h]+l[u]/2-g/2,y=t(e.instance.popper),b=parseFloat(y["margin"+c]),w=parseFloat(y["border"+c+"Width"]),_=v-e.offsets.popper[h]-b-w;return _=W(G(o[u]-g,_),0),e.arrowElement=r,e.offsets.arrow=(Z(n={},h,K(_)),Z(n,f,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(D(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=w(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],r=k(n),a=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case re:s=[n,r];break;case ae:s=$(n);break;case se:s=$(n,!0);break;default:s=t.behavior}return s.forEach((function(o,l){if(n!==o||s.length===l+1)return e;n=e.placement.split("-")[0],r=k(n);var d=e.offsets.popper,u=e.offsets.reference,c=q,h="left"===n&&c(d.right)>c(u.left)||"right"===n&&c(d.left)<c(u.right)||"top"===n&&c(d.bottom)>c(u.top)||"bottom"===n&&c(d.top)<c(u.bottom),f=c(d.left)<c(i.left),p=c(d.right)>c(i.right),m=c(d.top)<c(i.top),g=c(d.bottom)>c(i.bottom),v="left"===n&&f||"right"===n&&p||"top"===n&&m||"bottom"===n&&g,y=-1!==["top","bottom"].indexOf(n),b=!!t.flipVariations&&(y&&"start"===a&&f||y&&"end"===a&&p||!y&&"start"===a&&m||!y&&"end"===a&&g),w=!!t.flipVariationsByContent&&(y&&"start"===a&&p||y&&"end"===a&&f||!y&&"start"===a&&g||!y&&"end"===a&&m),_=b||w;(h||v||_)&&(e.flipped=!0,(h||v)&&(n=s[l+1]),_&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=n+(a?"-"+a:""),e.offsets.popper=ee({},e.offsets.popper,A(e.instance.popper,e.offsets.reference,e.placement)),e=R(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],n=e.offsets,r=n.popper,a=n.reference,s=-1!==["left","right"].indexOf(i),o=-1===["top","left"].indexOf(i);return r[s?"left":"top"]=a[i]-(o?r[s?"width":"height"]:0),e.placement=k(t),e.offsets.popper=p(r),e}},hide:{order:800,enabled:!0,fn:function(e){if(!j(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=C(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,n=t.y,r=e.offsets.popper,a=C(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,l,d=void 0===a?t.gpuAcceleration:a,u=s(e.instance.popper),c=m(u),h={position:r.position},f=function(e,t){var i=e.offsets,n=i.popper,r=i.reference,a=K,s=function(e){return e},o=a(r.width),l=a(n.width),d=-1!==["left","right"].indexOf(e.placement),u=-1!==e.placement.indexOf("-"),c=t?d||u||o%2==l%2?a:q:s,h=t?a:s;return{left:c(1==o%2&&1==l%2&&!u&&t?n.left-1:n.left),top:h(n.top),bottom:h(n.bottom),right:c(n.right)}}(e,2>window.devicePixelRatio||!te),p="bottom"===i?"top":"bottom",g="right"===n?"left":"right",v=x("transform");if(l="bottom"==p?"HTML"===u.nodeName?-u.clientHeight+f.bottom:-c.height+f.bottom:f.top,o="right"==g?"HTML"===u.nodeName?-u.clientWidth+f.right:-c.width+f.right:f.left,d&&v)h[v]="translate3d("+o+"px, "+l+"px, 0)",h[p]=0,h[g]=0,h.willChange="transform";else{var y="bottom"==p?-1:1,b="right"==g?-1:1;h[p]=l*y,h[g]=o*b,h.willChange=p+", "+g}var w={"x-placement":e.placement};return e.attributes=ee({},w,e.attributes),e.styles=ee({},h,e.styles),e.arrowStyles=ee({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return B(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach((function(i){!1===t[i]?e.removeAttribute(i):e.setAttribute(i,t[i])}))}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&B(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,n,r){var a=E(r,t,e,i.positionFixed),s=T(i.placement,a,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",s),B(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},oe})),
/*!
  * Bootstrap util.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Util=t(e.jQuery)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=t(e),n="transitionend";function r(e){var t=this,n=!1;return i.default(this).one(a.TRANSITION_END,(function(){n=!0})),setTimeout((function(){n||a.triggerTransitionEnd(t)}),e),this}var a={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");if(!t||"#"===t){var i=e.getAttribute("href");t=i&&"#"!==i?i.trim():""}try{return document.querySelector(t)?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=i.default(e).css("transition-duration"),n=i.default(e).css("transition-delay"),r=parseFloat(t),a=parseFloat(n);return r||a?(t=t.split(",")[0],n=n.split(",")[0],1e3*(parseFloat(t)+parseFloat(n))):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){i.default(e).trigger(n)},supportsTransitionEnd:function(){return Boolean(n)},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,i){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n],s=t[n],o=s&&a.isElement(s)?"element":null==(l=s)?""+l:{}.toString.call(l).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(o))throw new Error(e.toUpperCase()+': Option "'+n+'" provided type "'+o+'" but expected type "'+r+'".')}var l},findShadowRoot:function(e){if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){var t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?a.findShadowRoot(e.parentNode):null},jQueryDetection:function(){if(void 0===i.default)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=i.default.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};return a.jQueryDetection(),i.default.fn.emulateTransitionEnd=r,i.default.event.special[a.TRANSITION_END]={bindType:n,delegateType:n,handle:function(e){if(i.default(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},a})),
/*!
  * Bootstrap modal.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Modal=t(e.jQuery,e.Util)}(this,(function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(e),r=i(t);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s.apply(this,arguments)}var o="modal",l="bs.modal",d="."+l,u=n.default.fn[o],c="modal-open",h="fade",f="show",p="modal-static",m="hide"+d,g="hidePrevented"+d,v="hidden"+d,y="show"+d,b="shown"+d,w="focusin"+d,_="resize"+d,T="click.dismiss"+d,E="keydown.dismiss"+d,S="mouseup.dismiss"+d,k="mousedown.dismiss"+d,A="click"+d+".data-api",C=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",R=".sticky-top",L={backdrop:!0,keyboard:!0,focus:!0,show:!0},D={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},x=function(){function e(e,t){this._config=this._getConfig(t),this._element=e,this._dialog=e.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t,i,u,A=e.prototype;return A.toggle=function(e){return this._isShown?this.hide():this.show(e)},A.show=function(e){var t=this;if(!this._isShown&&!this._isTransitioning){var i=n.default.Event(y,{relatedTarget:e});n.default(this._element).trigger(i),i.isDefaultPrevented()||(this._isShown=!0,n.default(this._element).hasClass(h)&&(this._isTransitioning=!0),this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),n.default(this._element).on(T,'[data-dismiss="modal"]',(function(e){return t.hide(e)})),n.default(this._dialog).on(k,(function(){n.default(t._element).one(S,(function(e){n.default(e.target).is(t._element)&&(t._ignoreBackdropClick=!0)}))})),this._showBackdrop((function(){return t._showElement(e)})))}},A.hide=function(e){var t=this;if(e&&e.preventDefault(),this._isShown&&!this._isTransitioning){var i=n.default.Event(m);if(n.default(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var a=n.default(this._element).hasClass(h);if(a&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),n.default(document).off(w),n.default(this._element).removeClass(f),n.default(this._element).off(T),n.default(this._dialog).off(k),a){var s=r.default.getTransitionDurationFromElement(this._element);n.default(this._element).one(r.default.TRANSITION_END,(function(e){return t._hideModal(e)})).emulateTransitionEnd(s)}else this._hideModal()}}},A.dispose=function(){[window,this._element,this._dialog].forEach((function(e){return n.default(e).off(d)})),n.default(document).off(w),n.default.removeData(this._element,l),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},A.handleUpdate=function(){this._adjustDialog()},A._getConfig=function(e){return e=s({},L,e),r.default.typeCheckConfig(o,e,D),e},A._triggerBackdropTransition=function(){var e=this,t=n.default.Event(g);if(n.default(this._element).trigger(t),!t.isDefaultPrevented()){var i=this._element.scrollHeight>document.documentElement.clientHeight;i||(this._element.style.overflowY="hidden"),this._element.classList.add(p);var a=r.default.getTransitionDurationFromElement(this._dialog);n.default(this._element).off(r.default.TRANSITION_END),n.default(this._element).one(r.default.TRANSITION_END,(function(){e._element.classList.remove(p),i||n.default(e._element).one(r.default.TRANSITION_END,(function(){e._element.style.overflowY=""})).emulateTransitionEnd(e._element,a)})).emulateTransitionEnd(a),this._element.focus()}},A._showElement=function(e){var t=this,i=n.default(this._element).hasClass(h),a=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),n.default(this._dialog).hasClass("modal-dialog-scrollable")&&a?a.scrollTop=0:this._element.scrollTop=0,i&&r.default.reflow(this._element),n.default(this._element).addClass(f),this._config.focus&&this._enforceFocus();var s=n.default.Event(b,{relatedTarget:e}),o=function(){t._config.focus&&t._element.focus(),t._isTransitioning=!1,n.default(t._element).trigger(s)};if(i){var l=r.default.getTransitionDurationFromElement(this._dialog);n.default(this._dialog).one(r.default.TRANSITION_END,o).emulateTransitionEnd(l)}else o()},A._enforceFocus=function(){var e=this;n.default(document).off(w).on(w,(function(t){document!==t.target&&e._element!==t.target&&0===n.default(e._element).has(t.target).length&&e._element.focus()}))},A._setEscapeEvent=function(){var e=this;this._isShown?n.default(this._element).on(E,(function(t){e._config.keyboard&&27===t.which?(t.preventDefault(),e.hide()):e._config.keyboard||27!==t.which||e._triggerBackdropTransition()})):this._isShown||n.default(this._element).off(E)},A._setResizeEvent=function(){var e=this;this._isShown?n.default(window).on(_,(function(t){return e.handleUpdate(t)})):n.default(window).off(_)},A._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop((function(){n.default(document.body).removeClass(c),e._resetAdjustments(),e._resetScrollbar(),n.default(e._element).trigger(v)}))},A._removeBackdrop=function(){this._backdrop&&(n.default(this._backdrop).remove(),this._backdrop=null)},A._showBackdrop=function(e){var t=this,i=n.default(this._element).hasClass(h)?h:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&this._backdrop.classList.add(i),n.default(this._backdrop).appendTo(this._element),n.default(this._element).on(T,(function(e){t._ignoreBackdropClick?t._ignoreBackdropClick=!1:e.target!==e.currentTarget&&e.target!==t._backdrop||("static"===t._config.backdrop?t._triggerBackdropTransition():t.hide())})),i&&r.default.reflow(this._backdrop),n.default(this._backdrop).addClass(f),!e)return;if(!i)return void e();var a=r.default.getTransitionDurationFromElement(this._backdrop);n.default(this._backdrop).one(r.default.TRANSITION_END,e).emulateTransitionEnd(a)}else if(!this._isShown&&this._backdrop){n.default(this._backdrop).removeClass(f);var s=function(){t._removeBackdrop(),e&&e()};if(n.default(this._element).hasClass(h)){var o=r.default.getTransitionDurationFromElement(this._backdrop);n.default(this._backdrop).one(r.default.TRANSITION_END,s).emulateTransitionEnd(o)}else s()}else e&&e()},A._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&e&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!e&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},A._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},A._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(e.left+e.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},A._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var t=[].slice.call(document.querySelectorAll(C)),i=[].slice.call(document.querySelectorAll(R));n.default(t).each((function(t,i){var r=i.style.paddingRight,a=n.default(i).css("padding-right");n.default(i).data("padding-right",r).css("padding-right",parseFloat(a)+e._scrollbarWidth+"px")})),n.default(i).each((function(t,i){var r=i.style.marginRight,a=n.default(i).css("margin-right");n.default(i).data("margin-right",r).css("margin-right",parseFloat(a)-e._scrollbarWidth+"px")}));var r=document.body.style.paddingRight,a=n.default(document.body).css("padding-right");n.default(document.body).data("padding-right",r).css("padding-right",parseFloat(a)+this._scrollbarWidth+"px")}n.default(document.body).addClass(c)},A._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(C));n.default(e).each((function(e,t){var i=n.default(t).data("padding-right");n.default(t).removeData("padding-right"),t.style.paddingRight=i||""}));var t=[].slice.call(document.querySelectorAll(""+R));n.default(t).each((function(e,t){var i=n.default(t).data("margin-right");void 0!==i&&n.default(t).css("margin-right",i).removeData("margin-right")}));var i=n.default(document.body).data("padding-right");n.default(document.body).removeData("padding-right"),document.body.style.paddingRight=i||""},A._getScrollbarWidth=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},e._jQueryInterface=function(t,i){return this.each((function(){var r=n.default(this).data(l),a=s({},L,n.default(this).data(),"object"==typeof t&&t?t:{});if(r||(r=new e(this,a),n.default(this).data(l,r)),"string"==typeof t){if(void 0===r[t])throw new TypeError('No method named "'+t+'"');r[t](i)}else a.show&&r.show(i)}))},t=e,u=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return L}}],(i=null)&&a(t.prototype,i),u&&a(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}();return n.default(document).on(A,'[data-toggle="modal"]',(function(e){var t,i=this,a=r.default.getSelectorFromElement(this);a&&(t=document.querySelector(a));var o=n.default(t).data(l)?"toggle":s({},n.default(t).data(),n.default(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault();var d=n.default(t).one(y,(function(e){e.isDefaultPrevented()||d.one(v,(function(){n.default(i).is(":visible")&&i.focus()}))}));x._jQueryInterface.call(n.default(t),o,this)})),n.default.fn[o]=x._jQueryInterface,n.default.fn[o].Constructor=x,n.default.fn[o].noConflict=function(){return n.default.fn[o]=u,x._jQueryInterface},x})),
/*!
  * Bootstrap dropdown.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("popper.js"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","popper.js","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Dropdown=t(e.jQuery,e.Popper,e.Util)}(this,(function(e,t,i){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),a=n(t),s=n(i);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},l.apply(this,arguments)}var d="dropdown",u="bs.dropdown",c="."+u,h=".data-api",f=r.default.fn[d],p=new RegExp("38|40|27"),m="disabled",g="show",v="dropdown-menu-right",y="hide"+c,b="hidden"+c,w="show"+c,_="shown"+c,T="click"+c,E="click"+c+h,S="keydown"+c+h,k="keyup"+c+h,A='[data-toggle="dropdown"]',C=".dropdown-menu",R={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},L={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},D=function(){function e(e,t){this._element=e,this._popper=null,this._config=this._getConfig(t),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t,i,n,h=e.prototype;return h.toggle=function(){if(!this._element.disabled&&!r.default(this._element).hasClass(m)){var t=r.default(this._menu).hasClass(g);e._clearMenus(),t||this.show(!0)}},h.show=function(t){if(void 0===t&&(t=!1),!(this._element.disabled||r.default(this._element).hasClass(m)||r.default(this._menu).hasClass(g))){var i={relatedTarget:this._element},n=r.default.Event(w,i),o=e._getParentFromElement(this._element);if(r.default(o).trigger(n),!n.isDefaultPrevented()){if(!this._inNavbar&&t){if(void 0===a.default)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");var l=this._element;"parent"===this._config.reference?l=o:s.default.isElement(this._config.reference)&&(l=this._config.reference,void 0!==this._config.reference.jquery&&(l=this._config.reference[0])),"scrollParent"!==this._config.boundary&&r.default(o).addClass("position-static"),this._popper=new a.default(l,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===r.default(o).closest(".navbar-nav").length&&r.default(document.body).children().on("mouseover",null,r.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),r.default(this._menu).toggleClass(g),r.default(o).toggleClass(g).trigger(r.default.Event(_,i))}}},h.hide=function(){if(!this._element.disabled&&!r.default(this._element).hasClass(m)&&r.default(this._menu).hasClass(g)){var t={relatedTarget:this._element},i=r.default.Event(y,t),n=e._getParentFromElement(this._element);r.default(n).trigger(i),i.isDefaultPrevented()||(this._popper&&this._popper.destroy(),r.default(this._menu).toggleClass(g),r.default(n).toggleClass(g).trigger(r.default.Event(b,t)))}},h.dispose=function(){r.default.removeData(this._element,u),r.default(this._element).off(c),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},h.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},h._addEventListeners=function(){var e=this;r.default(this._element).on(T,(function(t){t.preventDefault(),t.stopPropagation(),e.toggle()}))},h._getConfig=function(e){return e=l({},this.constructor.Default,r.default(this._element).data(),e),s.default.typeCheckConfig(d,e,this.constructor.DefaultType),e},h._getMenuElement=function(){if(!this._menu){var t=e._getParentFromElement(this._element);t&&(this._menu=t.querySelector(C))}return this._menu},h._getPlacement=function(){var e=r.default(this._element.parentNode),t="bottom-start";return e.hasClass("dropup")?t=r.default(this._menu).hasClass(v)?"top-end":"top-start":e.hasClass("dropright")?t="right-start":e.hasClass("dropleft")?t="left-start":r.default(this._menu).hasClass(v)&&(t="bottom-end"),t},h._detectNavbar=function(){return r.default(this._element).closest(".navbar").length>0},h._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e._config.offset(t.offsets,e._element)),t}:t.offset=this._config.offset,t},h._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(e.modifiers.applyStyle={enabled:!1}),l({},e,this._config.popperConfig)},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this).data(u);if(i||(i=new e(this,"object"==typeof t?t:null),r.default(this).data(u,i)),"string"==typeof t){if(void 0===i[t])throw new TypeError('No method named "'+t+'"');i[t]()}}))},e._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var i=[].slice.call(document.querySelectorAll(A)),n=0,a=i.length;n<a;n++){var s=e._getParentFromElement(i[n]),o=r.default(i[n]).data(u),l={relatedTarget:i[n]};if(t&&"click"===t.type&&(l.clickEvent=t),o){var d=o._menu;if(r.default(s).hasClass(g)&&!(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&r.default.contains(s,t.target))){var c=r.default.Event(y,l);r.default(s).trigger(c),c.isDefaultPrevented()||("ontouchstart"in document.documentElement&&r.default(document.body).children().off("mouseover",null,r.default.noop),i[n].setAttribute("aria-expanded","false"),o._popper&&o._popper.destroy(),r.default(d).removeClass(g),r.default(s).removeClass(g).trigger(r.default.Event(b,l)))}}}},e._getParentFromElement=function(e){var t,i=s.default.getSelectorFromElement(e);return i&&(t=document.querySelector(i)),t||e.parentNode},e._dataApiKeydownHandler=function(t){if(!(/input|textarea/i.test(t.target.tagName)?32===t.which||27!==t.which&&(40!==t.which&&38!==t.which||r.default(t.target).closest(C).length):!p.test(t.which))&&!this.disabled&&!r.default(this).hasClass(m)){var i=e._getParentFromElement(this),n=r.default(i).hasClass(g);if(n||27!==t.which){if(t.preventDefault(),t.stopPropagation(),!n||27===t.which||32===t.which)return 27===t.which&&r.default(i.querySelector(A)).trigger("focus"),void r.default(this).trigger("click");var a=[].slice.call(i.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter((function(e){return r.default(e).is(":visible")}));if(0!==a.length){var s=a.indexOf(t.target);38===t.which&&s>0&&s--,40===t.which&&s<a.length-1&&s++,s<0&&(s=0),a[s].focus()}}}},t=e,n=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return R}},{key:"DefaultType",get:function(){return L}}],(i=null)&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();return r.default(document).on(S,A,D._dataApiKeydownHandler).on(S,C,D._dataApiKeydownHandler).on(E+" "+k,D._clearMenus).on(E,A,(function(e){e.preventDefault(),e.stopPropagation(),D._jQueryInterface.call(r.default(this),"toggle")})).on(E,".dropdown form",(function(e){e.stopPropagation()})),r.default.fn[d]=D._jQueryInterface,r.default.fn[d].Constructor=D,r.default.fn[d].noConflict=function(){return r.default.fn[d]=f,D._jQueryInterface},D})),
/*!
  * Bootstrap tooltip.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("popper.js"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","popper.js","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Tooltip=t(e.jQuery,e.Popper,e.Util)}(this,(function(e,t,i){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),a=n(t),s=n(i);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},l.apply(this,arguments)}var d=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],u={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},c=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,h=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function f(e,t,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);for(var n=(new window.DOMParser).parseFromString(e,"text/html"),r=Object.keys(t),a=[].slice.call(n.body.querySelectorAll("*")),s=function(e,i){var n=a[e],s=n.nodeName.toLowerCase();if(-1===r.indexOf(n.nodeName.toLowerCase()))return n.parentNode.removeChild(n),"continue";var o=[].slice.call(n.attributes),l=[].concat(t["*"]||[],t[s]||[]);o.forEach((function(e){(function(e,t){var i=e.nodeName.toLowerCase();if(-1!==t.indexOf(i))return-1===d.indexOf(i)||Boolean(c.test(e.nodeValue)||h.test(e.nodeValue));for(var n=t.filter((function(e){return e instanceof RegExp})),r=0,a=n.length;r<a;r++)if(n[r].test(i))return!0;return!1})(e,l)||n.removeAttribute(e.nodeName)}))},o=0,l=a.length;o<l;o++)s(o);return n.body.innerHTML}var p="tooltip",m="bs.tooltip",g="."+m,v=r.default.fn[p],y="bs-tooltip",b=new RegExp("(^|\\s)"+y+"\\S+","g"),w=["sanitize","whiteList","sanitizeFn"],_="fade",T="show",E="show",S="out",k="hover",A="focus",C={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},R={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",customClass:"",sanitize:!0,sanitizeFn:null,whiteList:u,popperConfig:null},L={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},D={HIDE:"hide"+g,HIDDEN:"hidden"+g,SHOW:"show"+g,SHOWN:"shown"+g,INSERTED:"inserted"+g,CLICK:"click"+g,FOCUSIN:"focusin"+g,FOCUSOUT:"focusout"+g,MOUSEENTER:"mouseenter"+g,MOUSELEAVE:"mouseleave"+g},x=function(){function e(e,t){if(void 0===a.default)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=e,this.config=this._getConfig(t),this.tip=null,this._setListeners()}var t,i,n,d=e.prototype;return d.enable=function(){this._isEnabled=!0},d.disable=function(){this._isEnabled=!1},d.toggleEnabled=function(){this._isEnabled=!this._isEnabled},d.toggle=function(e){if(this._isEnabled)if(e){var t=this.constructor.DATA_KEY,i=r.default(e.currentTarget).data(t);i||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(t,i)),i._activeTrigger.click=!i._activeTrigger.click,i._isWithActiveTrigger()?i._enter(null,i):i._leave(null,i)}else{if(r.default(this.getTipElement()).hasClass(T))return void this._leave(null,this);this._enter(null,this)}},d.dispose=function(){clearTimeout(this._timeout),r.default.removeData(this.element,this.constructor.DATA_KEY),r.default(this.element).off(this.constructor.EVENT_KEY),r.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&r.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},d.show=function(){var e=this;if("none"===r.default(this.element).css("display"))throw new Error("Please use show on visible elements");var t=r.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){r.default(this.element).trigger(t);var i=s.default.findShadowRoot(this.element),n=r.default.contains(null!==i?i:this.element.ownerDocument.documentElement,this.element);if(t.isDefaultPrevented()||!n)return;var o=this.getTipElement(),l=s.default.getUID(this.constructor.NAME);o.setAttribute("id",l),this.element.setAttribute("aria-describedby",l),this.setContent(),this.config.animation&&r.default(o).addClass(_);var d="function"==typeof this.config.placement?this.config.placement.call(this,o,this.element):this.config.placement,u=this._getAttachment(d);this.addAttachmentClass(u);var c=this._getContainer();r.default(o).data(this.constructor.DATA_KEY,this),r.default.contains(this.element.ownerDocument.documentElement,this.tip)||r.default(o).appendTo(c),r.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new a.default(this.element,o,this._getPopperConfig(u)),r.default(o).addClass(T),r.default(o).addClass(this.config.customClass),"ontouchstart"in document.documentElement&&r.default(document.body).children().on("mouseover",null,r.default.noop);var h=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,r.default(e.element).trigger(e.constructor.Event.SHOWN),t===S&&e._leave(null,e)};if(r.default(this.tip).hasClass(_)){var f=s.default.getTransitionDurationFromElement(this.tip);r.default(this.tip).one(s.default.TRANSITION_END,h).emulateTransitionEnd(f)}else h()}},d.hide=function(e){var t=this,i=this.getTipElement(),n=r.default.Event(this.constructor.Event.HIDE),a=function(){t._hoverState!==E&&i.parentNode&&i.parentNode.removeChild(i),t._cleanTipClass(),t.element.removeAttribute("aria-describedby"),r.default(t.element).trigger(t.constructor.Event.HIDDEN),null!==t._popper&&t._popper.destroy(),e&&e()};if(r.default(this.element).trigger(n),!n.isDefaultPrevented()){if(r.default(i).removeClass(T),"ontouchstart"in document.documentElement&&r.default(document.body).children().off("mouseover",null,r.default.noop),this._activeTrigger.click=!1,this._activeTrigger[A]=!1,this._activeTrigger[k]=!1,r.default(this.tip).hasClass(_)){var o=s.default.getTransitionDurationFromElement(i);r.default(i).one(s.default.TRANSITION_END,a).emulateTransitionEnd(o)}else a();this._hoverState=""}},d.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},d.isWithContent=function(){return Boolean(this.getTitle())},d.addAttachmentClass=function(e){r.default(this.getTipElement()).addClass(y+"-"+e)},d.getTipElement=function(){return this.tip=this.tip||r.default(this.config.template)[0],this.tip},d.setContent=function(){var e=this.getTipElement();this.setElementContent(r.default(e.querySelectorAll(".tooltip-inner")),this.getTitle()),r.default(e).removeClass(_+" "+T)},d.setElementContent=function(e,t){"object"!=typeof t||!t.nodeType&&!t.jquery?this.config.html?(this.config.sanitize&&(t=f(t,this.config.whiteList,this.config.sanitizeFn)),e.html(t)):e.text(t):this.config.html?r.default(t).parent().is(e)||e.empty().append(t):e.text(r.default(t).text())},d.getTitle=function(){var e=this.element.getAttribute("data-original-title");return e||(e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),e},d._getPopperConfig=function(e){var t=this;return l({},{placement:e,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(e){e.originalPlacement!==e.placement&&t._handlePopperPlacementChange(e)},onUpdate:function(e){return t._handlePopperPlacementChange(e)}},this.config.popperConfig)},d._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e.config.offset(t.offsets,e.element)),t}:t.offset=this.config.offset,t},d._getContainer=function(){return!1===this.config.container?document.body:s.default.isElement(this.config.container)?r.default(this.config.container):r.default(document).find(this.config.container)},d._getAttachment=function(e){return C[e.toUpperCase()]},d._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach((function(t){if("click"===t)r.default(e.element).on(e.constructor.Event.CLICK,e.config.selector,(function(t){return e.toggle(t)}));else if("manual"!==t){var i=t===k?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,n=t===k?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;r.default(e.element).on(i,e.config.selector,(function(t){return e._enter(t)})).on(n,e.config.selector,(function(t){return e._leave(t)}))}})),this._hideModalHandler=function(){e.element&&e.hide()},r.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=l({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},d._fixTitle=function(){var e=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==e)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},d._enter=function(e,t){var i=this.constructor.DATA_KEY;(t=t||r.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusin"===e.type?A:k]=!0),r.default(t.getTipElement()).hasClass(T)||t._hoverState===E?t._hoverState=E:(clearTimeout(t._timeout),t._hoverState=E,t.config.delay&&t.config.delay.show?t._timeout=setTimeout((function(){t._hoverState===E&&t.show()}),t.config.delay.show):t.show())},d._leave=function(e,t){var i=this.constructor.DATA_KEY;(t=t||r.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusout"===e.type?A:k]=!1),t._isWithActiveTrigger()||(clearTimeout(t._timeout),t._hoverState=S,t.config.delay&&t.config.delay.hide?t._timeout=setTimeout((function(){t._hoverState===S&&t.hide()}),t.config.delay.hide):t.hide())},d._isWithActiveTrigger=function(){for(var e in this._activeTrigger)if(this._activeTrigger[e])return!0;return!1},d._getConfig=function(e){var t=r.default(this.element).data();return Object.keys(t).forEach((function(e){-1!==w.indexOf(e)&&delete t[e]})),"number"==typeof(e=l({},this.constructor.Default,t,"object"==typeof e&&e?e:{})).delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),s.default.typeCheckConfig(p,e,this.constructor.DefaultType),e.sanitize&&(e.template=f(e.template,e.whiteList,e.sanitizeFn)),e},d._getDelegateConfig=function(){var e={};if(this.config)for(var t in this.config)this.constructor.Default[t]!==this.config[t]&&(e[t]=this.config[t]);return e},d._cleanTipClass=function(){var e=r.default(this.getTipElement()),t=e.attr("class").match(b);null!==t&&t.length&&e.removeClass(t.join(""))},d._handlePopperPlacementChange=function(e){this.tip=e.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(e.placement))},d._fixTransition=function(){var e=this.getTipElement(),t=this.config.animation;null===e.getAttribute("x-placement")&&(r.default(e).removeClass(_),this.config.animation=!1,this.hide(),this.show(),this.config.animation=t)},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data(m),a="object"==typeof t&&t;if((n||!/dispose|hide/.test(t))&&(n||(n=new e(this,a),i.data(m,n)),"string"==typeof t)){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t]()}}))},t=e,n=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return R}},{key:"NAME",get:function(){return p}},{key:"DATA_KEY",get:function(){return m}},{key:"Event",get:function(){return D}},{key:"EVENT_KEY",get:function(){return g}},{key:"DefaultType",get:function(){return L}}],(i=null)&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();return r.default.fn[p]=x._jQueryInterface,r.default.fn[p].Constructor=x,r.default.fn[p].noConflict=function(){return r.default.fn[p]=v,x._jQueryInterface},x})),
/*!
  * Bootstrap popover.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./tooltip.js")):"function"==typeof define&&define.amd?define(["jquery","./tooltip"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Popover=t(e.jQuery,e.Tooltip)}(this,(function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(e),r=i(t);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s.apply(this,arguments)}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}var l="popover",d="bs.popover",u="."+d,c=n.default.fn[l],h="bs-popover",f=new RegExp("(^|\\s)"+h+"\\S+","g"),p=s({},r.default.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),m=s({},r.default.DefaultType,{content:"(string|element|function)"}),g={HIDE:"hide"+u,HIDDEN:"hidden"+u,SHOW:"show"+u,SHOWN:"shown"+u,INSERTED:"inserted"+u,CLICK:"click"+u,FOCUSIN:"focusin"+u,FOCUSOUT:"focusout"+u,MOUSEENTER:"mouseenter"+u,MOUSELEAVE:"mouseleave"+u},v=function(e){var t,i;function r(){return e.apply(this,arguments)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,o(t,i);var s,c,v,y=r.prototype;return y.isWithContent=function(){return this.getTitle()||this._getContent()},y.addAttachmentClass=function(e){n.default(this.getTipElement()).addClass(h+"-"+e)},y.getTipElement=function(){return this.tip=this.tip||n.default(this.config.template)[0],this.tip},y.setContent=function(){var e=n.default(this.getTipElement());this.setElementContent(e.find(".popover-header"),this.getTitle());var t=this._getContent();"function"==typeof t&&(t=t.call(this.element)),this.setElementContent(e.find(".popover-body"),t),e.removeClass("fade show")},y._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},y._cleanTipClass=function(){var e=n.default(this.getTipElement()),t=e.attr("class").match(f);null!==t&&t.length>0&&e.removeClass(t.join(""))},r._jQueryInterface=function(e){return this.each((function(){var t=n.default(this).data(d),i="object"==typeof e?e:null;if((t||!/dispose|hide/.test(e))&&(t||(t=new r(this,i),n.default(this).data(d,t)),"string"==typeof e)){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}}))},s=r,v=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return p}},{key:"NAME",get:function(){return l}},{key:"DATA_KEY",get:function(){return d}},{key:"Event",get:function(){return g}},{key:"EVENT_KEY",get:function(){return u}},{key:"DefaultType",get:function(){return m}}],(c=null)&&a(s.prototype,c),v&&a(s,v),Object.defineProperty(s,"prototype",{writable:!1}),r}(r.default);return n.default.fn[l]=v._jQueryInterface,n.default.fn[l].Constructor=v,n.default.fn[l].noConflict=function(){return n.default.fn[l]=c,v._jQueryInterface},v})),function(e,t){"use strict";e.wp=e.wp||{},e.wp.hooks=e.wp.hooks||new function(){var e=Array.prototype.slice,t={removeFilter:function(e,i){"string"==typeof e&&n("filters",e,i);return t},applyFilters:function(){var i=e.call(arguments),n=i.shift();if("string"==typeof n)return a("filters",n,i);return t},addFilter:function(e,i,n,a){"string"==typeof e&&"function"==typeof n&&r("filters",e,i,n,a=parseInt(a||10,10));return t},removeAction:function(e,i){"string"==typeof e&&n("actions",e,i);return t},doAction:function(){var i=e.call(arguments),n=i.shift();"string"==typeof n&&a("actions",n,i);return t},addAction:function(e,i,n,a){"string"==typeof e&&"function"==typeof n&&r("actions",e,i,n,a=parseInt(a||10,10));return t}},i={actions:{},filters:{}};function n(e,t,n){var r,a;if(i[e][t])if(n)for(a=(r=i[e][t]).length;a--;)r[a].namespace===n&&r.splice(a,1);else i[e][t]=[]}function r(e,t,n,r,a){var s={callback:r,priority:a,namespace:n},o=i[e][t];o?(o.push(s),o=function(e){for(var t,i,n,r=1,a=e.length;r<a;r++){for(t=e[r],i=r;(n=e[i-1])&&n.priority>t.priority;)e[i]=e[i-1],--i;e[i]=t}return e}(o)):o=[s],i[e][t]=o}function a(e,t,n){var r,a,s=i[e][t];if(!s)return"filters"===e&&n[0];if(a=s.length,"filters"===e)for(r=0;r<a;r++)n[0]=s[r].callback.apply(s[r].namespace,n);else for(r=0;r<a;r++)s[r].callback.apply(s[r].namespace,n);return"filters"!==e||n[0]}return t}}(window),function($,window){"use strict";var upload={el:"#upload-modal",el_msg:".form-message",url:"",server:"",trigger:"",type:"",items:[],init:function(){var e=this;this.setUrl=this.setUrl.bind(this),this.sortable=this.sortable.bind(this),this.sortable(),$(document).on("click",'.form-validate input[type="submit"], #commentform input[type="submit"]',(function(t){var i=$(this).closest("form");e.validate(i)})),$(document).on("click",".btn-edit, .btn-upload",(function(t){if(t.preventDefault(),play.is_user_logged_in){e.items=[];var i=$(this).closest("[data-play-id]").attr("data-play-id");$(e.el).remove(),getModal(e.el,{name:"upload_form",post_id:i},e.sortable)}})),$(document).on("click",".track-list .remove",(function(t){$(this).parent().remove(),e.updateList()})),$(document).on("change",'input[type="file"]',(function(e){var t=$(this)[0];if(t.files&&t.files[0]){var i=t.files[0],n=$(this).parent().find("img");0==n.length&&(n=$("<img>"),$(this).next(".post-thumbnail").html(n));try{var r=new FileReader;r.onload=function(e){n.removeAttr("srcset"),n.attr("src",e.target.result)},r.readAsDataURL(i)}catch(e){}}})),$(document).on("change",'[name="stream_url"]',(function(t){$(this).val().match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)&&(e.url=$(this).val(),$(e.el).remove(),getModal(e.el,{name:"upload_form",form:!0},e.setUrl),$(this).val(""))})),$(document).on("dragover",".dragdrop-upload",(function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("dropover")})),$(document).on("drop",".dragdrop-upload",(function(t){t.stopPropagation(),t.preventDefault(),$(this).removeClass("dropover");for(var i=t.originalEvent.dataTransfer.files,n=[],r=["mp3","m4a","ogg","wav","mp4","m4v","mov","wmv","avi","mpg","ogv","3gp","3g2"],a=i.length-1;a>=0;a--)r.includes(i[a].name.split(".").pop())&&n.push(i[a]);n.length>0&&e.bulkUpload(n)})),$(document).on("change",'[name="stream_file"]',(function(t){e.trigger=$(this);var i=$(this)[0].files;e.bulkUpload(i)})),$(document).on("change",'[name="upload_file"]',(function(t){e.trigger=$(this),e.type="","single"==$(this).attr("data-type")&&(e.type="single");var i=$(this)[0].files[0];i.el=$(this).next(".progress"),i.title=i.name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),e.uploadFile(i)})),$(document).on("click",'#upload [type="submit"]',(function(t){t.preventDefault(),$(e.el_msg,e.el).html("");var i=$(this).closest("form"),n=[];if(e.items.length>1&&($(".track-list li").each((function(t){var i=$(this),r=i.attr("id"),a=e.getItem(r);n[t]={},n[t].title=i.find("input").val(),a&&(n[t].url=a.url,n[t].metadata=a.metadata)})),!e.getUploaded(e.items)))return i.removeClass("processing"),i.find(".file-uploading").show(),!1;if(!e.validate(i))return!1;var r=new FormData(i[0]);return n.length&&r.append("tracks",JSON.stringify(n)),1==e.items.length&&r.append("metadata",JSON.stringify(e.items[0].metadata)),$.ajax({url:play.rest.endpoints.upload,data:r,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status?($(e.el_msg,i).first().append('<div class="success">'+t.msg+"</div>"),t.post_id&&$(i).find('[name="post_id"]').val(t.post_id),setTimeout((function(){var e=$(i).closest(".modal");e.length&&e.modal("hide"),t.redirect&&redirect(t.redirect)}),3e3),$(document).trigger("play.uploaded")):"error"==t.status&&$(e.el_msg,i).first().append('<div class="error">'+t.msg+"</div>"),i.removeClass("processing")})),!1})),$(document).on("items.uploadform",(function(t,i){for(var n=e.items.length-1;n>=0;n--)if(e.items[n].id==i.id)for(var r in i)e.items[n].metadata[r]=i[r]}))},bulkUpload:function(e){this.items=e,this.items.length>1?this.type="multiple":this.type="single",this.upload=this.upload.bind(this),$(this.el).remove(),getModal(this.el,{name:"upload_form",form:!0,type:this.items.length>1?"playlist":"single"},this.upload)},upload:function(){"single"==this.type&&$(".tracks").append('<ul class="track-list single"></ul>');for(var e=this.items.length-1;e>=0;e--)this.items[e].id=e,this.items[e].title=this.items[e].name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),this.items[e].el=$('<li id="'+e+'" class="input"><div class="progress"><div class="progress-bar"></div></div><span class="handle"></span><input class="track-list-title" value="'+this.items[e].title+'" /><span class="remove"></span></div>'),$(".track-list").append(this.items[e].el),this.uploadFile(this.items[e],e);this.sortable()},uploadFile:function(e){var t=this;if(e.metadata={},play.waveform){var i=new FileReader;i.onload=function(t){var i=new(window.AudioContext||window.webkitAudioContext);try{i.decodeAudioData(t.target.result,(function(t){var i=new Waveform;e.metadata.waveform=i.parsePeaks(t),e.metadata.bpm=DetectBPM(t),e=wp.hooks.applyFilters("hook_upload_file",e,t)}))}catch(e){}},i.readAsArrayBuffer(e)}var n=new FormData;n.append("action","upload_stream"),n.append("file",e),e.uploading=!0,$(t.el_msg,t.el).html(""),$.ajax({url:play.rest.endpoints.upload_stream,type:"POST",data:n,processData:!1,contentType:!1,enctype:"multipart/form-data",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)},xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var i=t.loaded/t.total;i=parseInt(100*i),e.el&&e.el.find(".progress-bar").css("width",i+"%")}}),!1),t}}).then((function(i){if(e.el&&e.el.find(".progress-bar").css("width","0"),"success"==i.status){if(e.url=i.url,i.metadata)for(var n in i.metadata)e.metadata[n]=i.metadata[n];t.setUpload(e)}else"error"==i.status&&$(t.el_msg,t.el).first().append('<div class="error">'+i.msg+"</div>")})).always((function(){e.uploading=!1,t.items.length>1&&t.getUploaded(t.items)&&($(".file-uploading").hide(),$(".file-uploaded").show())}))},setUpload:function(e){this.trigger&&this.trigger.parent().hasClass("file-upload")&&this.trigger.parent().prev("input").val(e.url);var t=$(".form");e.metadata.thumbnail&&($(".file-upload input").removeAttr("required"),$(".file-upload img").attr("src",e.metadata.thumbnail),t.append('<input type="hidden" name="thumbnail_id" value="'+e.metadata.thumbnail_id+'" />')),e.metadata.artist&&t.find('[name="artist"]').val(e.metadata.artist),"single"==this.type?(t.find('[name="title"]').val(e.title),t.find('[name="stream"]').val(e.url),e.metadata.title&&t.find('[name="title"]').val(e.metadata.title),e.metadata.length_formatted&&t.find('[name="duration"]').val(e.metadata.length_formatted),e.metadata.media_type&&t.append('<input type="hidden" name="media_type" value="'+e.metadata.media_type+'" />')):(e.metadata.title&&e.el.find(".track-list-title").val(e.metadata.title),e.metadata.album&&t.find('[name="title"]').val(e.metadata.album))},getUploaded:function(e){for(var t=!0,i=e.length-1;i>=0;i--)e[i].uploading&&(t=!1);return t},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t]},validate:function(e){var t=!0;return e.find("[required]").each((function(){if(!$.trim($(this).val())||"email"==$(this).attr("type")&&!$(this).val().includes("@")||"url"==$(this).attr("type")&&!URL.canParse($(this).val()))return $(this).focus(),t=!1,e.attr("validate",!1),!1;e.attr("validate",!0),t=!0})),t&&e.addClass("processing"),t},setUrl:function(){var e=this;$('[name="stream"]').val(e.url),playImport(e.url,{},(function(t){var i=new Waveform;if(t.title&&$('[name="title"]').val(t.title),t.description&&$('[name="content"]').val(t.description),t.duration&&$('[name="duration"]').val(i.msToTime(t.duration)),t.tags&&$('[name="tag"]').val(t.tags),t.publishedAt&&$('[name="post_date"]').val(new Date(t.publishedAt).toLocaleDateString("sv-SE")),t.waveform_data&&(e.items[0]={metadata:{waveform:t.waveform_data}}),t.stream_url&&$('[name="upload"]').append('<input type="hidden" name="stream_url" value="'+t.stream_url+'"/>'),t.blob){var n=new DataTransfer;n.items.add(t.blob),$('.file-upload input[name="image"]')[0].files=n.files,t.artwork_url&&($(".file-upload img").attr("src",t.artwork_url),$(".file-upload input").removeAttr("required"))}}))},sortable:function(){var e=this;$(".track-list").length&&sortable(".track-list",{handle:".handle"})[0].addEventListener("sortupdate",(function(t){e.updateList()}))},updateList:function(){var e=$(".track-list li[id]").map((function(){return this.id})).get();$('[name="post"]').val(e.join())},import:function(url,obj,callback){var proxyServer=play.rest.endpoints.proxy+"?url=",server="";-1!==url.indexOf("soundcloud.com")&&(server="soundcloud",url=proxyServer+url),-1!==url.indexOf("mixcloud.com")&&(server="mixcloud",url=url.replace("https://www.mixcloud.com/","https://api.mixcloud.com/")),-1!==url.indexOf("hearthis.at")&&(server="hearthis",url=url.replace("https://hearthis.at/","https://api-v2.hearthis.at/")),url=url.replace("/shorts/","/embed/"),url.match(/(http:|https:|)\/\/(player.|www.|music.|m.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),RegExp.$3.indexOf("youtu")>-1&&(server="youtube",url="https://www.googleapis.com/youtube/v3/videos?id="+RegExp.$6+"&key="+play.youtube_api_key+"&part=snippet,contentDetails,statistics,status"),RegExp.$3.indexOf("vimeo")>-1&&(server="vimeo",url="https://vimeo.com/api/v2/video/"+RegExp.$6+".json"),obj.url=url,$.ajax(obj).then((function(data){if($.isArray(data)&&(data=data[0]),"soundcloud"==server){var m=data.match(/window\.__sc_hydration = (.*);<\/script>/);if(m)for(var n=eval(m[1]),i=0;i<n.length;i++)if("sound"===n[i].hydratable){data=n[i].data;var tags=data.tag_list.match(/\w+|"[^"]+"/g);tags&&(data.tags=tags.join(", ").replaceAll('"',""))}}if("hearthis"==server&&(data.duration=1e3*data.duration,data.artwork_url=proxyServer+data.artwork_url),"mixcloud"==server&&(data=JSON.parse(data),data.title=data.name,data.artwork_url=data.pictures.extra_large,data.duration=1e3*data.audio_length,data.tags)){var tags=data.tags.map((function(e){return e.name}));data.tags=tags.join(", ")}"soundcloud"==server&&data.artwork_url&&(data.artwork_url=data.artwork_url.replace("-large","-t500x500")),"vimeo"==server&&(data.duration=1e3*data.duration,data.artwork_url=data.thumbnail_large);var WF=new Waveform;if("youtube"==server&&data.items){var item=data.items[0];data.title=item.snippet.title,data.description=item.snippet.description,data.artwork_url=proxyServer+(item.snippet.thumbnails.maxres?item.snippet.thumbnails.maxres.url:item.snippet.thumbnails.standard.url),data.duration=WF.timeToMS(item.contentDetails.duration),data.publishedAt=item.snippet.publishedAt,data.tags=item.snippet.tags}if(callback&&("object"==typeof data&&(data.type="single"),callback(data)),data.artwork_url){var xhr=new XMLHttpRequest;xhr.onload=function(){var e=new FileReader;e.onloadend=function(){for(var t=e.result.split(","),i=t[1].replace(/\s/g,""),n=t[0].split(":")[1].split(";")[0],r=atob(i),a=r.length,s=new Uint8Array(a);a--;)s[a]=r.charCodeAt(a);var o=data.title+"."+n.replace("image/",""),l=new File([s],o,{type:n}),d={};d.blob=l,d.artwork_url=data.artwork_url,callback&&callback(d)},e.readAsDataURL(xhr.response)},xhr.open("GET",data.artwork_url),xhr.responseType="blob",xhr.send()}if(data.waveform_url){var obj={},url=data.waveform_url.replace(".png",".json"),d=[];data.waveform_data&&(url=data.waveform_data),"hearthis"==server&&(url=proxyServer+url),obj.url=url,$.ajax(obj).then((function(data){var obj={};d=data.samples?data.samples:eval(data),obj.waveform_data=WF.resizeData(d,WF.options.waveLength),callback&&callback(obj)}))}}))}};function redirect(e){void 0!==typeof Pjax&&-1===e.toLowerCase().indexOf("reload")?$(document).trigger("reload",[e]):location.href=e}upload.init(),window.playImport=upload.import;var timeoutID=null;function search(e){var t=e.parent().find(".dropdown-menu"),i=e.val();$.ajax({url:play.rest.endpoints.search,datatype:"json",type:"get",data:{search:i},beforeSend:function(){t.html("")}}).then((function(i){var n="";$.each(i,(function(e,t){n+='<a class="dropdown-item '+("user"==t.type?"dropdown-user":"")+'" href="'+t.url+'">'+t.thumbnail+"<span><span>"+t.title+'</span><span class="author">'+t.author+"</span></span></a>"})),e.parent().removeClass("search-loading"),t.append(n),$(document).trigger("refresh")}))}$(document).on("click","#icon-search",(function(e){setTimeout((function(){$('[name="s"]').focus()}),0)})),$(document).on("keyup","#header-search-form input, .search-form input",(function(e){var t=$(this);t.val().length<1||(t.parent().addClass("search-loading"),t.parent().find(".dropdown-menu").dropdown("show"),clearTimeout(timeoutID),timeoutID=setTimeout((function(){search(t)}),1e3))})),$(document).on("keypress","#header-search-form input, .search-form input",(function(e){13==e.which&&$(this).blur().parent().find(".dropdown-menu").dropdown("hide")})),$(document).on("click","#header-search-form .dropdown-item",(function(e){$(this).parent(".dropdown-menu").dropdown("hide")})),$(document).on("click",".btn-comment",(function(e){if($("body").addClass("open-comment"),$(this).closest(".block-loop-items").length>0){var t=$(this).attr("data-comment-id");$("#ajax-comment").remove(),getModal("#ajax-comment",{name:"comment",post_id:t},callPlugin)}})),$(document).on("click",".comments-backdrop, .comments-title .close",(function(e){$("body").removeClass("open-comment"),$("#ajax-comment").modal("hide")})),$(document).on("click","#commentform #submit",(function(e){var t=$(this),i=t.closest("#commentform"),n=$("#comment").val(),r=parseInt($('[name="comment_post_ID"]').val()),a=$('<div class="comment-message"></div>');if(""==$.trim(n))return!1;i.find(".comment-message").remove(),a.insertBefore(".comment-form-comment"),t.prop("disabled",!0);var s=i.serialize(),o=i.attr("action");return $.ajax({type:"post",url:o,data:s,error:function(e,n,r){var a=e.responseText.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);i.find(".comment-message").html("").append(a[0]).addClass("error"),t.prop("disabled",!1),i.removeClass("processing")}}).then((function(e,n,a){t.prop("disabled",!1);var s=e.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);if(s)i.find(".comment-message").html("").append(s[0]).addClass("error");else{var o=play.rest.endpoints.modal;$.ajax({type:"GET",url:o,data:{name:"comment",post_id:r},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){e&&($("#comments").replaceWith(e.content),window.dispatchEvent(new CustomEvent("call:plugin")))}))}})),!1}));var popper=null,popper_el="dropdown-more";function destory_popper(){popper&&(popper.destroy(),popper=null)}$(document).on("click",".btn-more",(function(e){e.preventDefault(),e.stopPropagation(),destory_popper(),wp.hooks.doAction("hook_before_more_action",$(this));var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-id"),i=$("#"+popper_el);i.length>0?(i.attr("data-play-id",t),i.html(play.el_more)):(i=$('<div id="'+popper_el+'" class="dropdown-menu" data-window data-play-id="'+t+'">'+play.el_more+'</div><div class="dropdown-backdrop"></div>'),$("body").append(i));var n=i.find(".btn-edit, .btn-remove");play.is_user_logged_in&&"true"==$(this).attr("data-editable")?n.each((function(){var e=play.edit_url+t+"&action="+$(this).attr("data-action");$(this).attr("data-url",e)})):n.remove(),("false"==$(this).attr("data-playable")||$(this).closest(".block-loop-short-item").length>0||$(this).closest(".header-station").length>0&&$("body.single-station .plyr-theme-video").length>0)&&i.find(".btn-next-play, .btn-queue, .btn-play-now, .dropdown-divider").remove();var r=$(this).attr("data-type");"playlist"!=r&&"album"!=r||i.find(".btn-playlist").remove(),"user"==r&&(i.find(".btn-playlist").remove(),i.find(".btn-next-play, .btn-queue, .btn-play-now").attr("data-user-id",t)),i.find(".btn-like").attr("data-id",t),i.find(".btn-share").attr("data-share-type",r).attr("data-url",$(this).attr("data-url")).attr("data-embed-url",$(this).attr("data-embed-url")),popper=new Popper($(this),i,{modifiers:{preventOverflow:{enabled:!0}}}),wp.hooks.doAction("hook_after_more_action",$(this)),i.addClass("show"),$("body").addClass("dropdown-open")})),$(document).on("click",(function(e){destory_popper(),$("#"+popper_el).removeClass("show"),$("body").removeClass("dropdown-open")})),$(document).on("click",".btn-delete-account",(function(e){e.preventDefault(),getModal("#remove-modal",{name:"delete-account"})})),$(document).on("click",'#your-profile [type="submit"]',(function(e){e.preventDefault();var t=$(this).closest("form"),i=new FormData(t[0]),n=".form-message";return $(n,t).html(""),t.addClass("processing"),$.ajax({url:play.rest.endpoints.profile,data:i,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){"success"==e.status?($(n,t).first().append('<div class="success">'+e.msg+"</div>"),redirect(location.href)):"error"==e.status&&$(n,t).first().append('<div class="error">'+e.msg+"</div>"),t.removeClass("processing")})).fail((function(){t.removeClass("processing"),redirect(location.href)})),!1})),$(document).on("click",".btn-like, .btn-follow",(function(e){if(play.is_user_logged_in){e.preventDefault();var t=$(this),i=t.attr("data-id"),n=t.attr("data-action"),r=t.attr("data-type");t.attr("disabled","disabled"),$.ajax({url:play.rest.endpoints[n],datatype:"json",type:"get",data:{type:r,action:n,nonce:play.nonce,id:i,url:location.href},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){if(t.attr("disabled",!1),e.error)e.url;else{var a=$('[data-id="'+i+'"][data-action="'+n+'"][data-type="'+r+'"]');1==e.status?a.addClass("active"):a.removeClass("active"),t.find(".count").text(e.count),$(document).trigger(n+".play",[i,e.status,e.type])}}))}})),$(document.body).on("click",".edd-add-to-cart, .edd-remove-from-cart",(function(e){edd_scripts&&edd_scripts.ajaxurl&&play.rest.endpoints.cart&&(edd_scripts.preurl=edd_scripts.ajaxurl,edd_scripts.ajaxurl=play.rest.endpoints.cart+"?_wpnonce="+play.nonce,setTimeout((function(){edd_scripts.ajaxurl=edd_scripts.preurl}),100));var t=parseInt($(this).attr("data-download-id")),i=$(this).attr("data-action");if(t&&0==$(this).closest(".modal").length)if(play.cart_ids.includes(t)){if("edd_remove_from_cart"==i){var n=play.cart_ids.indexOf(t);play.cart_ids.splice(n,1)}}else"edd_add_to_cart"==i&&play.cart_ids.push(t)})),$(document).on("refresh",(function(){$(".edd-add-to-cart:not(.edd-no-js)").addClass("edd-has-js")})),$(document).on("pjax:complete",(function(){$("#header-search-form .dropdown-menu").dropdown("hide"),setTimeout((function(){$("body").removeClass("edd-js-none").addClass("edd-js")}),500)})),$(document).on("selected:player",(function(e,t){if(play.cart_ids){var i=".plyr_purchase > .edd_download_purchase_form",n=" button.edd-add-to-cart",r=" .edd_go_to_checkout";play.cart_ids.includes(parseInt(t.id))?($(i+n).hide(),$(i+r).show()):($(i+n).show(),$(i+r).hide())}})),$(document.body).on("click",".edd-reviews-star-rating",(function(){$(".edd-reviews-stars-filled").width(25*$(this).attr("data-rating")),$("input#edd-reviews-star-rating").val($(this).attr("data-rating"))})),$(document.body).on("click",".edd_review .comment-reply-link",(function(){return $("#edd-reviews-respond").hide(),$("#edd-reviews-reply").show(),!1})),$(document.body).on("click",".edd-reviews-review-form-submit",(function(e){var t=$(this),i=t.closest("form"),n=!0;if(i.find('input[name="edd-reviews-review-rating"], [required]').each((function(){var e=$(this);if(!$.trim(e.val()))return e.focus(),n=!1,!1;n=!0})),!n)return!1;i.addClass("processing"),t.prop("disabled",!0);var r=new FormData(i[0]);return $.ajax({url:play.rest.endpoints.review,data:r,type:"POST",processData:!1,contentType:!1,cache:!1}).then((function(e){i.removeClass("processing"),t.prop("disabled",!1),$(document).trigger("reload",[window.location.href.replace(window.location.hash,"")+"#edd-reviews"])})).fail((function(){})),!1}));var pwdmeter={el:"#login-form",el_field:"",el_strength:".pwd-strength",el_hint:".pwd-hint",init:function(){var e=this;$(document).on("keyup change",'#registerform [name="pwd"], #resetpasswordform [name="pwd"]',e.strengthMeter),$('#resetpasswordform [name="pwd"]').trigger("change"),$(document).on("click",".btn-toggle-pwd",e.toggle),$(document).on("click",".btn-generate-pwd",e.generatePwd),e.toggleBtn(),$(document).on("pjax:complete loginModal:loaded",(function(){e.toggleBtn()}))},toggleBtn:function(){$('[type="password"]:not(".is-toggled")').addClass("is-toggled").after('<button type="button" class="button btn-toggle-pwd"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="eye-on"></path><circle cx="12" cy="12" r="3" class="eye-on"></circle><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="eye-off"></path><line x1="1" y1="1" x2="23" y2="23" class="eye-off"></line></svg></button>')},toggle:function(){var e=$(this).prev("input"),t="password"==e.attr("type")?"text":"password";e.attr("type",t)},includeMeter:function(e,t){var i=e.find(this.el_strength);""===t.val()?(i.hide(),$(document).trigger("pwd-strength-hide")):0===i.length?(t.parent().after('<p class="pwd-strength" aria-live="polite"></p>'),$(document).trigger("pwd-strength-added")):(i.show(),$(document).trigger("pwd-strength-show"))},strengthMeter:function(){var e,t=$(this),i=t.closest("form"),n=$('button[type="submit"]',i),r=t.val();pwdmeter.includeMeter(i,t),e=pwdmeter.checkPasswordStrength(i,t),r.length>0&&e<play.min_password_strength&&-1!==e?n.attr("disabled","disabled").addClass("disabled"):n.prop("disabled",!1).removeClass("disabled")},checkPasswordStrength:function(e,t){var i=e.find(this.el_strength),n=e.find(this.el_hint),r='<p class="pwd-hint">'+play.i18n.pwd.hint+"</p>",a=pwdmeter.meter(t.val());if(i.removeClass("short bad good strong"),n.remove(),i.is(":hidden"))return a;switch(a){case 0:i.addClass("short").html(play.i18n.pwd.short+""),i.after(r);break;case 1:case 2:i.addClass("bad").html(play.i18n.pwd.bad+""),i.after(r);break;case 3:i.addClass("good").html(play.i18n.pwd.good+"");break;case 4:i.addClass("strong").html(play.i18n.pwd.strong+"");break;case 5:i.addClass("short").html(play.i18n.pwd.mismatch)}return a},generatePwd:function(){var e=$(this);$.ajax({url:play.rest.endpoints.generatepwd,type:"GET",processData:!1,contentType:!1,cache:!1}).then((function(t){var i=e.closest("form").find('[name="pwd"]');i.val(t.data),i.trigger("change")}))},meter:function(e,t){return e!=t&&t&&t.length>0?5:void 0===window.zxcvbn?-1:zxcvbn(e,[]).score}};pwdmeter.init();var login={el:"#login-form",el_modal:"#login-modal",el_msg:".form-message",btn:null,action:"login",init:function(){this.initEvents()},initEvents:function(){var e=this;$(document).on("click",".btn-like, .btn-playlist, .btn-follow, .btn-ajax-login, .btn-ajax-register, .btn-ajax-login a, .btn-ajax-register a",(function(t){play.is_user_logged_in||(t.preventDefault(),e.action=$(this).hasClass("btn-ajax-register")||$(this).parent().hasClass("btn-ajax-register")?"register":"login",e.showModal())})),$(document).on("click",e.el+' a[class*="btn-"]',(function(t){var i=$(this).attr("href");e.action=e.getURLParameter(i,"action"),$(e.el+" #"+e.action+"form").length>0&&(t.preventDefault(),e.showForm())})),$(document).on("click",e.el+' button[type="submit"]',(function(t){t.preventDefault(),e.btn=$(this),e.ajaxForm()})),$(document).on("require_login",(function(t){play.is_user_logged_in||e.showModal()}))},showModal:function(){var e=this;"1"!=play.disable_login_modal?$(e.el).length>0&&0==$(e.el).closest(e.el_modal).length||(this.showForm=this.showForm.bind(this),getModal(e.el_modal,{name:"login_form"},e.showForm)):redirect(play.login_url)},getURLParameter:function(e,t){return(RegExp(t+"=(.+?)(&|$)").exec(e)||[,null])[1]},ajaxForm:function(){var e=this,t=$(e.btn).closest("form"),i=!0;t.find('[name="redirect_to"]').val();if(e.action=t.find('[name="form-action"]').val(),$(e.el_msg,e.el).html(""),t.find('input[type="text"], input[type="password"], input[type="email"], [required]').each((function(){var e=$(this);if("user_login"==e.attr("name")){var t=e.val().toLowerCase();e.val(t)}if("pass2"==e.attr("name")){t=document.querySelector("#pass1").value;e.val(t)}if(!$.trim(e.val())||"email"==e.attr("type")&&!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e.val()))return e.focus(),i=!1,!1;i=!0})),!i)return!1;t.addClass("processing"),e.btn.prop("disabled",!0);var n=new FormData(t[0]);$.ajax({url:play.rest.endpoints.auth,data:n,type:"POST",processData:!1,contentType:!1,cache:!1}).then((function(i){t.removeClass("processing"),e.btn.prop("disabled",!1),t.find('input[type="text"], input[type="email"], input[type="password"]').val(""),"error"==i.status?($(document).trigger("login:error"),$(e.el_msg,t).first().append('<div class="error">'+i.msg+"</div>")):"success"==i.status&&($(document).trigger("login:success"),$(e.el_msg,t).first().append('<div class="success">'+i.msg+"</div>"),"register"==e.action&&$(e.el_msg,t).nextAll().addClass("hideme").hide(),setTimeout((function(){var t=$(e.btn).closest(".modal");if(t.length){var n=window.location.href;i.redirect.indexOf("reload")>-1&&(n+="?reload"),i.redirect=n,t.modal("hide")}i.nonce&&""!==i.nonce&&play&&(play.is_user_logged_in=!0,play.nonce=i.nonce),i.redirect&&redirect(i.redirect)}),play.rest.timeout_redirect))})).fail((function(){location.reload()}))},showForm:function(){var e=this,t=$(e.el+" #"+e.action+"form");t.length&&($(e.el_msg,e.el).html(""),$(e.el+" form").hide(),t.find(".hideme").show(),t.show()),$(document).trigger("loginModal:loaded")}};login.init();var playlist={id:0,data:[],el:"#playlist-modal",btn:null,link:"",init:function(){var e=this;this.r=this.r.bind(this),this.setLink=this.setLink.bind(this),$(document).on("click",".btn-playlist",(function(t){if(play.is_user_logged_in){t.preventDefault();var i=$(this).closest("[data-play-id]").attr("data-play-id");i&&(e.id=i),getModal(e.el,{name:"playlist"},e.r),$(e.el).find("form").show()}})),$(document).on("click",e.el+" .btn-new",(function(t){t.preventDefault(),e.btn=$(this),e.c()})),$(document).on("click",e.el+" .btn-remove",(function(t){t.preventDefault(),e.btn=$(this),e.d()})),$(document).on("click",e.el+" .btn-add, "+e.el+" .btn-added",(function(t){t.preventDefault(),e.btn=$(this),e.u()})),$(document).on("click",e.el+" a",(function(e){$(e.target).closest(".modal").modal("hide")})),$(document).on("click",".btn-remove",(function(t){t.preventDefault(),e.link=$(this).attr("data-url"),getModal("#remove-modal",{name:"remove"},e.setLink)}))},c:function(){var e=this,t=$(e.el).find("form"),i=t.find("input");""!=$.trim(i.val())&&(e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,title:i.val(),type:"c"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(n){e.data.unshift(n.data),t.hide(),e.btn.prop("disabled",!1),i.val(""),e.render()})))},r:function(){var e=this;$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,type:"r"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status&&(e.data=t.data,e.render())}))},u:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id"),i=e.getObj(t,e.data);e.btn.prop("disabled","disabled"),e.btn.is(".btn-add")?i.post.push(e.id):i.post.splice($.inArray(e.id,i.post),1),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,post:i.post,type:"u"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){e.btn.prop("disabled",!1),"success"==t.status&&e.render()}))},d:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id");e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,type:"d"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(i){e.btn.prop("disabled",!1),"success"==i.status&&($.each(e.data,(function(i,n){if(t==e.data[i].id)return e.data.splice(i,1),!1})),e.render())}))},render:function(){var e=this,t=$(e.el+" .block-loop-items");t.empty(),$.each(e.data,(function(i,n){var r=$("#tpl-item").clone();r.attr("id","").attr("style",""),r.attr("data-play-id",n.id),n.thumb&&r.find("img").attr("src",n.thumb),r.find(".entry-title").html(n.title).attr("href",n.url),r.find(".count").html(n.post.length),r.find(".post-thumbnail a").attr("href",n.url),r.find(".btn-add, .btn-added").hide(),e.id>0&&(-1!==$.inArray(e.id,n.post)?(r.find(".btn-add").hide(),r.find(".btn-added").show()):(r.find(".btn-added").hide(),r.find(".btn-add").show())),$(t).append(r)})),$(document).trigger("refresh")},getObj:function(e,t){var i=!1;return $.each(t,(function(n,r){e!=t[n].id||(i=t[n])})),i},setLink:function(){$("[data-remove]").attr("href",this.link)}};playlist.init();var share={el:"#share-modal",el_embed:".share-embed",el_url:"#share-url",link:"",embed:"",type:"",init:function(){var e=this;this.setUrl=this.setUrl.bind(this),$(document).on("click",".btn-share",(function(t){var i=$(e.el_embed).find("iframe");if(i.length>0){var n=i[0].outerHTML;i.remove(),$(e.el_embed).append(n)}e.type=$(this).attr("data-share-type"),e.link=$(this).attr("data-url")||$(this).parent().prev().attr("data-url"),e.embed=$(this).attr("data-embed-url"),e.link||(e.link=location.href),getModal(e.el,{name:"share"},e.setUrl,e.close)})),$(document).on("click","#share-url, #embed-code",(function(e){$(this).select(),document.execCommand("copy")}))},setUrl:function(){var e=this;$(".share-list a").each((function(t){$(this).attr("href",$(this).attr("data-url")+encodeURIComponent(e.link))})),$(e.el_url).val(e.link),$(".share-embed iframe").length>0&&($(".share-embed iframe").attr("src",e.embed).attr("type",e.type),$("#embed-code").val($(".share-embed iframe")[0].outerHTML))},close:function(){$(".share-embed iframe").attr("src"," ")}};share.init();var notification={inter:play.rest.timeout_notify,timeout:null,el:"#dropdown-notification",init:function(){this.initEvent(),play.is_user_logged_in&&this.getNotification()},initEvent:function(){var e=this;$(document).on("click",e.el,(function(t){e.getNotification()}))},getNotification:function(){var e=this;clearTimeout(e.timeout),$.ajax({url:play.rest.endpoints.notification,type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){$(".dropdown-notification-list").html(t.content),$(document).trigger("refresh");var i=$(t.content).find(".is-new").length;i>0?$(e.el).find(".count").html(i):$(e.el).find(".count").html(""),setTimeout((function(){e.getNotification()}),e.inter)}))}};notification.init();var callPlugin=function(){window.dispatchEvent(new CustomEvent("call:plugin"))};window.getModal=function(e,t,i,n){if($(e).length)i&&i(),$(document).trigger("modal:loaded");else{var r=$('<div class="modal fade modal-loading" id="'+e.substr(1)+'"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="spinner"></div></div></div></div></div>');$("body").append(r);var a=play.rest.endpoints.modal;$.ajax({type:"GET",url:a,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){t?(r.removeClass("modal-loading").find(".modal-content").html(t.content),i&&i(),$(document).trigger("modal:loaded")):$(e).modal("hide")}))}$(e).modal("show"),$(e).on("hidden.bs.modal",(function(e){n&&n()}))},window.moreless=function(e,t){if(e.className+=" moreless",e.scrollHeight>e.clientHeight+4){var i=document.createElement("button"),n=e.innerHTML,r=e.getAttribute("title"),a=e.getAttribute("type"),s=e.getAttribute("more"),o=e.getAttribute("less");e.innerHTML='<div class="moreless-content">'+n+"</div>",i.className="btn-moreless",i.innerHTML="<span>"+s+"</span><span>"+o+"</span>",e.appendChild(i),i.addEventListener("click",(function(t){"expand"==a&&e.classList.toggle("show"),"modal"==a&&modal(r,n)}))}},window.modal=function(e,t){var i='<div class="modal-backdrop"></div><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><div class="modal-title"><h2>'+e+'</h2></div><button class="close" data-dismiss="modal">&times;</button></div><div class="modal-body">'+t+"</div></div></div>",n=document.createElement("div");n.className="modal",n.style.display="block",n.innerHTML=i,document.body.appendChild(n);var r=n.getElementsByClassName("modal-header")[0],a=n.getElementsByClassName("modal-backdrop")[0],s=r.getElementsByClassName("close")[0];document.body.classList.toggle("modal-open"),s.addEventListener("click",(function(e){n.remove(),document.body.classList.toggle("modal-open")})),a.addEventListener("click",(function(e){n.remove(),document.body.classList.toggle("modal-open")}))},callPlugin()}(jQuery,window),window.playlist=!1,function($){"use strict";function createPlyr(e){if(playlist)return playlist;if(play.is_user_logged_in||"1"!=play.login_to_play){var t=$("#plyr-playlist");return 0==t.length&&(t=$('<div class="plyr-playlist player fixed-bottom" id="plyr-playlist"></div>')).appendTo("body"),t.append('<audio playsinline id="player"></audio>'),$("html").addClass("open-player"),playlist=new Playlist({playlist:"#plyr-playlist",player:"#player"},e,{theme:play.player_theme,timeoutCount:play.rest.timeout_count,iconUrl:play.url+"libs/plyr/plyr.svg",blankVideo:play.url+"libs/plyr/blank.mp4",history:play.player_history,autonext:play.player_autonext,adsInterval:play.ad_interval?play.ad_interval:3,ads:{enabled:!!play.ad_tagurl,tagUrl:play.ad_tagurl},keyboard:{global:!0},i18n:play.i18n,autoplay:!1,playsinline:!0}),playlist.player.on("timeupdate",(function(e){var t=playlist.getCurrent();if(t){var i=playlist.player.currentTime/playlist.player.duration,n=$(".waveform .waveform_wrap"),r=$('[data-id="'+t.id+'"].waveform_wrap');n.not(r).trigger("timeupdate",0),r&&i&&r.trigger("timeupdate",[i,playlist.player.paused])}})),$(document).trigger("playlist.ready"),playlist}$(document).trigger("require_login")}function destroyPlyr(){$("[data-play-id]").removeClass("active"),window.playlist.player.destroy(),window.players=[],window.playlist=null,$("#plyr-playlist").children().length>0&&$("#plyr-playlist").remove()}function waveform(){$(".waveform").each((function(){var $this=$(this),$color=$this.css("color"),$data=$this.attr("data-waveform");if($data){$data=eval("["+$data+"]");var opt={container:$this.find(".waveform-container"),id:$this.attr("data-id"),duration:$this.attr("data-duration")},wf=new Waveform($.extend(!0,{},opt,play.waveform_option));wf.load($data),$(wf.wrap).on("update",(function(e,t,i){playlist&&(i==playlist.getCurrent().id&&(playlist.player.currentTime=playlist.player.duration*t))})),$this.removeAttr("data-waveform")}}))}function init(){$.fn.popover&&$('[data-toggle="popover"]').popover(),$.fn.tooltip&&$('[data-toggle="tooltip"]').tooltip(),waveform(),shortPlay()}function startShortPlay(){$(".block-loop-short-item").first().find("[data-play-id]").trigger("click")}function shortPlay(){var e=$(".block-loop-short-item"),t="plyr-scrolling";if(0!=e.length){e.parent().css("height",e.parent().height());var i=window,n=getComputedStyle(e.parent()[0]).getPropertyValue("overflow-y");"scroll"!=n&&"auto"!=n||(i=e.parent()[0]),i.addEventListener("scroll",debounce((function(){for(var n=0;n<e.length;n++){var r=isVisible(e[n],i),a=e[n];r&&!a.inView&&(a.inView=!0,$(e[n]).find("[data-play-id]").trigger("click"),setTimeout((function(){resizeShortPlay(),$(".plyr-short").removeClass(t)}),1e3)),!r&&a.inView&&(a.inView=!1)}}),100),!1),i.addEventListener("scroll",(function(){$(".plyr-short").addClass(t)})),window.addEventListener("resize",debounce(resizeShortPlay,100),!1)}}function resizeShortPlay(){var e=$(".block-loop-short-item");if(0!=e.length){var t=e.parent().offset().top,i=e[0].getBoundingClientRect();$(".plyr-short").css("--top",t+"px").css("--left",i.left+"px").css("--width",i.width+"px").css("--height",i.height+"px")}}function isVisible(e,t,i){var n=e.offsetTop,r=n+e.clientHeight,a=t.pageYOffset?t.pageYOffset:t.scrollTop,s=a+(t.pageYOffset?t.innerHeight:t.clientHeight);return n>=a&&r<=s||i&&(n<a&&r>a||r>s&&n<s)}function debounce(e,t,i){var n,r;return function(){var a,s,o=this,l=arguments;return a=function(){n=null,i||(r=e.apply(o,l))},s=i&&!n,clearTimeout(n),n=setTimeout(a,t),s&&(r=e.apply(o,l)),r}}$(document).on("click.play",".btn-play, .btn-play-now, .btn-next-play, .btn-queue",(function(e){if(e.preventDefault(),createPlyr([]),playlist){var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-user-id"),i=$(this).attr("data-user-id")?"user":"post",n=$(this).closest(".is-album").attr("data-play-id")||$(this).closest(".is-playlist").attr("data-play-id"),r=$(this).attr("data-index")||0,a=[];if($(this).hasClass("active"))playlist.pause();else if($(this).closest(".block-loop-short-item").length>0?(playlist.repeat=2,$(".plyr-playlist").addClass("plyr-short"),resizeShortPlay()):$(".plyr-playlist").removeClass("plyr-short"),"post"==i&&playlist.getIndex(t)>-1)playlist.play({id:t},r);else{var s=play.rest.endpoints.play+"/"+t,o={type:i};if($(this).closest(".album-tracks").length&&n&&(o.from=n,r=$(this).closest(".block-loop-item").index()),$(".btn-play[data-play-id="+t+"]").hasClass("btn-play-auto")||$(this).closest(".album-tracks").length&&$(".header-station .btn-play-auto").length){a=[];$(".album-track").each((function(e,t){a.push(parseInt($(t).attr("data-play-id")))})),o.ids=a}$.ajax({url:s,type:"get",datatype:"json",data:o,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){playlist.play(e,r)}))}}})),$(document).on("playlist",(function(e){createPlyr(play.default_id)})),$(document).on("destroy.playlist",(function(e){destroyPlyr()})),$(document).on("player_preview_end",(function(e){$(document).trigger("require_login")})),$(document).on("pjax:end, refresh",(function(e){init()})),$(window).on("load",(function(){init();try{if($(".no-player").length>0)return;if(play.default_id){createPlyr(play.default_id);return}var e=localStorage.getItem("plyr");if(e&&(e=JSON.parse(e)).items.length>0&&play.player_history)createPlyr(e.items)}catch(e){}startShortPlay()})),$(document).on("like.play",(function(e,t,i,n){if(playlist&&"post"===n){var r=playlist.getItem(t);r&&(r.like=i)}})),$(document).on("complete.play",(function(e,t){var i=t.ids.slice(-1).pop(),n=play.rest.endpoints.play+"/"+i;$.ajax({url:n,type:"get",datatype:"json",data:{type:"next",ids:t.ids}}).then((function(e){!1!==e&&playlist.play(e,0)}))})),$(document).on("played",(function(e,t){var i=t.id,n=play.rest.endpoints.play+"/"+i;$.ajax({url:n,type:"get",datatype:"json",data:{type:"played",nonce:play.nonce},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}})})),$(document).on("pjax:complete",(function(){0==$(".block-loop-short-item").length&&$(".plyr-playlist").removeClass("plyr-short")})),$(document).on("pjax:complete",(function(e){startShortPlay()}))}(jQuery);